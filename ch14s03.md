<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/></head><body><div class="section" title="Feltételes eloszlások hatékony reprezentációja"><div class="titlepage"><div><div><h1 class="title"><a id="id676306"/>Feltételes eloszlások hatékony reprezentációja</h1></div></div></div><p class="Tartalom3">Még ha a szülők maximális száma, <span class="emphasis"><em>k </em></span>meglehetősen kicsi is, egy csomópont feltételes valószínűségi táblájának kitöltése akár <span class="emphasis"><em>O</em></span>(2<sup>k</sup>) számú értéket és az összes lehetséges feltételes esetet figyelembe véve is nagy szakértelmet igényelhet. Valójában azonban az a legrosszabb eset, amikor a kapcsolat a szülők és a gyermek között teljesen önkényes. Általában az ilyen kapcsolatok egy <span class="strong"><strong>kanonikus eloszlás</strong></span>sal (<span class="strong"><strong>canonical distribution</strong></span>) írhatók le, amelyek valamilyen szabványos mintát követnek. Ilyen esetekben a teljes tábla megadható a mintázat és esetleg néhány paraméter meghatározásával – sokkal könnyebben, mint exponenciális számú paraméter megadásával.</p><p>A legegyszerűbb példát a <span class="strong"><strong>determinisztikus csomópont</strong></span>ok (<span class="strong"><strong>deterministic node</strong></span>s) szolgáltatják. Egy determinisztikus csomópont értékét a szüleinek az értéke teljesen meghatározza, mindenfajta bizonytalanságtól mentesen. A reláció lehet egy logikai kapcsolat – például ha a szülőcsomópontok azt jelentik, hogy <span class="emphasis"><em>Kanadai</em></span>, <span class="emphasis"><em>Egyesült Államokbeli</em></span> és <span class="emphasis"><em>Mexikói</em></span>, a gyermekcsomópont pedig azt, hogy <span class="emphasis"><em>Észak-Amerikai</em></span>, akkor a közöttük lévő kapcsolat egyszerűen a szülők diszjunkciója. A reláció lehet numerikus is – például ha a szülőcsomópontok egy gépkocsi különböző árai különböző forgalmazóknál, a gyermekcsomópont pedig az az ár, amit egy legolcsóbbat kereső vevő végezetül fizetne, akkor a gyermekcsomópont értéke a szülők értékeinek a minimuma. Másik példa, ha a szülőcsomópontok az egy tóba bejövő vízmennyiségek (folyók, vízlevezetők, csapadék) és az onnan eltávozó vízmennyiségek (folyók, párolgás, elszivárgás), a gyermek pedig a tó szintjének a megváltozása, akkor a gyermek értéke a kifolyó és befolyó szülők értékeinek a különbsége.</p><p>Bizonytalan relációkat gyakran jellemezhetünk úgynevezett „zajos” logikai relációkkal. A mintapélda erre az úgynevezett <span class="strong"><strong>zajos-VAGY</strong></span> (<span class="strong"><strong>noisy-OR</strong></span>) reláció, ami a logikai VAGY reláció általánosítása. Ítéletlogikában kijelenthetjük, hogy a <span class="emphasis"><em>Láz</em></span> akkor és csak akkor igaz, ha a <span class="emphasis"><em>Megfázás</em></span> vagy az <span class="emphasis"><em>Influenza</em></span> vagy a <span class="emphasis"><em>Malária</em></span> igaz. A zajos-VAGY modell megenged bizonytalanságot, hogy egyes szülők okozhatják-e a gyermekek igaz értékét – az okozati kapcsolat a szülő és gyermek között <span class="emphasis"><em>gátolt</em></span> lehet, és így lehet, hogy a páciens meg van fázva, de nincs láza. A modell két feltevésre épül. Elsőként feltételezi, hogy az összes lehetséges ok fel van sorolva. (Ez nem annyira szigorú megkötés, mint amilyennek tűnik, mivel mindig létrehozhatunk egy úgynevezett <span class="strong"><strong>szivárgáscsomópont</strong></span>ot (<span class="strong"><strong>leak node</strong></span>), ami „vegyes okokat” fed le.) Másodikként felteszi, hogy bármely szülő gátlása független a többi szülő gátlásától: például akármi is gátolja, hogy a <span class="emphasis"><em>Malária</em></span> lázat okozzon, ez független attól, hogy mi gátolja az <span class="emphasis"><em>Influenzá</em></span>-t,<span class="emphasis"><em> </em></span>hogy lázat okozzon. Ezekkel a feltevésekkel a <span class="emphasis"><em>Láz</em></span> akkor és csak akkor <span class="emphasis"><em>hamis</em></span>, ha az összes <span class="emphasis"><em>igaz</em></span> értékű szülő gátolt, aminek a valószínűsége a gátlás-valószínűségek szorzata. Tételezzük fel, hogy ezek az önálló gátlási valószínűségek a következők:</p><p><code class="code"><em><span class="remark">	P</span></em>(¬<em><span class="remark">láz</span></em>∣<em><span class="remark">megfázás</span></em>, ¬<em><span class="remark">influenza</span></em>,<em><span class="remark"> </span></em>¬<em><span class="remark">malária</span></em>) = 0,6</code></p><p><code class="code"><em><span class="remark">	P</span></em>(¬<em><span class="remark">láz</span></em>∣¬<em><span class="remark">megfázás</span></em>, <em><span class="remark">influenza</span></em>,<em><span class="remark"> </span></em>¬<em><span class="remark">malária</span></em>) = 0,2l</code></p><p><code class="code"><em><span class="remark">	P</span></em>(¬<em><span class="remark">láz</span></em>∣¬<em><span class="remark">megfázás</span></em>,<em><span class="remark"> </span></em>¬<em><span class="remark">influenza</span></em>,<em><span class="remark"> malária</span></em>) = 0,1</code></p><p>Ekkor – ennyi információból és a zajos-VAGY feltevésből – a teljes FVT-t fel lehet építeni. A következő táblázat azt mutatja, hogy hogyan:</p><p><span class="inlinemediaobject"><img src="kepek/14-04a.png" alt="Feltételes eloszlások hatékony reprezentációja"/></span></p><p>Általánosságban, a zajos logikai relációk, amelyekben egy változó <span class="emphasis"><em>k</em></span> számú szülőtől függ, <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>k</em></span>) paraméterrel írhatók le, a teljes feltételes valószínűség-eloszlás táblázathoz tartozó <span class="emphasis"><em>O</em></span>(2<sup>k</sup>) helyett. Ez sokkal könnyebbé teszi a becslést és a tanulást. Például a CPSC-háló (Pradhan és társai, 1994) zajos-VAGY- és zajos-MAX-eloszlásokat használ a betegségek és tünetek közötti kapcsolatok modellezésére. 448 csomópont és 906 él esetén ez csak 8254 értéket igényel a 133 931 430 helyett, ami egy teljes FVT-ket használó háló esetén lenne szükséges.</p><div class="section" title="Bayes-hálók folytonos változókkal"><div class="titlepage"><div><div><h2 class="title"><a id="id676525"/>Bayes-hálók folytonos változókkal</h2></div></div></div><p class="Tartalom3">Számos valós problémában fordulnak elő folytonos mennyiségek, mint a magasság, tömeg, hőmérséklet és pénz; valójában a statisztika nagy része olyan valószínűségi változókkal foglalkozik, amelyek értéktartománya folytonos. Definíció szerint, a folytonos változóknak végtelen számú értéke lehet, így lehetetlen feltételes valószínűségeket megadni minden egyes értékre. Egy lehetséges módszer a folytonos változók kezelésére, ha elkerüljük őket <span class="strong"><strong>diszkretizálás</strong></span>sal (<span class="strong"><strong>discretization</strong></span>) – azaz felosztjuk a lehetséges értékeket intervallumok adott halmaza szerint. Például, a hőmérsékletet feloszthatjuk (&lt;0°C), (0°C–100°C) és (&gt;100°C) intervallumokra. A diszkretizálás néha adekvát megoldás, de gyakran eredményezi a pontosság jelentős romlását, valamint nagyon nagy FVT-ket. Egy másik megoldás, ha a valószínűség sűrűségfüggvények alapvető családjaiból választunk (lásd A) függelék), amelyek véges számú <span class="strong"><strong>paraméter</strong></span>rel megadhatók. Például, a Gauss- (vagy normál) eloszláshoz <span class="emphasis"><em>N</em></span>(<span class="emphasis"><em>μ, σ</em></span><sup>2</sup>)(<span class="emphasis"><em>x</em></span>) a <span class="emphasis"><em>μ</em></span> átlag és <span class="emphasis"><em>σ</em></span><sup> 2</sup> szórásnégyzet tartozik mint paraméterek.</p><p>Egy diszkrét és folytonos változókat is tartalmazó hálót <span class="strong"><strong>hibrid Bayes-háló</strong></span>nak (<span class="strong"><strong>hybrid Bayesian network</strong></span>) nevezünk. Egy hibrid háló megadásához két újfajta eloszlást kell megadnunk: feltételes eloszlást folytonos változóhoz diszkrét és/vagy folytonos szülők esetén; továbbá feltételes eloszlást diszkrét változókhoz folytonos szülők esetén. Fontoljuk meg a 14.5. ábra egyszerű példáját, amelyben a vásárló valamilyen gyümölcsöt vásárol az ára függvényében, ami viszont a termés mennyiségétől függ és attól, hogy éppen van-e állami támogatás. Az <span class="emphasis"><em>Ár</em></span> változó folytonos, a szülei pedig folytonosak és diszkrétek; a <span class="emphasis"><em>Vásárol</em></span> változó diszkrét, és van egy folytonos szülője.</p><p>Az <span class="emphasis"><em>Ár </em></span>változóhoz meg kell adnunk a <span class="strong"><strong>P</strong></span>(<span class="emphasis"><em>Ár</em></span>∣<span class="emphasis"><em>Termés</em></span>,<span class="emphasis"><em> Támogatás</em></span>) eloszlást. A diszkrét szülőt explicit felsorolással kezeljük – azaz megadjuk mind a <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>Ár</em></span>∣<span class="emphasis"><em>Termés</em></span>,<span class="emphasis"><em> támogatás</em></span>), mind a <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>Ár</em></span>∣<span class="emphasis"><em>Termés</em></span>,<span class="emphasis"><em> </em></span>¬<span class="emphasis"><em>támogatás</em></span>) valószínűségeket. A <span class="emphasis"><em>Termés </em></span>kezeléséhez megadjuk, hogy a <span class="emphasis"><em>c</em></span> ár feletti eloszlása hogyan függ a <span class="emphasis"><em>t Termés </em></span>folytonos értékétől. Máshogy fogalmazva, az ár eloszlásának a <span class="emphasis"><em>paramétereit</em></span> a termés <span class="emphasis"><em>t</em></span> értékének függvényében adjuk meg.</p><a id="ID_589_oldal"/><div class="figure"><a id="id676666"/><p class="title"><strong>14.5. ábra - Egy egyszerű háló diszkrét (<span class="emphasis"><em>Támogatás </em></span>és <span class="emphasis"><em>Vásárol</em></span>) és folytonos (<span class="emphasis"><em>Termés</em></span> és <span class="emphasis"><em>Ár</em></span>) változókkal</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/14-05.png" alt="Egy egyszerű háló diszkrét (Támogatás és Vásárol) és folytonos (Termés és Ár) változókkal"/></div></div></div><p>A leggyakoribb választás a <span class="strong"><strong>lineáris Gauss-eloszlás</strong></span> (<span class="strong"><strong>linear Gaussian</strong></span>), amelyben a gyermek Gauss-eloszlású, ahol a <span class="emphasis"><em>μ</em></span> várható érték lineárisan változik a szülő értékével, és ahol a <span class="emphasis"><em>δ</em></span> szórás rögzített. Két eloszlásra van szükségünk, a <span class="emphasis"><em>támogatás </em></span>és a <span class="emphasis"><em>¬támogatás </em></span>esetére különböző paraméterekkel:</p><p><span class="inlinemediaobject"><img src="math/mi-14-0003.gif" alt="Egy egyszerű háló diszkrét (Támogatás és Vásárol) és folytonos (Termés és Ár) változókkal"/></span></p><p>Ebben a példában ekkor, az <span class="emphasis"><em>Ár</em></span> feltételes eloszlását a lineáris normális eloszlás kiválasztásával és az <span class="emphasis"><em>a<sub>i</sub></em></span>,<span class="emphasis"><em> b<sub>i</sub></em></span>,<span class="emphasis"><em> σ<sub>i</sub></em></span>,<span class="emphasis"><em> a<sub>h</sub></em></span>,<span class="emphasis"><em> b<sub>h</sub> és σ<sub>h</sub></em></span><sub> </sub>paraméterekkel adhatjuk meg. A 14.6. (a) és (b) ábra mutatják ezt a két kapcsolatot. Figyeljük meg, hogy mindegyik esetben a meredekség negatív, mivel az ár csökken a kínálat növekedésével. (Természetesen a linearitás feltevése azt is jelenti, hogy az ár egy bizonyos pontnál negatív lesz; a lineáris modell csak akkor ésszerű, ha a termés mennyiségét egy szűk tartományra korlátozzuk.) A 14.6. (c) ábra a <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>c</em></span>|<span class="emphasis"><em>t</em></span>)<span class="emphasis"><em> </em></span>eloszlást mutatja, átlagolva a <span class="emphasis"><em>Támogatás</em></span> két lehetséges értéke felett feltételezve, hogy mindegyik a priori valószínűsége 0,5. Ez mutatja, hogy még igen egyszerű modellekkel is, elég érdekes eloszlások reprezentálhatók.</p><div class="figure"><a id="id676787"/><p class="title"><strong>14.6. ábra - Az (a) és (b) grafikonok az <span class="emphasis"><em>Ár</em></span> valószínűség-eloszlását mutatják a <span class="emphasis"><em>Termés</em></span> függvényében és a <span class="emphasis"><em>Támogatás</em></span> igaz és hamis értéke mellett. A (c) diagram a <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>Ár</em></span>∣<span class="emphasis"><em>Termés</em></span>) eloszlást mutatja, ami a két aleset összegzéseként adódik.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/14-06.png" alt="Az (a) és (b) grafikonok az Ár valószínűség-eloszlását mutatják a Termés függvényében és a Támogatás igaz és hamis értéke mellett. A (c) diagram a P(Ár∣Termés) eloszlást mutatja, ami a két aleset összegzéseként adódik."/></div></div></div><p>A lineáris normális feltételes eloszlásnak vannak bizonyos speciális tulajdonságai. Egy csak folytonos, lineáris normális feltételes eloszlású változókat tartalmazó háló együttes eloszlása egy többváltozós normális eloszlás az összes változó felett (lásd 14.5. feladat).<sup>[<a id="id676822" href="#ftn.id676822" class="footnote">147</a>]</sup> [A többváltozós normális eloszlás egy felület több mint egy dimenzióban, aminek van egy csúcsa az átlagnál (<span class="emphasis"><em>n</em></span> dimenzióban), értéke pedig ettől távolodva minden irányban csökken.] Ha diszkrét változókat adunk a hálóhoz (feltéve, hogy egyetlen diszkrét változó sem gyermeke egy folytonos változónak), a háló egy <span class="strong"><strong>feltételes Gauss</strong></span>- (<span class="strong"><strong>conditional Gaussian</strong></span>) vagy FG-eloszlást definiál: bármilyen értéket is rendelünk a diszkrét változókhoz, a folytonos változók feletti eloszlás egy többváltozós Gauss-eloszlás lesz.</p><p>Most a folytonos szülővel rendelkező diszkrét változók eloszlásával kezdünk foglalkozni. Fontoljuk meg például a <span class="emphasis"><em>Vásárol</em></span> csomópontot a 14.5. ábrán. Ésszerűnek tűnik azt feltételezni, hogy a vásárló vásárol, ha az ár alacsony, nem vásárol, ha magas, a vásárlás valószínűsége pedig folytonosan változik egy közbenső régióban. Máshogy fogalmazva, a feltételes eloszlás hasonló egy „elmosódott” („soft”) küszöbfüggvényhez. Az elmosódott küszöbök létrehozására egy módszer a standard normális eloszlás <span class="emphasis"><em>integrál</em></span>jának a használata:</p><p><span class="inlinemediaobject"><img src="math/mi-14-0004.gif" alt="Az (a) és (b) grafikonok az Ár valószínűség-eloszlását mutatják a Termés függvényében és a Támogatás igaz és hamis értéke mellett. A (c) diagram a P(Ár∣Termés) eloszlást mutatja, ami a két aleset összegzéseként adódik."/></span></p><p>Ekkor a <span class="emphasis"><em>Vásárlás</em></span> valószínűsége az <span class="emphasis"><em>Ár</em></span> ismeretében ez lehet</p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">vásárol</span></em>∣<em><span class="remark">Ár </span></em>=<em><span class="remark"> c</span></em>)<em><span class="remark"> </span></em>=<em><span class="remark"> </span></em>Φ((–<em><span class="remark"> c </span></em>=<em><span class="remark"> μ</span></em>)/<em><span class="remark">σ</span></em>)</code></p><p>ami azt jelenti, hogy az ár küszöbe <span class="emphasis"><em>μ</em></span> körül van, és a küszöbrégió szélessége arányos <span class="emphasis"><em>δ</em></span>-val, illetve, hogy a vásárlás valószínűsége csökken, ahogy az ár növekszik.</p><div class="figure"><a id="id676923"/><p class="title"><strong>14.7. ábra - (a) A <span class="emphasis"><em>Vásárlás </em></span>valószínűségének probit eloszlása az <span class="emphasis"><em>Ár </em></span>ismeretében, <span class="emphasis"><em>μ</em></span> = 6,0 és <span class="emphasis"><em>σ</em></span> = 1,0 mellett. (b) Logit eloszlás hasonló paraméterekkel.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/14-07.png" alt="(a) A Vásárlás valószínűségének probit eloszlása az Ár ismeretében, μ = 6,0 és σ = 1,0 mellett. (b) Logit eloszlás hasonló paraméterekkel."/></div></div></div><a id="ID_591_oldal"/><p>Ezt a <span class="strong"><strong>probit eloszlás</strong></span>t (<span class="strong"><strong>probit distribution</strong></span>) a 14.7. (a) ábra illusztrálja. Alakja azzal az érveléssel igazolható, hogy az alapul szolgáló döntési folyamatnál létezik egy pontos küszöb, de ennek pontos helyét egy véletlen normális eloszlású zaj befolyásolja. A probit modell egy alternatívája a <span class="strong"><strong>logit eloszlás</strong></span> (<span class="strong"><strong>logit distribution</strong></span>), amely a <span class="strong"><strong>szigmoid függvény</strong></span>t (<span class="strong"><strong>sigmoid function</strong></span>) használja egy elmosódott küszöb előállításához:</p><p><span class="inlinemediaobject"><img src="math/mi-14-0005.gif" alt="(a) A Vásárlás valószínűségének probit eloszlása az Ár ismeretében, μ = 6,0 és σ = 1,0 mellett. (b) Logit eloszlás hasonló paraméterekkel."/></span></p><p>Ezt a 14.7. (b) ábra mutatja. A két eloszlás hasonlóan néz ki, de valójában a logit sokkal lassabban tart a határértékekhez. A probit gyakran jobban illeszkedik a valódi helyzetekhez, de a logit esetenként matematikailag könnyebben kezelhető, például széles körben használatos a neurális hálókban (lásd 20. fejezet). Mind a probit, mind a logit általánosítható több folytonos szülőre a szülők értékeinek lineáris kombinációját véve. Többértékű diszkrét gyermekre történő kiterjesztéseket a 14.6. feladatban taglalunk.</p></div><div class="footnotes"><br/><hr/><div class="footnote"><p class="footnote text"><sup>[<a id="ftn.id676822" href="#id676822" class="para">147</a>] </sup> Következésképpen lineáris normális hálókban a következtetés időigénye legrosszabb esetben is csak <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>n</em></span><sup>3</sup>), függetlenül a háló topológiájától. A 14.4. alfejezetben látni fogjuk, hogy diszkrét változós hálóban a következtetés NP-nehéz.</p></div></div></div></body></html>
