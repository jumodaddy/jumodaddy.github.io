<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/></head><body><div class="section" title="Objektumok felismerése"><div class="titlepage"><div><div><h1 class="title"><a id="id786389"/>Objektumok felismerése</h1></div></div></div><p>A látás lehetővé teszi számunkra, hogy megbízhatóan felismerjünk embereket, állatokat és élettelen dolgokat. Az MI-ben, illetve a számítógépes látásban az <span class="emphasis"><em>objektumfelismerés</em></span> fogalmát szokás szerint mindezen dolgokra alkalmazzák. Ez magában foglalja a képen rögzített objektumok osztályának felismerését – például: ez egy arc, illetve adott objektumok felismerését is – például: ez Bill Clinton arca. A motivációt ilyen alkalmazási területek jelentik:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><span class="strong"><strong>Biometrikus azonosítás</strong></span> (<span class="strong"><strong>biometric identification</strong></span>): a bűnügyi vizsgálatok és a védett létesítmények belépésszabályozása megköveteli az egyének azonosítását. Az ujjlenyomatok, az íriszlenyomat és az arcképek olyan képeket eredményeznek, amelyeket adott egyénekhez kell rendelni.</p></li><li class="listitem"><p><span class="strong"><strong>Tartalomalapú képkeresés</strong></span> (<span class="strong"><strong>content-based image retrieval</strong></span>): könnyű egy dokumentumban megtalálni azt a helyet – ha létezik –, ahol a „macska” szó szerepel. Bármelyik szövegszerkesztő képes erre. Most gondoljon arra a feladatra, hogy egy képen megtalálja a képpontok azon részhalmazát, amely egy macska képének felel meg. Ha valaki rendelkezne ezzel a képességgel, akkor megválaszolhatna olyan kereséseket, mint például „Bill Clinton és Nelson Mandela együtt”, egy „görkoris a levegőben”, „az Eiffel-torony éjszaka” stb., anélkül hogy egy gyűjtemény minden egyes fényképéhez feliratkulcsszavakat kellett volna rendelnünk. Ahogy a kép- és videogyűjtemény növekszik, a kézi feliratozás lehetetlenné válik.</p></li><li class="listitem"><p><span class="strong"><strong>Kézírás-felismerés</strong></span> (<span class="strong"><strong>handwriting recognition</strong></span>): például az aláírások, borítékok címmezői, csekkeken szereplő összegek és a kéziszámítógépek tollalapú beviteli megoldása.</p></li></ul></div><p>A látást nemcsak objektumok, hanem cselekvések felismerésére is használjuk. Felismerhetünk járásmódokat (egy barát járását), kifejezéseket (egy mosolyt, egy grimaszt), gesztikulációt (egy integető embert), cselekvéseket (ugrást, táncot) és így tovább. A cselekvésfelismerést célzó kutatás még gyerekcipőben jár, így ebben az alfejezetben az objektumfelismerésre koncentrálunk.</p><p>A vizuális objektumok felismerésének feladata általában könnyű az emberek számára, de a számítógépek számára igen nehéznek bizonyult. Fel akarjuk ismerni egy ember arcát függetlenül a megvilágítás, a kamerához képesti helyzet és az arckifejezés különböző variációitól. Ezen variációk bármelyike széles körű változásokat eredményez a képpontok fényességértékeiben, így a képpontok közvetlen összehasonlítása valószínűleg nem fog működni. Ha valaki egy kategória (például az „autó”) példányait szeretné felismerni, akkor a kategórián belüli variációkat is figyelembe kell vennie. Még a postai irányítószámoknál a kézzel írt számjegyek felismerésének igen korlátozott feladata is komoly kihívásnak bizonyult.</p><p>A felügyelt tanulás vagy a mintaosztályozás természetes keretet biztosít az objektumfelismerés tanulmányozásához. Pozitív („arcok”) és negatív példaként („nem arcok”) adott képek esetében a cél egy olyan függvény megtanulása, amely az új képeket felcímkézi az <span class="emphasis"><em>arc</em></span> és a <span class="emphasis"><em>nem arc</em></span> jelölésekkel. A 18. és 20. fejezet összes technikája lehetséges jelölt a feladatra: többrétegű perceptronokat, döntési fákat, legközelebbi-szomszéd osztályozókat és kernelgépeket alkalmaztak már objektumfelismerési feladatokra. Meg kell azonban jegyeznünk, hogy ezen technikák alkalmazása objektumok felismerésére távolról sem egyértelmű.</p><p>Az első kihívás a kép szegmentálása. Minden kép tipikusan több objektumot fog tartalmazni, így először olyan képpontrészhalmazokra kell osztanunk, amelyek egy-egy objektumnak felelnek meg. Miután a képet régiókra osztottuk, utána a régiókat vagy az azokból összeállított egységeket átadjuk egy osztályozónak, hogy meghatározza az objektumok címkéit. Sajnálatos módon a lentről felfelé szegmentáció hibákra érzékeny eljárás, ezért alternatív megoldásként kínálkozik a fentről lefelé objektumcsoport meghatározása. Eszerint keresni kell egy képpontrészhalmazt, amit arcként lehet osztályozni, és ha ez sikerült, máris van egy csoportunk! A tisztán fentről lefelé módszerek nagyon számításigényesek, mivel különböző méretű képablakokat kell megvizsgálni különböző helyszíneken, és az összes különböző objektumhipotézissel össze kell vetni őket. Jelenleg a leginkább gyakorlati objektumfelismerő rendszerek ilyen fentről lefelé stratégiát alkalmaznak, bár ez megváltozhat, ahogy a lentről felfelé technikák fejlődnek.</p><p>A második kihívás annak biztosítása, hogy a felismerés folyamata kellően robusztus a megvilágítás és az elhelyezkedés változásaira. Az emberek fel tudnak ismerni objektumokat a képpontok fényességértékeivel mért pontos megjelenés jelentős változásai ellenére is. Például egy barát arcát különböző fényviszonyok mellett vagy különböző látószögekből is felismerjük. Egy ennél is egyszerűbb példaként megvizsgálhatjuk a kézzel írt 6-os számjegy felismerését. Képesnek kell lenni a 6-os felismerésére különböző méretekben, a kép különböző pozícióiban és a kép kisebb elforgatásai ellenére is.<sup>[<a id="id786457" href="#ftn.id786457" class="footnote">273</a>]</sup></p><p>A kulcsmomentum azt észrevenni, hogy a geometriai transzformációk, mint például az elfordítás, a méretváltás és a forgatás, vagy a kép fényességének megváltozásai a fényforrások fizikai mozgatása által, más jellemzőkkel rendelkeznek, mint a kategórián belüli variációk, mint például az emberek arcainak különbözőségei. Nyilvánvaló, hogy a tanulás az egyetlen mód az emberi arcok különbözőségeinek megtanulására vagy a 4-es számjegy különböző írásmódjainak felismerésére. Másrészről a geometriai és fizikai transzformációk hatásai szisztematikusak és kiküszöbölhetők a tanuló minták paramétereit leíró tulajdonságok megfelelő tervezésével.</p><p>Annak érdekében, hogy a geometriai transzformációkra vonatkozó invarianciát biztosítsuk, egy egészen hatékonynak bizonyult eljárás a kép régiójának előfeldolgozása úgy, hogy standard pozícióba, méretre és orientációra alakítjuk. Egy alternatív megoldás az, ha egyszerűen figyelmen kívül hagyjuk a geometriai és fizikai transzformációk alkalmi természetét, és úgy gondolunk rájuk, mint az osztályozó variálhatóságának egy újabb forrására. A tanító minták halmazában az összes ilyen variációra példákat kell elhelyeznünk, és abban reménykedünk, hogy az osztályozó kikövetkeztet egy megfelelő transzformációhalmazt a bemenetre, és így kiszűri a variációkat.</p><p>Vizsgáljunk meg most az objektumfelismerésre szolgáló speciális algoritmusokat! Az egyszerűség érdekében kétdimenziós összeállításban fogjuk a problémát vizsgálni, ahol mind a tanuló, mind a tesztminták kétdimenziós fényességábrák formájában adottak. Olyan területeken, mint például a kézírás-felismerés, ez nyilvánvalóan elegendő. Még háromdimenziós objektumok esetében is hatékony stratégia az objektumokat több kétdimenziós nézettel reprezentálni (lásd 24.18. ábra), és az új objektumokat a (valamilyen reprezentációjú) tárolt nézetekkel összehasonlítva osztályozni.</p><div class="figure"><a id="id786469"/><p class="title"><strong>24.18. ábra - Két háromdimenziós tárgy többféle nézete</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/24-18.png" alt="Két háromdimenziós tárgy többféle nézete"/></div></div></div><p>Az előző alfejezet megmutatta, hogy több tényező vesz részt a háromdimenziós információ kinyerésében egy jelenetből. Az objektumfelismerés is több tényezőn alapszik – egy tigrist a narancs és fekete színek keveredéséről, csíkos mintázatáról és testének alakjáról ismerünk fel.</p><p>A szín és a mintázat hisztogramok vagy empirikus frekvenciaeloszlások segítségével reprezentálható. Ha adott egy tigris képe mintaként, akkor megmérhetjük a különböző színű képpontok arányát. Ezután, ha egy ismeretlen példát látunk, összevethetjük a szín hisztogramját a korábbi tigrispéldáknál látottakkal. A mintázatok elemzéséhez a kép különböző irányú és skálázású szűrőkkel történt konvolúciója után kapott eredményeinek hisztogramjait vizsgáljuk, egyezést keresve.</p><p>Az alak felhasználása az objektumfelismerésben sokkal bonyolultabbnak bizonyult. Nagyjából két irányzatot különböztethetünk meg: <span class="strong"><strong>fényességalapú felismerés</strong></span>t (<span class="strong"><strong>brightness-based recognition</strong></span>), ahol a képpontok fényességértékeit direkt módon használjuk, és <span class="strong"><strong>jellemzőalapú felismerés</strong></span>t (<span class="strong"><strong>feature-based recognition</strong></span>), ahol kiemelt jellemzők, mint például az élek vagy a kulcspontok részleges elrendezését használjuk. Miután részletesebben megvizsgáltuk e két megközelítést, tárgyalni fogjuk a <span class="strong"><strong>pozícióbecslés</strong></span>t (<span class="strong"><strong>pose estimation</strong></span>), azaz az objektum helyzetét és irányát a jelenetben.</p><div class="section" title="Fényességalapú felismerés"><div class="titlepage"><div><div><h2 class="title"><a id="id786516"/>Fényességalapú felismerés</h2></div></div></div><p>Ha adott egy képponthalmaz, amely egy lehetséges objektumnak felel meg, akkor válaszszuk a jellemzőknek magukat a képpontok fényességeit. Egy másik variáció szerint először konvolválhatjuk a képet többféle lineáris szűrővel, és az eredményül kapott kép pontjainak értékeit tekinthetjük a jellemzőknek. Ez a megközelítés különösen sikeres olyan feladatokban, mint a kézzel írt számjegyek felismerése, ahogy azt a 20.7. alfejezetben láthattuk.</p><p>Sokféle statisztikai módszert használtak arra, hogy képeket tartalmazó adatbázisok segítségével arcfelismerőket fejlesszenek ki, mint például feldolgozatlan képpontbemeneten működő neurális hálókat képpontbemenettel, vonal- és élszűrők által előállított jellemzőket használó döntési fákat és wavelet-jellemzőket használó, naiv Bayes-modelleket. Az utóbbi módszer néhány eredménye a 24.19. ábrán látható.</p><div class="figure"><a id="id786526"/><p class="title"><strong>24.19. ábra - Egy arcmegtaláló algoritmus eredménye (Henry Schneiderman és Takeo Kanade hozzájárulásával)</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/24-19.png" alt="Egy arcmegtaláló algoritmus eredménye (Henry Schneiderman és Takeo Kanade hozzájárulásával)"/></div></div></div><p>A feldolgozatlan képpontok jellemző vektorként történő használatának egy negatív aspektusa az ebben a reprezentációban rejlő hatalmas redundancia. Vegyünk például két egymás melletti képpontot az arc pofa részén; valószínűleg igen erős közöttük a korreláció, hiszen hasonló a geometriájuk, megvilágításuk stb. Az adatmennyiséget csökkentő technikák, mint például a főkomponens-analízis, sikeresen használhatók a jellemzővektor dimenziószámának csökkentésére, lehetővé téve az olyan dolgok, mint például arcok, nagydimenziós terekben való felismerésénél nagyobb sebességű felismerését.</p></div><div class="section" title="Jellemzőalapú felismerés"><div class="titlepage"><div><div><h2 class="title"><a id="id786538"/>Jellemzőalapú felismerés</h2></div></div></div><p>A feldolgozatlan képpontok fényességértékei jellemzőként történő felhasználása helyett felismerhetünk adott helyen levő jellemzőket, mint például régiókat vagy éleket (lásd 24.3. alfejezet). Két motivációnk van az élek használatára. Az egyik az adatmennyiség csökkentése – sokkal kevesebb él van, mint képpont. A másik a megvilágításfüggetlenség – a kontraszt egy megfelelő tartományában az éleket nagyjából azonos helyen ismerjük fel, függetlenül a tényleges fényforrás-konfigurációtól. Az élek egydimenziós jellemzők; kétdimenziós és nulladimenziós tulajdonságokat (régiókat, illetve pontokat) szintén használunk. Vegyük észre a térbeli elhelyezkedés kezelésében jelentkező különbséget a fényességalapú és a jellemzőalapú módszerek között! A fényességalapú módszerekben az (<span class="emphasis"><em>x</em></span>,<span class="emphasis"><em>y</em></span>) hely <span class="emphasis"><em>a</em></span> jellemző.</p><p>Az élek elrendezése egy objektum tulajdonsága – ez az egyik oka, ami miatt a rajzokat könnyedén értelmezni tudjuk (lásd 24.13. ábra), még akkor is, ha ilyen képek nem fordulnak elő a természetben! Ezen tudás legegyszerűbb felhasználásának módja egy legközelebbi-szomszéd osztályozóval történhet. Előre kiszámítjuk és eltároljuk az ismert objektumok nézeteihez tartozó élkonfigurációkat. Ha adott egy ismeretlen objektumnak megfelelő élelrendezés a bemeneti képen, akkor meghatározhatjuk az eltárolt nézetekhez mért „távolságát”. A legközelebbi-szomszéd osztályozó a legközelebbi illeszkedőt választja.</p><p>Sokféle definíciót javasoltak a képek közötti távolságra. Az egyik legérdekesebb megközelítés a <span class="strong"><strong>deformációs illeszkedés</strong></span> (<span class="strong"><strong>deformable matching</strong></span>) ötletén alapul. D’Arcy Thompson klasszikus munkájában (<span class="emphasis"><em>On Growth and Form</em></span> [D’Arcy Thompson, 1917]) megfigyelte, hogy a hasonló, de nem azonos alakzatok gyakran egybeesésbe hozhatók egyszerű koordináta-transzformációkkal.<sup>[<a id="id786572" href="#ftn.id786572" class="footnote">274</a>]</sup> E módszer szerint az alakzatok hasonlóságát egy három lépésből álló folyamattal határozzuk meg: (1) megoldjuk a két alakzat megfeleltetési problémáját, (2) a megfeleltetést felhasználjuk egy egymásra illesztési transzformáció megbecslésére, és (3) kiszámítjuk a két alakzat közötti távolságot az egymásnak megfelelő pontok illeszkedési hibáinak összegeként, kiegészítve a fedésbe hozó transzformáció nagyságával.</p><p>Az alakzatot a belső vagy külső körvonalát alkotó pontok diszkrét halmazaként reprezentáljuk. Ezeket előállíthatjuk egy éldetektáló által megtalált élképpontok helye alapján, így kapunk egy <span class="emphasis"><em>N</em></span> pontból álló {<span class="emphasis"><em>p</em></span><sub>1</sub>,…, <span class="emphasis"><em>p<sub>N</sub></em></span>} halmazt. A<span class="emphasis"><em> </em></span>24.20. (a) és (b) ábra két alakzat mintapontjait mutatja.</p><p>Most tekintsünk egy <span class="emphasis"><em>p<sub>i</sub></em></span> mintapontra és az onnan induló összes többi mintapontra mutató vektorra egy alakzaton. Ezek a vektorok kifejezik a teljes alakzat konfigurációját a referenciaponthoz viszonyítva. Ez a következő ötlethez vezet: rendeljünk minden mintaponthoz egy leírót, az <span class="strong"><strong>alakzatkontextus</strong></span>t (<span class="strong"><strong>shape context</strong></span>), amely megadja az alakzat további részének durva elrendezését az adott ponthoz viszonyítva. Pontosabban fogalmazva a <span class="emphasis"><em>p<sub>i</sub></em></span> alakzatkontextusa a maradék <span class="emphasis"><em>N –</em></span> 1<span class="emphasis"><em> p<sub>k</sub></em></span> pontra a <span class="emphasis"><em>p<sub>k</sub> –<sub> </sub>p<sub>i</sub></em></span> relatív koordináták egy közelítő <span class="emphasis"><em>h<sub>i</sub></em></span> térbeli hisztogramja. Egy logaritmikus poláris koordináta-rendszert használunk a tartók meghatározására annak biztosítása érdekében, hogy a leíró érzékenyebb legyen a közeli képpontok esetében. A 24.20. (c) ábra mutat erre egy példát.</p><p>Vegyük észre, hogy az alakzat kontextusának definíciója magában hordozza az elforgatásinvarianciát, hiszen minden mérést az objektum pontjaihoz képest végzünk. A méretinvariancia eléréséhez minden sugárirányú távolságot normalizálunk a pontpárok közötti átlagos távolsággal.</p><p>Az alakzatkontextus lehetővé teszi, hogy a megfeleltetési problémát megoldjuk két hasonló, de nem azonos objektumra, mint ahogy az a 24.20. (a) és (b) ábrán látszik. Az alakzatkontextus különböző lesz egy <span class="emphasis"><em>S</em></span> alakzat különböző pontjaira, de egy <span class="emphasis"><em>S</em></span> és egy <span class="emphasis"><em>S'</em></span> alakzat megfelelő (homológ) pontjainak alakzatkontextusa hajlamos lesz a hasonlóságra. Ezek után a két alakzat megfeleltethető pontjai megtalálásának problémáját akként kezelhetjük, mint hasonló alakzatkontextussal rendelkező párok megtalálását.</p><div class="figure"><a id="id786684"/><p class="title"><strong>24.20. ábra - Alakzatkontextus-számítás és -illesztés. (a, b) Két alakzat élének mintapontjai. (c) Az alakzatkontextus számítására használt log-polár hisztogram rekeszek ábrája. 5 rekeszt használunk a log<span class="emphasis"><em> r</em></span> és 12 rekeszt <span class="emphasis"><em>θ</em></span> számára. (d–f) Az (a) és (b) ábrán jelölt referenciaminták alakzatkontextusai: ○, ◊, ⊲. Minden alakzatkontextus a maradék ponthalmaz koordinátáinak log-polár hisztogramja a referenciapontot mint origót használva. (A sötét cellák több pontot jelentenek a rekeszekben.) Vegye észre a ○ és ◊ pontok alakzatkontextusainak vizuális hasonlóságát, amelyeket a két alakzat relatíve hasonló pontjaira számoltunk! Ezzel ellentétben a ⊲ alakzatkontextusa egészen eltérő. (g) Az (a) és (b) között kétoldali illesztéssel megtalált megfeleltetések, a hisztogramok <span class="emphasis"><em>χ</em></span><sup>2</sup> távolsága által definiált költséget használva.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/24-20.png" alt="Alakzatkontextus-számítás és -illesztés. (a, b) Két alakzat élének mintapontjai. (c) Az alakzatkontextus számítására használt log-polár hisztogram rekeszek ábrája. 5 rekeszt használunk a log r és 12 rekeszt θ számára. (d–f) Az (a) és (b) ábrán jelölt referenciaminták alakzatkontextusai: ○, ◊, ⊲. Minden alakzatkontextus a maradék ponthalmaz koordinátáinak log-polár hisztogramja a referenciapontot mint origót használva. (A sötét cellák több pontot jelentenek a rekeszekben.) Vegye észre a ○ és ◊ pontok alakzatkontextusainak vizuális hasonlóságát, amelyeket a két alakzat relatíve hasonló pontjaira számoltunk! Ezzel ellentétben a ⊲ alakzatkontextusa egészen eltérő. (g) Az (a) és (b) között kétoldali illesztéssel megtalált megfeleltetések, a hisztogramok χ2 távolsága által definiált költséget használva."/></div></div></div><p>Precízebben fogalmazva: tekintsük a <span class="emphasis"><em>p<sub>i </sub></em></span>pontot az első, a <span class="emphasis"><em>q<sub>j</sub></em></span> pontot a második alakzaton. Jelölje a C<sub>ij</sub> = <span class="emphasis"><em>C</em></span>(<span class="emphasis"><em>p<sub>i</sub></em></span>,<span class="emphasis"><em>q<sub>i</sub></em></span>) a két pont illesztésének költségét. Minthogy az alakzatkontextusok hisztogramokkal reprezentált eloszlások, így természetes a <span class="emphasis"><em>χ</em></span><sup>2</sup> távolság használata:</p><p><span class="inlinemediaobject"><img src="math/mi-24-0013.gif" alt="Alakzatkontextus-számítás és -illesztés. (a, b) Két alakzat élének mintapontjai. (c) Az alakzatkontextus számítására használt log-polár hisztogram rekeszek ábrája. 5 rekeszt használunk a log r és 12 rekeszt θ számára. (d–f) Az (a) és (b) ábrán jelölt referenciaminták alakzatkontextusai: ○, ◊, ⊲. Minden alakzatkontextus a maradék ponthalmaz koordinátáinak log-polár hisztogramja a referenciapontot mint origót használva. (A sötét cellák több pontot jelentenek a rekeszekben.) Vegye észre a ○ és ◊ pontok alakzatkontextusainak vizuális hasonlóságát, amelyeket a két alakzat relatíve hasonló pontjaira számoltunk! Ezzel ellentétben a ⊲ alakzatkontextusa egészen eltérő. (g) Az (a) és (b) között kétoldali illesztéssel megtalált megfeleltetések, a hisztogramok χ2 távolsága által definiált költséget használva."/></span></p><p>ahol <span class="emphasis"><em>h<sub>i</sub></em></span>(<span class="emphasis"><em>k</em></span>) és <span class="emphasis"><em>h<sub>j</sub></em></span>(<span class="emphasis"><em>k</em></span>)  a normalizált hisztogram <span class="emphasis"><em>k</em></span>-adik értékét jelöli a <span class="emphasis"><em>p<sub>i</sub></em></span>, illetve a <span class="emphasis"><em>q<sub>j</sub></em></span> pontokban. Ha adott az első objektum <span class="emphasis"><em>i</em></span> és a második objektum <span class="emphasis"><em>j</em></span> pontjainak összes lehetséges párosítására a <span class="emphasis"><em>C<sub>ij</sub></em></span> költségek halmaza, akkor az illesztés teljes költségét akarjuk minimalizálni azzal a kényszerfeltétellel, hogy az illeszkedésnek kölcsönösen megfelelőnek kell lennie. Ez egy példa a <span class="strong"><strong>súlyozott páros illesztés</strong></span> (<span class="strong"><strong>weighted bipartite matching</strong></span>) problémájára, amely <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>N</em></span><sup>3</sup>) időben megoldható a magyar algoritmussal.</p><p>A mintapontok megfeleltetése alapján a teljes alakzatra kiterjeszthető a megfeleltetés annak a fedési transzformációnak a megbecsülésével, amely az egyik alakzatot a másikra képezi le. A regularizált vékonylemez spline-ok (thin plate spline) különösen hatékonyak. Ha az alakzatokat fedésbe hoztuk, a hasonlósági mértékek kiszámítása viszonylag kézenfekvő. A két alakzat közötti távolság definiálható az egymásnak megfelelő pontok alakzatkontextus-távolságainak és a vékonylemez spline-hoz rendelt kötési energiának a súlyozott összegeként. Ezt a távolságmértéket meghatározva egy egyszerű legközelebbi-szomszéd osztályozó megoldja a felismerési problémát. A 20. fejezetben írtuk le ezen módszer kitűnő teljesítményét a kézzel írt számjegyek osztályozásában.</p></div><div class="section" title="Az elhelyezkedés becslése"><div class="titlepage"><div><div><h2 class="title"><a id="id786829"/>Az elhelyezkedés becslése</h2></div></div></div><p>Amellett hogy meghatározzuk, mi is az objektum, a helyzetét is szeretnénk megállapítani, azaz a nézőhöz képesti pozícióját és az irányát. Például egy ipari alkalmazásban a robot karja nem tud felvenni egy objektumot, amíg nem tudja a helyzetét. Merev két-, illetve háromdimenziós objektumok esetében a problémának egy egyszerű és jól definiált megoldása van, amely az <span class="strong"><strong>illesztési módszer</strong></span>en (<span class="strong"><strong>alignment method</strong></span>) alapszik, amit a következőkben fejtünk ki.</p><p>Az objektumot <span class="emphasis"><em>M</em></span> jellemzővel, avagy <span class="emphasis"><em>m</em></span><sub>1</sub>, <span class="emphasis"><em>m</em></span><sub>2</sub>, …, <span class="emphasis"><em>m<sub>M</sub> </em></span>háromdimenziós ponttal reprezentáljuk – például egy soklapú objektum sarokpontjaival. Ezeket valamilyen, az objektumnak természetes koordináta-rendszerben határozzuk meg. Ezek után a pontokat egy ismeretlen háromdimenziós forgatásnak, <span class="strong"><strong>R</strong></span>-nek vetjük alá, amit egy ismeretlen <span class="strong"><strong>t</strong></span> mértékű eltolás követ, végezetül egy vetítés következik, amivel előállnak a képsík {<span class="emphasis"><em>p</em></span><sub>1</sub>, <span class="emphasis"><em>p</em></span><sub>2</sub>…, <span class="emphasis"><em>p<sub>N</sub></em></span>} jellemzői. Általában <span class="emphasis"><em>N </em></span>≠ <span class="emphasis"><em>M</em></span>, mivel bizonyos modellpontokat elnyelhettek, és a jellemződetektor kihagyhat egyes jellemzőket (vagy hamisakat határozhat meg a zaj miatt). Ezt egy háromdimenziós <span class="emphasis"><em>m<sub>i</sub></em></span> modellpontra és a neki megfelelő <span class="emphasis"><em>p<sub>i</sub></em></span> képpontra a következőképpen fejezhetjük ki:</p><p><span class="inlinemediaobject"><img src="math/mi-24-0014.gif" alt="Az elhelyezkedés becslése"/></span></p><p>Itt az <span class="strong"><strong>R</strong></span> a rotációs mátrix, <span class="strong"><strong>t</strong></span> az eltolás, és ∏ jelöli a perspektivikus vetítést vagy annak egy közelítését, mint például a skálázott ortografikus vetítést. A végső eredmény a <span class="emphasis"><em>Q</em></span> transzformáció, ami az <span class="emphasis"><em>m<sub>i</sub></em></span> modellpontot megfelelteti a <span class="emphasis"><em>p<sub>i</sub></em></span> képpontnak. Bár kezdetben nem ismerjük a <span class="emphasis"><em>Q</em></span> transzformációt, (merev objektumokra) tudjuk, hogy <span class="emphasis"><em>Q</em></span>-nak minden modellpontra <span class="emphasis"><em>azonosnak</em></span> kell lennie.</p><p>Meghatározhatjuk <span class="emphasis"><em>Q</em></span>-t a modellpontjainak és a pontoknak megfelelő kétdimenziós projekciók adott háromdimenziós koordinátái alapján. Intuíciónk a következőt súgja: felírhatunk olyan egyenleteket, amelyek az <span class="emphasis"><em>m<sub>i</sub></em></span> modellpontokat és a <span class="emphasis"><em>p<sub>i</sub></em></span> képpontokat öszszekapcsolják. Ezekben az egyenletekben az ismeretlen mennyiségek az <span class="strong"><strong>R</strong></span> forgatási mátrix és a <span class="strong"><strong>t </strong></span>eltolási vektor paramétereinek felelnek meg. Ha van elég egyenletünk, ki kell tudnunk számolni <span class="emphasis"><em>Q</em></span>-t. Nem fogjuk bizonyítani itt, hanem csupán állítjuk a következő eredményt:</p><p>Ha adott három, nem egy egyenesre eső <span class="emphasis"><em>m</em></span><sub>1</sub>, <span class="emphasis"><em>m</em></span><sub>2</sub><span class="emphasis"><em> </em></span>és <span class="emphasis"><em>m</em></span><sub>3</sub> modellpont, és ezek skálázott ortogonális projekciója, <span class="emphasis"><em>p</em></span><sub>1</sub>, <span class="emphasis"><em>p</em></span><sub>2</sub><span class="emphasis"><em> </em></span>és <span class="emphasis"><em>p</em></span><sub>3</sub> a képsíkon, akkor létezik pontosan két transzformáció a háromdimenziós modell koordinátakeretből a kétdimenziós képkoordináta-keretbe.</p><p>Ezek a transzformációk a képsíkra vonatkozó tükrözésen keresztül kapcsolatban állnak egymással, és egy egyszerű zártalakú megoldással meghatározhatók. Ha meg tudnánk határozni a kép három jellemzőjének megfelelő három modelljellemzőt, akkor kiszámolhatnánk <span class="emphasis"><em>Q</em></span>-t, az objektum helyzetét. Az előző alfejezetben tárgyaltunk egy alakzatkontextuson alapuló megfeleltetést. Ha az objektumnak vannak jól meghatározott sarkai vagy más jellegzetes pontjai, akkor egy még egyszerűbb technika alkalmazása válik lehetségessé. Az ötlet lényege a generálás és tesztelés. Egy kezdeti megfeleltetést kell találnunk egy képhármas és egy modellhármas között, majd a <code class="code">TRANSZFORMÁCIÓTKERES</code> eljárást használjuk <span class="emphasis"><em>Q</em></span> egy hipotézisének előállítására. Ha a tippelt megfelelés helyes volt, akkor <span class="emphasis"><em>Q</em></span> helyes lesz, és ha a többi modellpontra alkalmazzuk, a képpontok predikcióját eredményezi. Ha a tippelt megfelelés helytelen volt, akkor <span class="emphasis"><em>Q</em></span> helytelen lesz, és ha a maradék modellpontokra alkalmazzuk, nem állítja elő a képpontokat.</p><div class="figure"><a id="id787058"/><p class="title"><strong>24.21. ábra - Az illesztésalgoritmus informális leírása</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/24-21.png" alt="Az illesztésalgoritmus informális leírása"/></div></div></div><p>Ez a 24.21. ábrán látható <code class="code">ILLESZTÉS</code> algoritmus alapja. Az algoritmus megtalálja egy adott modell elhelyezkedését, vagy hibával tér vissza. Az algoritmus időbeli komplexitása a legrosszabb esetben arányos a modell- és képponthármasok kombinációinak számával, vagyis <span class="inlinemediaobject"><img src="math/mi-24-0015.gif" alt="Az illesztésalgoritmus informális leírása"/></span>-mal, megszorozva minden egyes kombináció ellenőrzésének költségével. Az ellenőrzés költsége <span class="emphasis"><em>M </em></span>log<span class="emphasis"><em>N</em></span>, mivel az <span class="emphasis"><em>M</em></span> modellpont mindegyikére elő kell állítanunk a képbeli pozíciót, és meg kell találnunk a legközelebbi képponttól mért távolságot, ami egy log <span class="emphasis"><em>N</em></span> művelet, ha a kép pontjai egy megfelelő adatstruktúrában helyezkednek el. Így legrosszabb esetben az algoritmus időbeli komplexitása <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>M</em></span><sup>4</sup><span class="emphasis"><em>N</em></span><sup>3</sup><span class="emphasis"><em> </em></span>log<span class="emphasis"><em>N)</em></span>, ahol <span class="emphasis"><em>M </em></span>és <span class="emphasis"><em>N</em></span> a modell és a kép pontjainak száma. Az elhelyezkedésklaszterezésen alapuló technikák randomizálással lecsökkentik a komplexitást <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>MN</em></span><sup>3</sup><span class="emphasis"><em>)</em></span>-re. Ezen algoritmus alkalmazásának eredményei a tűzőgépre a 24.22. ábrán láthatók.</p><div class="figure"><a id="id787138"/><p class="title"><strong>24.22. ábra - (a) A tűzőgép fényképén talált sarkok. (b) Az eredeti képre ráhelyezett hipotetikus rekonstrukció (Clark Olson hozzájárulásával).</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/24-22.png" alt="(a) A tűzőgép fényképén talált sarkok. (b) Az eredeti képre ráhelyezett hipotetikus rekonstrukció (Clark Olson hozzájárulásával)."/></div></div></div></div><div class="footnotes"><br/><hr/><div class="footnote"><p class="footnote text"><sup>[<a id="ftn.id786457" href="#id786457" class="para">273</a>] </sup> A teljes elforgatásinvariancia nem szükséges és nem is kívánatos – ekkor a 9-es és a 6-os összekeverhető lenne!</p></div><div class="footnote"><p class="footnote text"><sup>[<a id="ftn.id786572" href="#id786572" class="para">274</a>] </sup> A modern számítógépes grafikában erre az ötletre az <span class="strong"><strong>áttűnés</strong></span>sel,<span class="strong"><strong> morfolás</strong></span>sal (<span class="strong"><strong>morphing</strong></span>) hivatkoznak.</p></div></div></div></body></html>
