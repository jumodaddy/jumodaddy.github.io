<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/></head><body><div class="section" title="Lokális keresés folytonos terekben"><div class="titlepage"><div><div><h1 class="title"><a id="id557560"/>Lokális keresés folytonos terekben</h1></div></div></div><p>A 2. fejezetben bemutattuk a diszkrét és a folytonos környezet közötti különbséget, arra is rámutatva, hogy a valósvilág-beli környezetek többsége folytonos. Az eddig leírt algoritmusok közül azonban egyik sem képes a folytonos állapottereket kezelni. Az állapotátmenet-függvény az esetek többségében végtelen számú állapottal térne vissza! Ez a részfejezet egy <span class="emphasis"><em>nagyon rövid</em></span> bevezetőt ad néhány olyan lokális keresési technikához, melyek folytonos térben keresik az optimális megoldást. A téma irodalma óriási. Sok alaptechnika már a 17. században napvilágot látott, Newton és Leibniz kalkulusának kifejlődését<sup>[<a id="id557570" href="#ftn.id557570" class="footnote">45</a>]</sup> követően. E technikákhoz a könyvben több helyen fogunk folyamodni, beleértve a tanulásról, a látásról és a robotikáról szóló fejezeteket. Röviden, mindenhol, ahol a valós világgal foglalkozunk.</p><div class="important" title="Fontos" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Fontos</h3><p><span class="strong"><strong>Evolúció és keresés</strong></span></p><p>Az <span class="strong"><strong>evolúció</strong></span> elméletét Charles Darwin az <span class="emphasis"><em>On the Origin of Species by Means of Natural Selection</em></span> c. művében (Darwin, 1859) dolgozta ki. A központi gondolat igen egyszerű: a reprodukcióban (<span class="strong"><strong>mutáció</strong></span>ként ismert) eltérések fordulnak elő, és azokat a következő generációk nagyjából a reprodukciós fitnessre gyakorolt hatásuk arányában megtartják.</p><p>A darwini elméletet annak ismerete nélkül dolgozták ki, hogy a szervezetek tulajdonságai hogyan öröklődnek és módosulnak. E folyamatokat irányító valószínűségi törvényeket első ízben Gregor Mendel szerzetes azonosította (Mendel, 1866), aki borsóval kísérletezett, saját szavaival mesterséges megtermékenyítést alkalmazva. Sokkal később Watson és Crick feltárták a DNS-molekula szerkezetét és ábécéjét – AGTC (adenin, guanin, timin, citozin) – (Watson és Crick, 1953). A standard modellben a betűszekvenciában változás pontmutáció és „keresztezés” révén áll be (ahol az utód DNS-e a szülői DNS-ek hosszú részleteinek  kombinálásával jön létre).</p><p>A lokális keresési algoritmus analógiájáról írtunk már. A sztochasztikus nyaláb keresés és az evolúció közötti alapvető különbség a <span class="emphasis"><em>szexuális</em></span> reprodukció használata, ahol az utódokat <span class="emphasis"><em>több</em></span> egyedből hozzuk létre, és nem csak egyből. Az evolúció tényleges mechanizmusai azonban sokkal gazdagabbak, mint amit a genetikus algoritmus lehetővé tenne. A mutációhoz például az átfordítás, a duplikálás, a DNS nagy szegmenseinek a mozgatása is hozzátartozik. Egyes vírusok a DNS-t az egyik szervezetből veszik és egy másik szervezetbe beillesztik. Vannak átvihető gének is, amelyek nem tesznek mást, csak egy génállományon belül  többezerszer lemásolják magukat. Olyan gének is vannak, amelyek a potenciális reprodukciós partnereknél ezeket a géneket nem tartalmazó sejteket megmérgezik, növelve így a sokszorozódás esélyét. A legfontosabb tény, hogy <span class="emphasis"><em>maguk a gének tartalmazzák annak a mechanizmusnak a kódját,</em></span> amely által a génállomány reprodukálódik, és egy szervezetté alakul át. A genetikus algoritmusokban ezek a mechanizmusok különálló programok részei, vagyis a manipulált füzérekben nem jelennek meg.</p><p>A darwini evolúció igencsak kis hatékonyságú mechanizmusnak tűnhet, hiszen vakon létrehozott kb. 10<sup>45</sup> szervezetet, anélkül hogy a keresési heurisztikáin egy csöppet is javított volna. Darwin előtt 50 évvel a különben neves francia természettudós Jean Lamarck egy olyan evolúció elméletet javasolt (Lamarck, 1809), ahol egy szervezet az <span class="emphasis"><em>élete során, adaptációja révén megszerzett tulajdonságokat</em></span> is képes az utódoknak átadni. Az ilyen mechanizmus hatékony lenne, de úgy tűnik, a természetben nem fordul elő. Sokkal később James Baldwin látszólag hasonló elmélettel állt elő (Baldwin, 1896), hogy a szervezet élete alatt megtanult viselkedés növelhetné az evolúció sebességét. Lamarck elméletével ellentétben a Baldwin-elmélet a darwini evolúcióval teljesen konzisztens, hiszen alapja egy szelekciós nyomás, amely olyan egyedekre hat, amelyek lokális optimumokat találtak a genetikus felépítésük által engedélyezett viselkedések között. A korszerű számítógépes szimulációk alátámasztják a „Baldwin-effektus” valós voltát, feltéve, hogy a „közönséges” evolúció olyan szervezeteket képes kialakítani, amelyeknél a belső hatékonysági mérték a saját tényleges fitness-értékükkel valahogy korrelál.</p></div><p>Kezdjük egy egyszerű példával. Tegyük fel, hogy valahol Romániában három új repülőteret szeretnénk létesíteni úgy, hogy a városoknak (lásd 3.2. ábra) a hozzájuk legközelebb eső repülőtérhez való távolságösszegük legyen minimális. Az állapotteret ekkor a repülőterek (<span class="emphasis"><em>x</em></span><sub>1</sub>, <span class="emphasis"><em>y</em></span><sub>1</sub>), (<span class="emphasis"><em>x</em></span><sub>2</sub>, <span class="emphasis"><em>y</em></span><sub>2</sub>) és (<span class="emphasis"><em>x</em></span><sub>3</sub>, <span class="emphasis"><em>y</em></span><sub>3</sub>) koordinátái definiálják. Ez egy <span class="emphasis"><em>hatdimenziós</em></span> tér, azt is mondhatjuk, hogy az állapotokat hat <span class="strong"><strong>változó</strong></span> (<span class="strong"><strong>variable</strong></span>) definiálja (általánosságban az állapotokat a változók <span class="emphasis"><em>n</em></span>-dimenziós <span class="strong"><strong>x</strong></span> vektora definiálja). Ebben a térben való mozgás a térképen a repülőterek áthelyezésének felel meg. Az <span class="emphasis"><em>f</em></span>(<span class="emphasis"><em>x</em></span><sub>1</sub>, <span class="emphasis"><em>y</em></span><sub>1</sub>, <span class="emphasis"><em>x</em></span><sub>2</sub>, <span class="emphasis"><em>y</em></span><sub>2</sub>, <span class="emphasis"><em>x</em></span><sub>3</sub>, <span class="emphasis"><em>y</em></span><sub>3</sub>) célfüggvényt, ha a legközelebbi városok már megvannak, bármely állapot esetére viszonylag könnyű kiszámítani, általánosságban azonban igen nehéz ezt leírni. </p><p>A folytonosság problémái egyszerűen elkerülhetők, ha az egyes állapotok szomszédságát diszkretizáljuk. Egyszerre például csak egy repülőteret, csak <span class="emphasis"><em>x</em></span> vagy <span class="emphasis"><em>y</em></span> irányban egy rögzített ±δ lépéssel lehet áthelyezni. Ez 6 változó mellett, minden állapotban 12 követőt eredményez. Ehhez az előbb megismert bármelyik lokális keresési algoritmust alkalmazhatjuk. A sztochasztikus hegymászó keresést és a szimulált lehűtést közvetlenül, a tér diszkretizálása nélkül is alkalmazhatjuk. Ezek az algoritmusok a követőket véletlen módon választják ki, amelyek megvalósítása δ hosszúságú véletlen vektorok generálásával lehetséges.</p><p>Sok módszer található, melyek megkísérlik a felszín <span class="strong"><strong>gradiens</strong></span>ét (<span class="strong"><strong>gradient</strong></span>) felhasználni a maximum megtalálásához. A célfüggvény gradiense egy ∇<span class="emphasis"><em>f</em></span> vektor, amely a legmeredekebb emelkedő nagyságát és irányát adja meg. Problémánk esetén:</p><p><span class="inlinemediaobject"><img src="kepek/04-01ma.png" alt="Lokális keresés folytonos terekben"/></span></p><p>Egyes esetekben a maximumot a ∇<span class="emphasis"><em>f</em></span> = 0 egyenlet megoldásával találhatjuk meg (ezt megtehetnénk például akkor, ha csak egy repülőteret helyeznénk el; a megoldás az összes város koordinátáinak számtani közepe lesz). Sok esetben azonban ezt az egyenletet zárt alakban nem lehet megoldani. Három repülőtér esetén például a gradiens kifejezése attól függ, hogy az adott állapotban mely városok esnek legközelebb az egyes repülőterekhez. Ez azt jelenti, hogy a gradienst <span class="emphasis"><em>lokálisan,</em></span> és nem <span class="emphasis"><em>globálisan</em></span> tudjuk számítani. Ennek ellenére még mindig folyamodhatunk a legmeredekebb emelkedő hegymászáshoz a pillanatnyi állapotot az</p><p><span class="strong"><strong>x </strong></span>← <span class="strong"><strong>x</strong></span> + α ∇(<span class="strong"><strong>x</strong></span>)</p><p>képlettel frissítve, ahol α egy kis konstans. Más esetekben nem biztos, hogy a célfüggvény differenciálható formában áll a rendelkezésünkre – például a repülőterek helyeit egy konkrét esetben esetleg egy nagyméretű gazdasági szimulációs szoftvercsomag futtatásával határozhatjuk meg. Az ilyen esetekben az ún. <span class="strong"><strong>empirikus gradiens</strong></span> (<span class="strong"><strong>empirical gradient</strong></span>) meghatározásához folyamodhatunk, minden koordináta mentén egy kis pozitív és negatív változáshoz kiszámítva a választ. Az empirikus gradiens keresés ugyanaz, mint a legmeredekebb emelkedő hegymászás az állapottér diszkretizált változatában.</p><p>Az „α egy kis konstans” kifejezés mögött az α-t beállító módszerek óriási választéka rejlik. Az alapprobléma az, hogyha α túl kicsi, túlságosan sok lépésre van szükség. Ha α túl nagy, a keresés könnyűszerrel túllő a maximumon. A <span class="strong"><strong>vonalkeresés</strong></span> (<span class="strong"><strong>line search</strong></span>) módszere e problémát úgy kísérli megoldani, hogy a pillanatnyi gradiens irányát – általában α ismételt megduplázásával – meghosszabbítja, amíg <span class="emphasis"><em>f</em></span> nem kezd újra csökkeni. Az a pont, ahol ez megtörténik, lesz az új aktuális állapot. </p><p>Sok probléma esetén a legjobb algoritmus a jó öreg <span class="strong"><strong>Newton–Raphson-módszer</strong></span> (Newton, 1671; Raphson, 1690). Ez a gyökhelykeresés, azaz a <span class="emphasis"><em>g</em></span>(<span class="emphasis"><em>x</em></span>) = 0 alakú egyenletek megoldásának általános módszere. Működésének alapja az <span class="emphasis"><em>x</em></span> gyök új becslésének számítása a Newton-formula szerint:</p><p><code class="code"><em><span class="remark">x </span></em>← <em><span class="remark">x </span></em>– <em><span class="remark">g</span></em>(<em><span class="remark">x</span></em>)/<em><span class="remark">g</span></em>′(<em><span class="remark">x</span></em>)</code></p><p><span class="emphasis"><em>f</em></span> maximumának vagy minimumának megkereséséhez olyan <span class="strong"><strong>x</strong></span>-et kell megkeresni, amire a <span class="emphasis"><em>gradiens</em></span> nulla (azaz ∇<span class="emphasis"><em>f </em></span>(<span class="strong"><strong>x</strong></span>) = 0). A Newton-formula <span class="emphasis"><em>g</em></span>(<span class="emphasis"><em>x</em></span>)-e így ∇<span class="emphasis"><em>f </em></span>(<span class="strong"><strong>x</strong></span>) lesz, és a frissítési egyenlete az alábbi mátrixos formában </p><p><span class="inlinemediaobject"><img src="kepek/04-02ma.png" alt="Lokális keresés folytonos terekben"/></span></p><p>írható fel, ahol <span class="strong"><strong>H</strong></span><sub><span class="emphasis"><em>f</em></span> </sub>(<span class="strong"><strong>x</strong></span>) a második deriváltak mátrixa (<span class="strong"><strong>Hesse-mátrix</strong></span>), melynek <span class="emphasis"><em>H</em></span><sub><span class="emphasis"><em>ij</em></span> </sub>elemeit a ∂<sup>2</sup><span class="emphasis"><em>f </em></span>/∂<span class="emphasis"><em>x<sub>i</sub></em></span>∂<span class="emphasis"><em>x</em></span><sub><span class="emphasis"><em>j</em></span> </sub>második deriváltak adják meg. Mivel a második deriváltak mátrixának <span class="emphasis"><em>n</em></span><sup>2</sup> eleme van, a Newton–Raphson-módszer sokdimenziós terekben drága lesz, ami számos közelítő módszer kifejlesztéséhez vezetett.</p><p>A lokális keresési módszerek számára a lokális maximumok, a gerincek és a fennsíkok folytonos terekben ugyanúgy gondot jelentenek, mint diszkrét terekben. A véletlen újraindítás és a szimulált lehűtés alkalmazható (itt is), és gyakran segít. A sokdimenziós folytonos terek azonban terebélyes helyek, ahol könnyű elveszni.</p><p>Az utolsó téma, amivel érdemes futó ismeretséget kötni a <span class="strong"><strong>korlátozott optimalizálás</strong></span> (<span class="strong"><strong>constrained optimization</strong></span>). Egy optimalizálási probléma korlátozott, ha a megoldásnak minden változójának értékeire nézve valamilyen kemény korlátozást kell teljesítenie. A repülőteres problémánkban korlátozhatjuk például a helyszíneket, hogy a repülőterek Románián belül és szárazföldön (nem tavak közepén) helyezkedjenek el. A korlátozott optimalizálás nehézségei a korlátozások és a célfüggvény természetén múlnak. A legismertebb kategóriát a <span class="strong"><strong>lineáris programozás</strong></span>i (<span class="strong"><strong>linear programming</strong></span>) problémák jelentik, ahol a korlátozások lineáris egyenlőtlenségek, amelyek egy <span class="emphasis"><em>konvex</em></span> régiót képeznek, és ahol a célfüggvény szintén lineáris. A lineáris programozási problémákat változó számban polinomiális időben meg lehet oldani. Olyan problémákat is tanulmányoztak, ahol más típusú korlátozások és célfüggvények fordulnak elő. Ilyen problémák például a kvadratikus programozási feladat, a másodrendű kónikus programozási feladat stb.</p><div class="footnotes"><br/><hr/><div class="footnote"><p class="footnote text"><sup>[<a id="ftn.id557570" href="#id557570" class="para">45</a>] </sup> A többváltozós kalkulus és a vektoraritmetika ismerete hasznos ennek a részfejezetnek az olvasásához.</p></div></div></div></body></html>
