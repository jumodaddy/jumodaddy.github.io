<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/></head><body><div class="section" title="Alfa-béta nyesés"><div class="titlepage"><div><div><h1 class="title"><a id="id570057"/>Alfa-béta nyesés</h1></div></div></div><p>A minimax keresés problémája, hogy a játékban a megvizsgálandó állapotok száma exponenciális a lépések számában. A kitevőtől sajnos megszabadulni nem tudunk, ám lényegében megfelezhetjük. A trükk az, hogy lehetséges a korrekt minimax döntés kiszámítása anélkül, hogy a játékfában minden csomópontra rá kelljen nézni. Ehhez kölcsönözhetjük a 4. fejezetben megismert <span class="strong"><strong>nyesés</strong></span> (<span class="strong"><strong>prunning</strong></span>) gondolatát, és a játékfa nagyobb részét a megfontolásokból kihagyhatjuk. A konkrét vizsgált technika az <span class="strong"><strong>alfa-béta nyesés</strong></span> (<span class="strong"><strong>alpha-beta prunning</strong></span>). Ha ezt egy standard minimax fára alkalmazzuk, ugyanazt az eredményt adja vissza, mint a minimax, a döntésre hatással nem lévő ágakat azonban lenyesi.</p><p>Tekintsük ismét a 6.2. ábrán látható egylépésváltásos játékfát. Kövessük még egyszer az optimális döntés kiszámításának menetét, most azonban kísérjük figyelemmel, hogy mit is tudunk valójában a folyamat minden pontjában. A lépésekhez a 6.5. ábra ad magyarázatot. Az eredmény az, hogy meg tudjuk határozni a minimax döntést anélkül, hogy a két levélcsomópontot bármikor is megnéznénk.</p><p>A módszert értelmezhetjük másképpen is, mint a <code class="code">MINIMAX-ÉRTÉK</code> függvény egy egyszerűsítését. Legyen a <span class="emphasis"><em>C</em></span> csomópontot a 6.5. ábrán látható, ki nem értékelt követő csomópontok értéke <span class="emphasis"><em>x</em></span> és <span class="emphasis"><em>y</em></span>, és legyen <span class="emphasis"><em>z</em></span> a kettő minimuma. A gyökércsomópont értéke ekkor:</p><p><code class="code">MINIMAX-ÉRTÉK</code> (<span class="emphasis"><em>gyökér</em></span>) = max(min(3, 12, 8), min(2, <span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>), min(14, 5, 2)</p><p>			   = max(3, min(2, <span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>), 2)</p><p>			  = max(3, <span class="emphasis"><em>z</em></span>, 2)		ahol <span class="emphasis"><em>z</em></span> ≤ 2</p><p>			   = 3</p><p>Más szóval a gyökér értéke és így a minimax döntés <span class="emphasis"><em>független</em></span> a lenyesett levelek <span class="emphasis"><em>x</em></span> és <span class="emphasis"><em>y</em></span> értékeitől.</p><div class="important" title="Fontos" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Fontos</h3><p>Az alfa-béta nyesést tetszőleges mélységű fákra lehet alkalmazni, és sokszor lehetséges, hogy levelek helyett teljes részfákat nyessünk le. Az általános elv az alábbi: tekintsünk egy olyan <span class="emphasis"><em>n</em></span> csomópontot valahol a fa belsejében (lásd 6.6. ábra), hogy a Játékosnak lehetősége legyen e csomópontba lépni. Ha a Játékosnak van az <span class="emphasis"><em>n</em></span> szülőcsomópontjánál vagy ettől feljebb bármelyik döntési pontban egy jobb választása, <span class="emphasis"><em>m</em></span>, akkor <span class="emphasis"><em>az n-t az aktuális játékban soha nem érjük el</em></span>. Ha az <span class="emphasis"><em>n</em></span>-ről tehát (néhány követőjének megvizsgálásával) már eleget tudunk, hogy ehhez a konklúzióhoz jussunk, a csomópontot nyugodtan lenyeshetjük.</p></div><p>Emlékezzünk, hogy a minimax keresés mélységi keresés, egy adott időben tehát elegendő a fában egy egyedi út menti csomópontokkal foglalkozni. Az alfa-béta nyesés megnevezése két paramétertől származik, mely paraméterek az út mentén megjelenő visszaléptetett értékek korlátjaira vonatkoznak:</p><p>α = az út mentén tetszőleges döntési pontban a <code class="code">MAX</code><span class="emphasis"><em> </em></span>számára eddig megtalált legjobb (azaz a legmagasabb értékű) választás értéke.</p><p><span class="emphasis"><em>β</em></span> = az út mentén tetszőleges döntési pontban a <code class="code">MIN</code><span class="emphasis"><em> </em></span>számára eddig megtalált legjobb (azaz a legkisebb értékű) választás értéke.</p><div class="figure"><a id="id570199"/><p class="title"><strong>6.5. ábra - Az optimális döntés kiszámításának lépései a 6.2. ábrán látható játékfa esetén. Minden ponton a lehetséges értékek terjedelmét mutatjuk meg minden egyes csomópont számára. (a) A <span class="emphasis"><em>B</em></span> csomópont alatt az első levélnek 3 az értéke. <span class="emphasis"><em>B</em></span> tehát, ami egy <code class="code">MIN</code> csomópont, <span class="emphasis"><em>legfeljebb</em></span> 3 értékű. (b) A <span class="emphasis"><em>B</em></span> alatti második csomópontnak 12 az értéke. <code class="code">MIN</code> ezt a lépést elkerüli, így <span class="emphasis"><em>B</em></span> értéke még mindig legfeljebb 3. (c) A <span class="emphasis"><em>B</em></span> alatti harmadik levélnek 8 az értéke. <span class="emphasis"><em>B</em></span> összes követőit láttuk már, <span class="emphasis"><em>B</em></span> értéke tehát pontosan 3. Most azt következtethetjük ki, hogy a gyökér értéke <span class="emphasis"><em>legalább</em></span> 3, mert <code class="code">MAX</code>-nak a gyökérben 3-as értékű választása van. (d) A <span class="emphasis"><em>C</em></span> alatti első levélnek 2 az értéke. <span class="emphasis"><em>C</em></span> tehát, ami egy <code class="code">MIN</code> csomópont, <span class="emphasis"><em>legfeljebb</em></span> 2 értékű. De mi tudjuk már, hogy <span class="emphasis"><em>B</em></span>-nek 3 az értéke, <code class="code">MAX</code> tehát <span class="emphasis"><em>C</em></span>-t soha nem fogja választani. Azért nem is érdemes <span class="emphasis"><em>C</em></span> további követőit megvizsgálni. Ez az alfa-béta nyesés egy példája. (e) A <span class="emphasis"><em>D</em></span> alatti első levélnek 14 az értéke, így <span class="emphasis"><em>D</em></span> értéke <span class="emphasis"><em>legfeljebb</em></span> 14. Ez több mint <code class="code">MAX</code> legjobb alternatívája (azaz 3), meg kell vizsgálni ezért <span class="emphasis"><em>D</em></span> követőit. Jegyezzük meg, hogy most a gyökér minden követője esetén rendelkezünk értékkorláttal, a gyökér értéke legfeljebb 14. (f) <span class="emphasis"><em>D</em></span> második követőjének értéke 5, így tovább kell folytatnunk a vizsgálatot. A harmadik követő értéke 2, <span class="emphasis"><em>D</em></span> értéke tehát pontosan 2. <code class="code">MAX</code> döntése a gyökérnél, hogy <span class="emphasis"><em>B</em></span> felé kell lépni, 3-as értékkel.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/06-05.png" alt="Az optimális döntés kiszámításának lépései a 6.2. ábrán látható játékfa esetén. Minden ponton a lehetséges értékek terjedelmét mutatjuk meg minden egyes csomópont számára. (a) A B csomópont alatt az első levélnek 3 az értéke. B tehát, ami egy MIN csomópont, legfeljebb 3 értékű. (b) A B alatti második csomópontnak 12 az értéke. MIN ezt a lépést elkerüli, így B értéke még mindig legfeljebb 3. (c) A B alatti harmadik levélnek 8 az értéke. B összes követőit láttuk már, B értéke tehát pontosan 3. Most azt következtethetjük ki, hogy a gyökér értéke legalább 3, mert MAX-nak a gyökérben 3-as értékű választása van. (d) A C alatti első levélnek 2 az értéke. C tehát, ami egy MIN csomópont, legfeljebb 2 értékű. De mi tudjuk már, hogy B-nek 3 az értéke, MAX tehát C-t soha nem fogja választani. Azért nem is érdemes C további követőit megvizsgálni. Ez az alfa-béta nyesés egy példája. (e) A D alatti első levélnek 14 az értéke, így D értéke legfeljebb 14. Ez több mint MAX legjobb alternatívája (azaz 3), meg kell vizsgálni ezért D követőit. Jegyezzük meg, hogy most a gyökér minden követője esetén rendelkezünk értékkorláttal, a gyökér értéke legfeljebb 14. (f) D második követőjének értéke 5, így tovább kell folytatnunk a vizsgálatot. A harmadik követő értéke 2, D értéke tehát pontosan 2. MAX döntése a gyökérnél, hogy B felé kell lépni, 3-as értékkel."/></div></div></div><p>Az alfa-béta keresés az α és a <span class="emphasis"><em>β</em></span> értékeit munka közben frissíti, és a csomópontnál a megmaradó ágakat lenyesi (a rekurzív hívást terminálja), amint csak biztossá válik, hogy az aktuális csomópont értéke rosszabb lesz, mint az aktuális α és <span class="emphasis"><em>β</em></span> érték, <code class="code">MAX</code>-ra, illetve <code class="code">MIN</code>-re. A teljes algoritmust a 6.7. ábra mutatja. Bátorítjuk az olvasót, hogy a 6.5. ábrán látható fára alkalmazva, kövesse végig az algoritmus működését.</p><p>Az alfa-béta nyesés hatékonysága erősen függ a követő csomópontok vizsgálatának sorrendjétől. Például a 6.5. (e) és (f) ábrán <span class="emphasis"><em>D</em></span> egyetlen követőjét sem lehetne lenyesni, mert először a legrosszabb követőt (<code class="code">MIN</code> szemszögéből) generáltuk. Ha a harmadik követőt elsőnek generálnánk, a maradó kettőt le lehetne nyesni. Ez azt sugallja, hogy érdemes lenne először a legjobbnak tűnő csomópontokat megvizsgálni.</p><div class="figure"><a id="id570341"/><p class="title"><strong>6.6. ábra - Alfa-béta nyesés: általános eset. Ha <span class="emphasis"><em>m</em></span> a Játékos számára jobb, mint <span class="emphasis"><em>n</em></span>, akkor a játék során sosem fogunk elérni <span class="emphasis"><em>n</em></span>-be.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/06-06.png" alt="Alfa-béta nyesés: általános eset. Ha m a Játékos számára jobb, mint n, akkor a játék során sosem fogunk elérni n-be."/></div></div></div><p>Ha feltételezzük, hogy ez megtehető,<sup>[<a id="id570363" href="#ftn.id570363" class="footnote">56</a>]</sup> akkor az alfa-béta nyesésnek elég az <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>b</em></span><sup><span class="emphasis"><em>m</em></span>/2</sup>) csomópontot megvizsgálni, a legjobb lépés kiszámításához, a minimax <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>b<sup>m</sup></em></span>) értékével szemben. Ez azt jelenti, hogy az effektív elágazási tényező<span class="emphasis"><em> b</em></span> helyett <span class="inlinemediaobject"><img src="math/mi-06-0001.gif" alt="Alfa-béta nyesés: általános eset. Ha m a Játékos számára jobb, mint n, akkor a játék során sosem fogunk elérni n-be."/></span> lesz – például a sakk esetében 35 helyett 6. Más szóval, az alfa-béta nyesés ugyanannyi idő alatt kétszer olyan messzire néz, mint a minimax. Ha a követő csomópontokat véletlen sorrendben vizsgálnánk a legjobbat-először helyett, a vizsgált csomópontok össz-száma <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>b</em></span><sup>3<span class="emphasis"><em>m</em></span>/4</sup>) lenne, mérsékelt értékű <span class="emphasis"><em>b</em></span>-kre. A sakk esetében egy igen egyszerű rendezőfüggvény (mint például az, hogy először a leütésekkel, majd a támadásokkal, ezt követően az előrelépésekkel és végül a hátralépésekkel próbálkozunk) a legjobb esetre vonatkozó <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>b</em></span><sup><span class="emphasis"><em>m</em></span>/2</sup>) eredményt egy 2-es tényező erejéig közelíti meg. Dinamika hozzáadása a lépésrendező sémákhoz, mint például azokkal a lépésekkel próbálkozni először, amelyek legutóbb a legjobbnak bizonyultak, az elvi korláthoz egészen közel visz.</p><p>A 3. fejezetben megjegyeztük, hogy a keresési fában az ismétlődő állapotok a keresési költségekben exponenciális növekedéshez is vezethetnek. Játékokban gyakran előfordulnak ismétlődő állapotok a <span class="strong"><strong>transzpozíció</strong></span>k (<span class="strong"><strong>transposition</strong></span>s) – a lépési szekvenciának az ugyanahhoz az álláshoz vezető különböző permutációi – miatt. Ha például Fehér lépése <span class="emphasis"><em>a</em></span><sub>1</sub>, amire Fekete <span class="emphasis"><em>b</em></span><sub>1</sub> lépéssel válaszolhat, és a tábla más részén van egy vele nem kapcsolatos <span class="emphasis"><em>a</em></span><sub>2</sub> lépése, amire Fekete <span class="emphasis"><em>b</em></span><sub>2</sub>-vel válaszolhat, akkor az [<span class="emphasis"><em>a</em></span><sub>1</sub>, <span class="emphasis"><em>b</em></span><sub>1</sub>, <span class="emphasis"><em>a</em></span><sub>2</sub>, <span class="emphasis"><em>b</em></span><sub>2</sub>] és az [<span class="emphasis"><em>a</em></span><sub>1</sub>, <span class="emphasis"><em>b</em></span><sub>2</sub>, <span class="emphasis"><em>a</em></span><sub>2</sub>, <span class="emphasis"><em>b</em></span><sub>1</sub>] szekvenciák mind ugyanabban az állásban végződnek (ahogy ebben az állásban végződik az előbbi lépések minden <span class="emphasis"><em>a</em></span><sub>2</sub>-vel kezdődő permutációja). Érdemes ennek az állásnak a kiértékelését az első előforduláskor egy hash-táblában eltárolni, mert így a későbbi előfordulásoknál a kiszámítás megismétlését megspóroljuk.</p><p>Az előbb látott pozíciók hash-tábláját hagyományosan<span class="strong"><strong> transzpozíciós táblá</strong></span>nak (<span class="strong"><strong>trans</strong></span><span class="strong"><strong>position table</strong></span>) hívják. Ez lényegében azonos a <code class="code">GRÁF-KERESÉS</code> <span class="emphasis"><em>zárt</em></span> listájával <a class="xref" href="ch03s05.md#ID_122_oldal">„Az Ismételt állapotok elkerülése”</a>. A transzpozíciós tábla használata drámai hatású lehet és a sakkban néha az elérhető mélység megduplázásához vezet. Másrészt ha másodpercenként a csomópontok millióit értékeljük ki, nem praktikus ezeket <span class="emphasis"><em>mind</em></span> a transzpozíciós táblában tartani. A legértékesebb csomópontok megválasztására különböző stratégiákat dolgoztak ki.</p><div class="figure"><a id="id570553"/><p class="title"><strong>6.7. ábra - Az alfa-béta keresési algoritmus. Ugyanazt a számítást hajtja végre, mint egy normál minimax algoritmus a 6.3. ábrán, kivéve két sort a <code class="code">MAX-ÉRTÉK</code> és a <code class="code">MIN-ÉRTÉK</code> hívásokban, ahol az α és a β értékeket kezeli (és adminisztrálja e paraméterek átadását).</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/06-07.png" alt="Az alfa-béta keresési algoritmus. Ugyanazt a számítást hajtja végre, mint egy normál minimax algoritmus a 6.3. ábrán, kivéve két sort a MAX-ÉRTÉK és a MIN-ÉRTÉK hívásokban, ahol az α és a β értékeket kezeli (és adminisztrálja e paraméterek átadását)."/></div></div></div><div class="footnotes"><br/><hr/><div class="footnote"><p><sup>[<a id="ftn.id570363" href="#id570363" class="para">56</a>] </sup> Természetesen nem tökéletes módon, különben a sorbarendező-függvény segítségével egy hibátlan játékot tudnánk játszani.</p></div></div></div></body></html>
