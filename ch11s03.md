<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/></head><body><div class="section" title="Részben rendezett tervkészítés"><div class="titlepage"><div><div><h1 class="title"><a id="id641806"/>Részben rendezett tervkészítés</h1></div></div></div><p class="2">Az előre- és hátrafelé keresés a <span class="emphasis"><em>teljesen rendezett</em></span> terv keresés speciális fajtái. Ezek a cselekvéseknek csak szigorúan lineáris sorozatait tárják fel, melyek közvetlenül kapcsolódnak a kiinduláshoz vagy a célhoz. Ez annyit tesz, hogy nem használhatják ki a problémadekompozíció lehetőségeit. Ahelyett hogy a részproblémákon külön dolgoznának, mindig arról kell dönteniük, hogy hogyan sorrendezzék a részproblémák cselekvéseinek összességét. Előnyösebb lenne egy olyan megközelítés, ami több részcélon dolgozik függetlenül, ezeket több résztervvel megoldja, majd összerakja a részterveket.</p><p class="Tartalom3">Egy ilyen megközelítésnek megvan az az előnye is, hogy rugalmas a terv <span class="emphasis"><em>összeállításának</em></span> sorrendjében. A tervkészítő így nem kényszerül arra, hogy a lépéseken időrendi sorrendben dolgozzon, hanem először inkább a „nyilvánvaló” vagy „fontos” döntéseken dolgozhat. Például egy Berkeleyben lévő tervkészítő ágens, amely Monte Carlóba igyekszik, először egy San Francisco–Párizs járatot vizsgál meg, majd amikor ismeri a pontos indulási és érkezési dátumokat, foglalkozhat a reptérre kijutás, illetve az onnan továbbjutás problémájával.</p><p>Azt az általános stratégiát, mely szerint egy választást késleltetünk egy keresés során, <span class="strong"><strong>legkisebb megkötés</strong></span> (<span class="strong"><strong>least commitment</strong></span>) stratégiának nevezzük. A legkisebb megkötésnek nincs formális definíciója, és nyilvánvaló, hogy valamennyi megkötés szükséges, különben a keresés nem haladna. Az informális definíció ellenére a legkisebb megkötés nagyon hasznos megközelítés annak meghatározására, hogy a döntéseket mikor kell meghozni egy keresési problémában. Az első példánk jóval egyszerűbb, mint egy nyaralás megtervezése. Vegyük a cipőfelvétel egyszerű esetét. Ezt formálisan a következő tervkészítési problémával írhatjuk le:</p><p><code class="code"><em><span class="remark">Cél</span></em>(<em><span class="remark">JobbCipőFenn </span></em>∧ <em><span class="remark">BalCipőFenn</span></em>)</code></p><p><code class="code"><em><span class="remark">Kiindulás</span></em>()</code></p><p><code class="code"><em><span class="remark">Cselekvés</span></em>(<em><span class="remark">JobbCipő</span></em>, Előfeltétel: <em><span class="remark">JobbZokniFenn</span></em>, Következmény:<em><span class="remark"> JobbCipőFenn</span></em>)</code></p><p><code class="code"><em><span class="remark">Cselekvés</span></em>(<em><span class="remark">JobbZokni</span></em>, Következmény:<em><span class="remark"> JobbZokniFenn</span></em>)</code></p><p><code class="code"><em><span class="remark">Cselekvés</span></em>(<em><span class="remark">BalCipő</span></em>, Előfeltétel: <em><span class="remark">BalZokniFenn</span></em>, Következmény:<em><span class="remark"> BalCipőFenn</span></em>)</code></p><p><code class="code"><em><span class="remark">Cselekvés</span></em>(<em><span class="remark">BalZokni</span></em>, Következmény:<em><span class="remark"> BalZokniFenn</span></em>)</code></p><p>A tervkészítőnek két cselekvéssorozattal kell előállnia, a <span class="emphasis"><em>JobbZokni-</em></span>t a <span class="emphasis"><em>JobbCipő</em></span> követi, hogy a cél első konjunktját elérjük és a <span class="emphasis"><em>BalZokni-</em></span>t a <span class="emphasis"><em>BalCipő</em></span> követi a második konjunkthoz. A két cselekvéssorozat kombinálható, hogy teljes tervet nyerjünk. Így a tervkészítő a két részsorozatot egymástól függetlenül kezelheti anélkül, hogy felállítana bármi megkötést arra, hogy az egyik sorozat egy cselekvése a másikéhoz képest előbb vagy később következik. Bármely olyan tervkészítő algoritmust, ami két cselekvést be tud illeszteni egy tervbe anélkül, hogy meghatározná azok sorrendjét, <span class="strong"><strong>részben rendezett tervkészítő</strong></span>nek nevezünk (<span class="strong"><strong>partial-order planner</strong></span>). A 11.6. ábra a cipő és zokni felvételére készített részben rendezett tervet szemlélteti. Vegyük észre, hogy a megoldást a cselekvések gráfja ábrázolja, nem egy szekvencia. Érdemes megfigyelni az <span class="emphasis"><em>Indít</em></span> és a <span class="emphasis"><em>Befejez</em></span> „technikai” cselekvéseket, melyek a terv kezdetét, illetve végét jelölik. Ezeket cselekvésnek nevezni egyszerűsíti a dolgokat, mert így a terv minden lépése egy cselekvés. A részben rendezett megoldás hat teljesen rendezett megoldásnak felel meg, melyek mindegyike a részben rendezett megoldásnak egy <span class="strong"><strong>sorba rendezése</strong></span> (<span class="strong"><strong>linearization</strong></span>).</p><div class="figure"><a id="id642815"/><p class="title"><strong>11.6. ábra - Egy részben rendezett terv a zokni és a cipő felvételéhez, és a hat lehetséges sorba rendezés a teljesen rendezett tervhez</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/11-06.png" alt="Egy részben rendezett terv a zokni és a cipő felvételéhez, és a hat lehetséges sorba rendezés a teljesen rendezett tervhez"/></div></div></div><p class="Képalá">A részben rendezett tervkészítés megvalósítható, mint egy keresés a részben rendezett tervek terében. (Ezentúl ezeket egyszerűen csak „terv”-nek nevezzük.) Egy üres tervvel indulunk. Ezután a terv finomításának módjait keressük egészen addig, míg elő nem állunk a teljes tervvel, ami megoldása a problémának. A cselekvések ebben a keresésben nem a való világ cselekvései, hanem terveken végrehajtott műveletek: egy lépés hozzáadása a tervhez, a cselekvésekhez egy sorrend rendelése, ami egy cselekvést egy másik elé helyez és így tovább.</p><p class="Tartalom3">A továbbiakban definiálni fogjuk az RRT algoritmust a részben rendezett tervkészítéshez. Hagyományosan az RRT-t mint egy önálló programot szokás bemutatni, ehelyett mi a részben rendezett tervkészítést, mint a keresési probléma egy példányát fogjuk megfogalmazni. Ez lehetővé teszi, hogy az alkalmazható tervfinomító lépésekre koncentráljunk ahelyett, hogy azt vizsgálnánk, hogyan térképezi fel a keresési teret az algoritmus. Valójában, ha a keresési feladatot megfogalmaztuk a nem informált vagy heurisztikus keresési módszerek széles választéka áll rendelkezésre.</p><p class="Tartalom3">Emlékezzünk vissza, hogy a keresésünk állapotai (többnyire még befejezetlen) tervek lesznek. Hogy elkerüljük a valós cselekvésekkel való keveredést, itt tervekről és nem állapotokról fogunk beszélni. Minden terv a következő négy komponensből áll, ahol az első kettő a terv lépéseit definiálja, míg az utolsó kettő naplózásra szolgál, hogy abból meghatározzuk, hogyan bővíthetők a tervek:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="Tartalom3"><span class="strong"><strong>Cselekvés</strong></span>ek (<span class="strong"><strong>action</strong></span>s) halmaza, amelyek a terv lépéseit adják. Ezeket a tervkészítési probléma cselekvéshalmazából vesszük. Egy „üres” terv csak az <span class="emphasis"><em>Indít</em></span> és a <span class="emphasis"><em>Befejez </em></span>cselekvéseket tartalmazza. Az <span class="emphasis"><em>Indít</em></span>-nak nincsenek előfeltételei, míg a következményrésze a tervkészítési feladat kiindulási állapotának literáljait tartalmazza. A <span class="emphasis"><em>Befejez </em></span>cselekvésnek nincsen következmény része, míg előfeltételei megegyeznek a célállapot literáljaival.</p></li><li class="listitem"><p class="Tartalom3"><span class="strong"><strong>Rendezési kényszer</strong></span>ek (<span class="strong"><strong>ordering constraint</strong></span>s). Minden rendezési kényszer <span class="emphasis"><em>A</em></span> ≺ <span class="emphasis"><em>B</em></span> alakú, amit „<span class="emphasis"><em>B</em></span> előtt <span class="emphasis"><em>A</em></span>”-nak olvasunk, és azt jelenti, hogy az <span class="emphasis"><em>A</em></span>-t valamikor a <span class="emphasis"><em>B</em></span> előtt kell végrehajtani, de nem feltétlenül közvetlen előtte. A rendezési kényszerek egy megfelelő részben rendezést kell leírjanak. Bármilyen ciklus (mint az<span class="emphasis"><em> A</em></span> ≺ <span class="emphasis"><em>B </em></span>és a <span class="emphasis"><em>B</em></span> ≺ <span class="emphasis"><em>A</em></span>) ellentmondást jelent, ezért olyan rendezési kényszer nem adható a tervhez, amely ciklust hozna létre.</p></li><li class="listitem"><p class="Tartalom3"><span class="strong"><strong>Okozati kapcsolatok</strong></span> (<span class="strong"><strong>causal link</strong></span>s). Az <span class="emphasis"><em>A</em></span> és <span class="emphasis"><em>B</em></span> cselekvések közötti okozati kapcsolatot <span class="inlinemediaobject"><img src="math/mi-11-0001.gif" alt="Egy részben rendezett terv a zokni és a cipő felvételéhez, és a hat lehetséges sorba rendezés a teljesen rendezett tervhez"/></span>-vel jelöljük és úgy olvassuk, hogy „<span class="emphasis"><em>A</em></span> teljesíti <span class="emphasis"><em>p</em></span>-t <span class="emphasis"><em>B</em></span>-hez”. Például a <span class="inlinemediaobject"><img src="math/mi-11-0002.gif" alt="Egy részben rendezett terv a zokni és a cipő felvételéhez, és a hat lehetséges sorba rendezés a teljesen rendezett tervhez"/></span> okozati kapcsolat jelentése, hogy a <span class="emphasis"><em>JobbZokniFenn</em></span> egy következménye a <span class="emphasis"><em>JobbZokni</em></span> cselekvésnek és előfeltétele<span class="emphasis"><em> </em></span>a <span class="emphasis"><em>JobbCipő</em></span>-nek. Tartalmazza azt a megkötést is, hogy a <span class="emphasis"><em>JobbZokniFenn</em></span>-nek igaznak kell maradnia a <span class="emphasis"><em>JobbZokni</em></span> cselekvéstől a <span class="emphasis"><em>JobbCipő</em></span> cselekvésig. Más szavakkal, a terv nem mindig bővíthető egy új <span class="emphasis"><em>C</em></span> cselekvéssel, ami <span class="strong"><strong>ütközik</strong></span> egy okozati kapcsolattal. Egy <span class="emphasis"><em>C</em></span> cselekvés ütközik az <span class="inlinemediaobject"><img src="math/mi-11-0003.gif" alt="Egy részben rendezett terv a zokni és a cipő felvételéhez, és a hat lehetséges sorba rendezés a teljesen rendezett tervhez"/></span>-vel, ha <span class="emphasis"><em>C</em></span> következménye a ¬<span class="emphasis"><em>p</em></span>, és ha <span class="emphasis"><em>C</em></span> az <span class="emphasis"><em>A</em></span> után és <span class="emphasis"><em>B</em></span> előtt jöhet (a rendezési kényszereknek megfelelően). Néhány szerző az okozati kapcsolatokat <span class="strong"><strong>védett tartomány</strong></span>oknak (<span class="strong"><strong>protection interval</strong></span>s) nevezi, mert az <span class="inlinemediaobject"><img src="math/mi-11-0004.gif" alt="Egy részben rendezett terv a zokni és a cipő felvételéhez, és a hat lehetséges sorba rendezés a teljesen rendezett tervhez"/></span> megvédi <span class="emphasis"><em>p</em></span>-t a negálástól az <span class="emphasis"><em>A</em></span>–<span class="emphasis"><em>B</em></span> intervallumban.</p></li><li class="listitem"><p class="Tartalom3"><span class="strong"><strong>Nyitott előfeltétel</strong></span>ek (<span class="strong"><strong>open precondition</strong></span>s). Egy előfeltétel nyitott, ha nem teljesül a terv egy akciójának hatására. A tervkészítők feladata, hogy a nyitott előfeltételek halmazát üres halmazra csökkentse, ellentmondások bevezetése nélkül.</p></li></ul></div><p>Például a 11.6. ábrán bemutatott teljes terv a következő komponenseket tartalmazza (nem tüntettük fel a rendezési kényszereket, amelyek minden cselekvést az <span class="emphasis"><em>Indít</em></span> után és a <span class="emphasis"><em>Befejez</em></span> elé helyeznek):</p><p><code class="code">Cselekvések:{<em><span class="remark">JobbZokni</span></em>,<em><span class="remark"> JobbCipő</span></em>,<em><span class="remark"> BalZokni</span></em>,<em><span class="remark"> BalCipő</span></em>,<em><span class="remark"> Indít</span></em>,<em><span class="remark"> Befejez</span></em>}</code></p><p><code class="code">Rendezések: {<em><span class="remark">JobbZokni</span></em> ≺ <em><span class="remark">JobbCipő</span></em>,<em><span class="remark"> BalZokni</span></em> ≺ <em><span class="remark">BalCipő</span></em>}</code></p><p><code class="code"><span class="inlinemediaobject"><img src="math/mi-11-0005.gif" alt="Egy részben rendezett terv a zokni és a cipő felvételéhez, és a hat lehetséges sorba rendezés a teljesen rendezett tervhez"/></span></code></p><p><code class="code">Nyitott előfeltételek: {}</code></p><div class="important" title="Fontos" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Fontos</h3><p><span class="strong"><strong>Konzisztens terv</strong></span>nek (<span class="strong"><strong>consistent plan</strong></span>) nevezzük azt a tervet, amelyben nincsenek ciklusok a rendezési megkötésekben és nincsenek ellentmondások az okozati kapcsolatokkal. Egy konzisztens terv, mely nyitott előfeltételektől mentes, a <span class="strong"><strong>megoldás </strong></span>(<span class="strong"><strong>solution</strong></span>). Rövid gondolkodással belátható: <span class="emphasis"><em>egy részben rendezett megoldás minden sorba rendezése egy teljesen rendezett megoldás</em></span>,<span class="emphasis"><em> melynek végrehajtása az induló állapotból egy célállapotra vezet. </em></span>Ez annyit tesz, hogy a „terv végrehajtását” a teljesen rendezett tervekről kiterjeszthetjük a részben rendezett tervekre. Egy részben rendezett terv végrehajtása során ismétlődően mindig választunk egy következő cselekvést, a lehetséges következő cselekvések <span class="emphasis"><em>bármelyikét</em></span>. A 12. fejezetben látni fogjuk, hogy az ágens számára a terv végrehajtásának rugalmassága nagyon hasznos lehet, ha a környezet nem az elvártaknak megfelelően működik. A rugalmas sorrendezés egyszerűsíti a kisebb tervek összekombinálását nagyobbakká, mert minden részterv átrendezheti a cselekvéseinek sorrendjét, hogy elkerülje a más tervekkel való ütközést.</p></div><p>Most már készen állunk arra, hogy formalizáljuk azt a keresési problémát, amit az RRT megold. Egy olyan formalizálással kezdünk, ami az ítéletlogikai tervkészítési problémákra alkalmas, az elsőrendű logikai megoldással járó komplikációkat későbbre hagyjuk. Mint rendszerint, a definíció tartalmazza a kiinduló állapotot, a cselekvéseket és a céltesztet.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>A kiindulási terv egy <span class="emphasis"><em>Indít</em></span> és egy <span class="emphasis"><em>Befejez </em></span>cselekvést, egy <span class="emphasis"><em>Indít </em></span>≺ <span class="emphasis"><em>Befejez</em></span> rendezést tartalmaz, és nincsenek okozati kapcsolatok. A <span class="emphasis"><em>Befejez </em></span>minden előfeltétele nyitott.</p></li><li class="listitem"><p>Az állapotátmenet-függvény önkényesen kiválasztja <span class="emphasis"><em>B</em></span> egy <span class="emphasis"><em>p</em></span> nyitott előfeltételét és legenerál egy következő tervet egy <span class="emphasis"><em>A</em></span> cselekvés minden olyan lehetséges konzisztens megválasztásához, mely teljesíti <span class="emphasis"><em>p</em></span>-t. A konzisztenciát a következőképp biztosítjuk:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Az <span class="inlinemediaobject"><img src="math/mi-11-0006.gif" alt="Egy részben rendezett terv a zokni és a cipő felvételéhez, és a hat lehetséges sorba rendezés a teljesen rendezett tervhez"/></span> okozati kapcsolatot és az <span class="emphasis"><em>A</em></span> ≺ <span class="emphasis"><em>B</em></span> rendezési megkötést hozzáadjuk a tervhez. Az <span class="emphasis"><em>A</em></span> cselekvés lehet a terv egy már létező vagy egy új cselekvése. Amennyiben új, hozzáadjuk a tervhez az <span class="emphasis"><em>Indít </em></span>≺ <span class="emphasis"><em>A</em></span> és az <span class="emphasis"><em>A</em></span> ≺ <span class="emphasis"><em>Befejez</em></span>  megkötésekkel.</p></li><li class="listitem"><p>Feloldunk minden konfliktust, az új okozati kapcsolat és az összes létező cselekvés, valamint az <span class="emphasis"><em>A</em></span> cselekvés (ha új) és minden létező okozati kapcsolat között. Egy az <span class="inlinemediaobject"><img src="math/mi-11-0007.gif" alt="Egy részben rendezett terv a zokni és a cipő felvételéhez, és a hat lehetséges sorba rendezés a teljesen rendezett tervhez"/></span> és <span class="emphasis"><em>C</em></span> között fennálló konfliktust azáltal oldunk fel, hogy <span class="emphasis"><em>C</em></span>-t valamikor kívül helyezzük a védett intervallumon a <span class="emphasis"><em>B</em></span> ≺ <span class="emphasis"><em>C</em></span> vagy a <span class="emphasis"><em>C </em></span>≺ <span class="emphasis"><em>A </em></span>hozzáadásával. Amennyiben konzisztens tervet adnak, beszúrjuk a követő állapotokat, valamelyikhez vagy akár mindkettőhöz.</p></li></ol></div></li><li class="listitem"><p>A célteszt ellenőrzi, hogy a terv megoldása-e az eredeti tervkészítési problémának. Mivel csak konzisztens terveket állítunk elő, a céltesztnek csak azt kell ellenőrizni, hogy vannak-e nem nyitott előfeltételek.</p></li></ul></div><p>Emlékezzünk, hogy keresési algoritmus által vizsgált cselekvések ebben a felírásban sokkal inkább tervfinomító lépések, mint valós cselekvések a feladattérből. Az út költsége ezért szigorú értelembe véve irreleváns, hiszen az egyetlen ami fontos, az azon terv valós cselekvéseinek költsége, amire ez az út vezetett. Mindazonáltal <span class="emphasis"><em>lehetséges</em></span> egy útvonalköltség-függvény specifikálása, ami a valós terv költségeit tükrözi: minden valós cselekvésnek a tervhez való hozzáadását egységnyi költséggel, míg a finomító lépéseket 0 költséggel vesszük figyelembe. Így <span class="emphasis"><em>g</em></span>(<span class="emphasis"><em>n</em></span>), ahol <span class="emphasis"><em>n</em></span> a terv, egyenlő lesz a tervben található valós cselekvések számával. Egy heurisztikus <span class="emphasis"><em>h</em></span>(<span class="emphasis"><em>n</em></span>) becslés szintén alkalmazható.</p><p class="Tartalom3">Első ránézésre azt gondolhatjuk, hogy az állapotátmenet-függvénynek <span class="emphasis"><em>minden</em></span> nyitott <span class="emphasis"><em>p</em></span>-hez tartalmaznia kellene egy következő állapotot, nem csak egyhez. Ez azonban, redundáns lenne és nem lenne hatékony, ugyanazon okból, amiért a kényszerkielégítési algoritmusok nem szúrnak be minden lehetséges változóhoz utódot: a nyitott előfeltételek kezelési sorrendje (csakúgy, mint a kényszerkielégítési probléma változóinak kezelési sorrendje) kommutatív. (Lásd <a class="xref" href="ch05s02.md#ID_187_oldal">„A visszalépéses keresés alkalmazása kényszerkielégítési problémákra”</a> részben.) Így tetszőleges sorrendet választhatunk, és az algoritmusaink még mindig teljesek. A helyes rendezés megválasztása gyorsabb kereséshez vezethet, de minden sorrendezés ugyanazokra a megoldásjelöltekre vezet.</p><div class="section" title="Példa a részben rendezett tervkészítésre"><div class="titlepage"><div><div><h2 class="title"><a id="id643337"/>Példa a részben rendezett tervkészítésre</h2></div></div></div><a id="ID_468_oldal"/><p class="3">Most nézzük meg, hogy az RRT hogyan oldja meg a 11.1. alfejezetben szereplő pótkerék problémát. A probléma a leírását a 11.7. ábrán megismételjük.</p><div class="figure"><a id="id643347"/><p class="title"><strong>11.7. ábra - Az egyszerű kerékcsere probléma</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/11-07.png" alt="Az egyszerű kerékcsere probléma"/></div></div></div><p>A megoldás keresése egy kezdeti tervből indul, ami egy <span class="emphasis"><em>Indít</em></span> cselekvést tartalmaz az  <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>) ∧ <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>LaposKerék</em></span>, <span class="emphasis"><em>Tengely</em></span>)<span class="emphasis"><em> </em></span>következménnyel és egy <span class="emphasis"><em>Befejez</em></span> cselekvést az <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) előfeltétellel. Ezután követő állapotokat állítunk elő úgy, hogy egy nyitott előfeltételt választunk a munkához (visszavonhatatlanul), majd választunk az ehhez vezető lehetséges cselekvések közül. Most nem foglalkozunk a heurisztikákkal, amik segíthetik ezt a döntést; látszólag véletlenszerű döntést hozunk. Az események sorrendje a következő:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Vegyük az egyetlen nyitott előfeltételt, a <span class="emphasis"><em>Befejez</em></span> cselekvés <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) feltételét. Válasszuk ki az egyetlen alkalmazható cselekvést, a<span class="emphasis"><em> Felszerel</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>)-t.</p></li><li class="listitem"><p>Vegyük a <span class="emphasis"><em>Felszerel</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>)<span class="emphasis"><em> </em></span>cselekvés <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Föld</em></span>)<span class="emphasis"><em> </em></span>előfeltételét. Válasszuk az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>)<span class="emphasis"><em> </em></span>cselekvést, ami az egyetlen alkalmazható cselekvés az előfeltétel biztosításához. A végső terv a 11.8. ábrán látható.</p></li></ol></div><div class="figure"><a id="id643481"/><p class="title"><strong>11.8. ábra - A nem teljes részben rendezett terv a kerékcsere problémához, miután megválasztottuk a cselekvéseket az első két nyitott előfeltételhez. A dobozok cselekvéseket testesítenek meg, a bal oldalon az előfeltételekkel, a jobb oldalon pedig a következményekkel. (Az <span class="emphasis"><em>Indít</em></span> cselekvést kivéve a következményeket elhagytuk.) A fekete nyilak az okozati kapcsolatokat mutatják, melyek a nyíl fejénél szereplő állítást védik.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/11-08.png" alt="A nem teljes részben rendezett terv a kerékcsere problémához, miután megválasztottuk a cselekvéseket az első két nyitott előfeltételhez. A dobozok cselekvéseket testesítenek meg, a bal oldalon az előfeltételekkel, a jobb oldalon pedig a következményekkel. (Az Indít cselekvést kivéve a következményeket elhagytuk.) A fekete nyilak az okozati kapcsolatokat mutatják, melyek a nyíl fejénél szereplő állítást védik."/></div></div></div><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>	Vegyük a <span class="emphasis"><em>Felszerel</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) cselekvés ¬<span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>LaposKerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) előfeltételét. Hogy ellenkezzünk egy kicsit, válasszuk az <span class="emphasis"><em>OtthagyÉjszakára</em></span> cselekvést, a kézenfekvő <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>LaposKerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) helyett. Vegyük észre, hogy az <span class="emphasis"><em>OtthagyÉjszakára</em></span> cselekvésnek szintén következménye a ¬<span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Föld</em></span>), ami ütközik az</p></li></ol></div><p><span class="inlinemediaobject"><img src="math/mi-11-0008.gif" alt="A nem teljes részben rendezett terv a kerékcsere problémához, miután megválasztottuk a cselekvéseket az első két nyitott előfeltételhez. A dobozok cselekvéseket testesítenek meg, a bal oldalon az előfeltételekkel, a jobb oldalon pedig a következményekkel. (Az Indít cselekvést kivéve a következményeket elhagytuk.) A fekete nyilak az okozati kapcsolatokat mutatják, melyek a nyíl fejénél szereplő állítást védik."/></span></p><p class="Tartalom3">	okozati kapcsolattal. Hogy feloldjuk ezt az ütközést, egy rendezési megkötést illesztünk be, ami az <span class="emphasis"><em>OtthagyÉjszakára</em></span> cselekvést az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>) elé rendeli. Az így előálló terv a 11.9. ábrán látható. (Miért oldja ez fel az ütközést és miért nincs erre más lehetőség?)</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>	Most az egyetlen fennmaradó nyitott előfeltétel az <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>), ami az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>) cselekvés előfeltétele. Az egyetlen cselekvés, ami ezt elérheti, a meglévő <span class="emphasis"><em>Indít</em></span> cselekvés, de az <span class="emphasis"><em>Indít</em></span> és az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>) közötti okozati kapcsolat ütközik az <span class="emphasis"><em>OtthagyÉjszakára</em></span> cselekvés ¬<span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>) következményével. Most nincs mód arra, hogy feloldjuk az ütközést az <span class="emphasis"><em>OtthagyÉjszakára</em></span> cselekvéssel: nem sorolhatjuk az <span class="emphasis"><em>Indít</em></span> elé (mert semmi nem kerülhet az <span class="emphasis"><em>Indít</em></span> elé), és nem rendelhető az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>) után (mert már van egy rendezés, ami elé helyezi). Ezért muszáj visszalépnünk, törölnünk az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>) cselekvést és a két utolsó okozati kapcsolatot, és visszalépnünk a 11.8. ábrán bemutatott állapothoz. </p></li></ol></div><div class="figure"><a id="id643677"/><p class="title"><strong>11.9. ábra - A terv alakulása, az <span class="emphasis"><em>OtthagyÉjszakára</em></span> választása után, amit a ¬O<span class="emphasis"><em>tt</em></span>(<span class="emphasis"><em>LaposKerék</em></span>, <span class="emphasis"><em>Tengely</em></span>)<span class="emphasis"><em> </em></span>eléréséhez választottunk. Hogy elkerüljük az ütközést az <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>)-t védő, az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>)-ból induló okozati kapcsolattal, az <span class="emphasis"><em>OtthagyÉjszakára</em></span> cselekvést egy rendezési megkötéssel az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>) elé helyeztük, amit a szaggatott nyíllal jelöltünk.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/11-09.png" alt="A terv alakulása, az OtthagyÉjszakára választása után, amit a ¬Ott(LaposKerék, Tengely) eléréséhez választottunk. Hogy elkerüljük az ütközést az Ott(Pótkerék, Csomagtartó)-t védő, az Eltávolít(Pótkerék, Csomagtartó)-ból induló okozati kapcsolattal, az OtthagyÉjszakára cselekvést egy rendezési megkötéssel az Eltávolít(Pótkerék, Csomagtartó) elé helyeztük, amit a szaggatott nyíllal jelöltünk."/></div></div></div><p>Összefoglalva, a tervkészítő bebizonyította, hogy az <span class="emphasis"><em>OtthagyÉjszakára</em></span> nem használható fel kerékcserére.</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>	Vegyük újra a <span class="emphasis"><em>Felszerel</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) cselekvés ¬<span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>LaposKerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) előfeltételét. Ez alkalommal válasszuk az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>LaposKerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) cselekvést. </p></li><li class="listitem"><p>	Vegyük újra az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>) cselekvés <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>) előfeltételét, és válasszuk az <span class="emphasis"><em>Indít</em></span> cselekvést, hogy ezt elérjük. Ez alkalommal nincsenek ütközések.</p></li><li class="listitem"><p>	Vegyük az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>LaposKerék</em></span>, <span class="emphasis"><em>Tengely</em></span> cselekvés<span class="emphasis"><em> Ott</em></span>(<span class="emphasis"><em>LaposKerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) előfeltételét, valamint ennek eléréséhez az <span class="emphasis"><em>Indít</em></span> cselekvést. Ez egy teljes és konzisztens tervet ad, vagy más szavakkal egy megoldást, amint azt a 11.10. ábra mutatja.</p></li></ol></div><div class="figure"><a id="id643847"/><p class="title"><strong>11.10. ábra - A kerékcsere probléma végső megoldása. Vegyük észre, hogy az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>) és az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>LaposKerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) tetszőleges sorrendben végrehajtható a <span class="emphasis"><em>Felszerel</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) előtt.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/11-10.png" alt="A kerékcsere probléma végső megoldása. Vegyük észre, hogy az Eltávolít(Pótkerék, Csomagtartó) és az Eltávolít(LaposKerék, Tengely) tetszőleges sorrendben végrehajtható a Felszerel(Pótkerék, Tengely) előtt."/></div></div></div><p>Bár ez a példa nagyon egyszerű, jól szemlélteti a részben rendezett tervkészítés erősségét. Először is az okozati kapcsolatok a keresési tér (fa) egy korai szűkítéséhez metszéséhez vezettek, mert kizártak olyan területeket, amelyek a feloldhatatlan ütközések miatt nem tartalmaznak megoldásokat. Másodszor a 11.10. ábra megoldása egy részben rendezett terv. Ebben az esetben ennek előnye nem nagy, mert csak két lehetséges sorba rendezés létezik, mégis egy ágens számára előnyös lehet ez a rugalmasság, például ha a kereket sűrű forgalomban kellene lecserélni.</p><p>A példa szintén rámutat néhány javítási lehetőségre. Például egy próbálkozás duplán történt: az <span class="emphasis"><em>Indít</em></span> az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>) cselekvéshez kapcsolódik még mielőtt az ütközés visszalépést váltana ki, és a visszalépés hatására a kapcsolat felbomlik, bár nem vesz részt az ütközésben. A keresés folytatásakor a kapcsolat újra létrejön. Ez tipikus az időrendi visszalépés esetén és elkerülhető, ha függőségvezérelt visszalépést használunk.</p></div><div class="section" title="Részben rendezett tervkészítés kötetlen változókkal"><div class="titlepage"><div><div><h2 class="title"><a id="id643908"/>Részben rendezett tervkészítés kötetlen változókkal</h2></div></div></div><p class="3">Ebben a fejezetben a változókat tartalmazó elsőrendű cselekvés reprezentációra alkalmazott részben rendezett tervkészítés során felmerülő komplikációkkal foglalkozunk. Tegyük fel, hogy a kockavilág (lásd 11.4. ábra) problémát kell megoldani a <span class="emphasis"><em>Rajta</em></span>(<span class="emphasis"><em>A</em></span>, <span class="emphasis"><em>B</em></span>) nyitott előfeltétellel és a</p><p><code class="code"><em><span class="remark">Cselekvés</span></em>(<em><span class="remark">Mozgat</span></em>(<em><span class="remark">b</span></em>, <em><span class="remark">x</span></em>, <em><span class="remark">y</span></em>),</code></p><p><code class="code">Előfeltétel: <em><span class="remark">Rajta</span></em>(<em><span class="remark">b</span></em>, <em><span class="remark">x</span></em>) ∧ <em><span class="remark">Üres</span></em>(<em><span class="remark">x</span></em>) ∧ <em><span class="remark">Üres</span></em>(<em><span class="remark">y</span></em>)</code></p><p><code class="code">Következmény: <em><span class="remark">Rajta</span></em>(<em><span class="remark">b</span></em>, <em><span class="remark">y</span></em>) ∧ <em><span class="remark">Üres</span></em>(<em><span class="remark">x</span></em>) ∧ ¬<em><span class="remark">Rajta</span></em>(<em><span class="remark">b</span></em>, <em><span class="remark">x</span></em>) ∧ ¬<em><span class="remark">Üres</span></em>(<em><span class="remark">y</span></em>))</code></p><p>cselekvéssel. Ez a cselekvés teljesíti a <span class="emphasis"><em>Rajta</em></span>(<span class="emphasis"><em>A</em></span>, <span class="emphasis"><em>B</em></span>) literált, mert a <span class="emphasis"><em>Rajta</em></span>(<span class="emphasis"><em>b</em></span>, <span class="emphasis"><em>u</em></span>) következmény egyesíthető a <span class="emphasis"><em>Rajta</em></span>(<span class="emphasis"><em>A</em></span>, <span class="emphasis"><em>B</em></span>)-vel a {<span class="emphasis"><em>b</em></span>/<span class="emphasis"><em>A</em></span>,<span class="emphasis"><em> y</em></span>/<span class="emphasis"><em>B</em></span>} behelyettesítéssel. Alkalmazzuk tehát ezt a behelyettesítést a cselekvésre, aminek az eredménye a</p><p><code class="code"><em><span class="remark">Cselekvés</span></em>(<em><span class="remark">Mozgat</span></em>(<em><span class="remark">A</span></em>, <em><span class="remark">x</span></em>, <em><span class="remark">B</span></em>),</code></p><p><code class="code">Előfeltétel: <em><span class="remark">Rajta</span></em>(<em><span class="remark">A</span></em>, <em><span class="remark">x</span></em>) ∧ <em><span class="remark">Üres</span></em>(<em><span class="remark">x</span></em>) ∧ <em><span class="remark">Üres</span></em>(<em><span class="remark">B</span></em>)</code></p><p><code class="code">Következmény: <em><span class="remark">Rajta</span></em>(<em><span class="remark">A</span></em>, <em><span class="remark">B</span></em>) ∧ <em><span class="remark">Üres</span></em>(<em><span class="remark">x</span></em>) ∧ ¬<em><span class="remark">Rajta</span></em>(<em><span class="remark">b</span></em>, <em><span class="remark">x</span></em>) ∧ ¬<em><span class="remark">Üres</span></em>(<em><span class="remark">B</span></em>))</code></p><p>Ez az <span class="emphasis"><em>x</em></span> változót kötetlenül hagyja. Ez annyit tesz, hogy a cselekvés annyit mond, hogy mozgasd <span class="emphasis"><em>A</em></span>-t <span class="emphasis"><em>valahonnan</em></span>, de azt nem, hogy honnét. Ez egy másik példa a legkisebb megkötés elvre: elhalaszthatjuk a döntéseket egészen addig, amíg a terv egy másik lépése ezt meghozza nekünk. Tegyük fel például, hogy a <span class="emphasis"><em>Rajta</em></span>(<span class="emphasis"><em>A</em></span>, <span class="emphasis"><em>D</em></span>) a kiinduló állapotunk. Az <span class="emphasis"><em>x</em></span>-et <span class="emphasis"><em>D</em></span>-vel behelyettesítve az<span class="emphasis"><em> Indít</em></span> cselekvés használható fel, hogy elérjük a <span class="emphasis"><em>Rajta</em></span>(<span class="emphasis"><em>A</em></span>, <span class="emphasis"><em>x</em></span>)-et. A módszer, hogy több információt kivárunk, mielőtt megválasztjuk <span class="emphasis"><em>x</em></span>-et, gyakran sokkal hatékonyabb, mint az <span class="emphasis"><em>x</em></span> minden értékének kipróbálása és a visszalépés, ha ez sikertelen.</p><p>A változók jelenléte az előfeltételekben és a cselekvésekben nehezíti az ütközések detektálását és feloldását. Például amikor a <span class="emphasis"><em>Mozgat</em></span>(<span class="emphasis"><em>A</em></span>, <span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>B</em></span>) a terv része lesz, a</p><p><span class="inlinemediaobject"><img src="math/mi-11-0009.gif" alt="Részben rendezett tervkészítés kötetlen változókkal"/></span></p><p>okozati kapcsolatra is szükség van. Ha van egy <span class="emphasis"><em>M</em></span><sub>2</sub> cselekvés ¬<span class="emphasis"><em>Rajta</em></span>(<span class="emphasis"><em>A</em></span>, <span class="emphasis"><em>z</em></span>) következménnyel, akkor ez csak akkor okoz ütközést, ha a <span class="emphasis"><em>z </em></span>értéke <span class="emphasis"><em>B</em></span>. Hogy kezeljük ezt a lehetőséget, kiterjesztjük a tervek reprezentációját, hogy tartalmazzanak <span class="emphasis"><em>z</em></span> ≠ <span class="emphasis"><em>X </em></span>alakú <span class="strong"><strong>egyenlőtlenségi kényszer</strong></span>eket (<span class="strong"><strong>inequality constraint</strong></span>s), ahol <span class="emphasis"><em>z</em></span> egy változó és <span class="emphasis"><em>X</em></span> egy változó vagy egy konstansszimbólum. Ebben az esetben az ütközést a <span class="emphasis"><em>z </em></span>≠ <span class="emphasis"><em>B</em></span> hozzáadásával oldhatjuk fel, ami azt jelenti hogy a terv később <span class="emphasis"><em>B</em></span> kivételével bármire behelyettesítheti <span class="emphasis"><em>z</em></span>-t. Bármikor amikor egy behelyettesítést hajtunk végre a tervben, ellenőriznünk kell, hogy az nem ellenkezik-e az egyenlőtlenségi korlátokkal. Például egy <span class="emphasis"><em>x</em></span>/<span class="emphasis"><em>y</em></span> behelyettesítés ütközik az <span class="emphasis"><em>x </em></span>≠ <span class="emphasis"><em>y</em></span> kényszerrel. Az ilyen ellentétek nem oldhatók fel, ezért a tervkészítő visszalépésre kényszerül.</p><p>A 12.6. alfejezetben egy bővebb példát adunk a részben rendezett tervkészítésre, ami a változókat tartalmazó kockavilág probléma.</p></div><div class="section" title="Heurisztikák a részben rendezett tervkészítésre"><div class="titlepage"><div><div><h2 class="title"><a id="id644314"/>Heurisztikák a részben rendezett tervkészítésre</h2></div></div></div><p>A teljesen rendezett tervkészítéssel összehasonlítva a részben rendezett tervkészítés egyértelmű előnye, hogy a probléma részfeladatokra bontható. A hátránya, hogy nem reprezentálja megfelelően az állapotokat, így nehezebb megbecsülni, hogy a részben rendezett terv milyen messze van a céltól. Jelenleg jóval kevesebb az ismeretanyag arról, hogy hogyan adható pontos heurisztika a részben rendezett tervkészítéshez, mint a teljesen rendezett tervkészítések esetén.</p><p>A legkézenfekvőbb heurisztika, hogy megszámoljuk az eltérő nyitott előfeltételeket. Ez javítható azáltal, ha kivonjuk azon nyitott előfeltételek számát, melyek illeszkednek az <span class="emphasis"><em>Indít</em></span> állapot egy literáljaival. Hasonlóan a teljesen rendezett esethez ez túlbecsüli a költséget, ha vannak cselekvések, melyek több célt érnek el, és alulbecsül, ha negatív kölcsönhatások vannak a terv lépései között. A következő alfejezet egy olyan megközelítést mutat be, ami lehetővé teszi, hogy sokkal pontosabb heurisztikákat kapjunk egy relaxált problémából.</p><p>A heurisztikus függvényt arra használjuk, hogy kiválasszuk a tovább finomítandó tervet. Ezzel a választással az algoritmus követő állapotokat generál egyetlen kiválasztott nyitott előfeltételből kiindulva. Mint a változókiválasztás a kényszerkielégítési algoritmusban, ez a választás nagy hatással van a hatékonyságra. A kényszerkielégítési probléma <span class="strong"><strong>legjobban-korlátozott-változó</strong></span> (<span class="strong"><strong>most-constrained-variable</strong></span>) heurisztikája alkalmazható a tervkészítő algoritmusokra, és látszólag jól működik. Az alapötlet, hogy válasszuk azt a nyitott feltételt, mely a <span class="emphasis"><em>lehető legkevesebb</em></span> módon elégíthető ki. Ennek a heurisztikának két speciális esete van. Először, ha egy nyitott feltétel nem érhető el egyetlen cselekvéssel sem, akkor a heurisztika kiválasztja. Ez jó ötlet, hiszen a teljesíthetetlenség korai érzékelése sok munkát megspórolhat. Másodszor, ha egy nyitott feltétel csak egyféleképp teljesíthető, akkor célszerű kiválasztani, hiszen ez egy elkerülhetetlen döntés, ami további megkötéseket eredményezhet a későbbi választásokhoz. Habár minden nyitott feltételhez meglehetősen költséges kiszámolni, hogy azok hányféleképpen teljesíthetők, és ez nem is mindig éri meg, a kísérletek azt mutatják, hogy a két speciális eset kezelése jelentős gyorsulást eredményezhet.</p></div></div></body></html>
