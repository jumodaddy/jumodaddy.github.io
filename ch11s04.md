<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/></head><body><div class="section" title="Tervkészítési gráfok"><div class="titlepage"><div><div><h1 class="title"><a id="id644341"/>Tervkészítési gráfok</h1></div></div></div><p class="2">Az összes javasolt heurisztika a teljesen rendezett és a részben rendezett tervkészítésre pontatlanságokkal terhelt. Ez a fejezet bemutatja, hogy egy speciális adatszerkezet a <span class="strong"><strong>tervkészítési gráf</strong></span> (<span class="strong"><strong>planning graph</strong></span>) felhasználható, hogy jobb heurisztikus becsléseket nyerjünk. Ezek a heurisztikák bármely eddig tárgyalt keresési technikával használhatók. Egy másik lehetőség, hogy a megoldást közvetlenül a tervkészítési gráfból nyerjük ki egy erre kiélezett algoritmussal, mint amilyen például a <code class="code">GRAPHPLAN</code>.</p><p class="Tartalom3">A tervkészítési gráf a terv időrendi lépéseinek megfelelő szintekből áll, ahol a 0-dik szint a kiinduló állapot. Minden szint egy literálhalmazt és egy cselekvéshalmazt tartalmaz. A literálok durván azok, melyek igazak <span class="emphasis"><em>lehetnek</em></span> az adott lépésnél, az addig végrehajtott cselekvések függvényében. Ismét durván fogalmazva, a cselekvések azok, melyeknek az előfeltételei teljesülhetnek az adott időlépésben attól függően, hogy aktuálisan mely literálok teljesülnek. Azért mondjuk, hogy „durván”, mert a tervkészítési gráf csak a cselekvések közötti lehetséges negatív kölcsönhatások egy korlátozott részhalmazát tartalmazza, ezért a tervkészítési gráf optimista lehet a literál teljesítéséhez szükséges minimális lépések számával kapcsolatban. Mindazonáltal a tervkészítési gráfban ez a lépésszám egy jó becslés arra, hogy milyen nehéz egy literált teljesíteni a kiindulási állapotból. Még fontosabb, hogy a tervkészítési gráfot úgy definiáltuk, hogy könnyen elkészíthető legyen.</p><p>A tervkészítési gráf csak ítéletlogikai tervkészítési problémákra alkalmazható – olyanokra, melyek nem tartalmaznak változókat. Ahogy a 11.1. alfejezetben említettük, mind a <code class="code">STRIPS</code>, mind az ADL reprezentáció ítéletlogikára alakítható. A nagyszámú entitást tartalmazó problémákat ez jelentősen felduzzaszthatja a cselekvéssémák számában. Ennek ellenére a tervkészítési gráfok hatékony eszköznek bizonyultak a nehéz tervkészítési problémák megoldásában.</p><p>A tervkészítési gráfokat egy egyszerű példán mutatjuk be. (Az összetettebb feladatok olyan gráfhoz vezetnek, amelyek nem férnének ki egy oldalra.) A 11.11. ábra a feladatot, míg a 11.12. ábra az ehhez tartozó gráfot mutatja. Az <span class="emphasis"><em>S</em></span><sub>0</sub> állapotszintről indulunk, ami a probléma kiinduló állapotának felel meg. Ezt az <span class="emphasis"><em>A</em></span><sub>0</sub> cselekvésszinttel folytatjuk, amibe azokat a cselekvéseket helyezzük, melyek előfeltételei az előző szinten teljesülnek. Minden cselekvés össze van kötve az <span class="emphasis"><em>S</em></span><sub>0</sub>-ban található előfeltételeivel, illetve az <span class="emphasis"><em>S</em></span><sub>1</sub>-ben található következményeivel, ami ebben az esetben az <span class="emphasis"><em>S</em></span><sub>0</sub>-ban nem szereplő literálok bevezetését jelenti <span class="emphasis"><em>S</em></span><sub>1</sub>-ben.</p><div class="figure"><a id="id644413"/><p class="title"><strong>11.11. ábra - A „legyen süti és együnk is” probléma</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/11-11.png" alt="A „legyen süti és együnk is” probléma"/></div></div></div><p class="Képalá">A tervkészítési gráfnak a nem cselekvést ugyanúgy kell reprezentálni, mint a cselekvéseket. Ez annyit tesz, hogy a szituációkalkulus keretaxiómáinak megfelelő működésre van szükség, ami alapján egy literál két állapon keresztül igaz maradhat, ha nincs ezt módosító cselekvés. Egy tervkészítési gráfban ezt <span class="strong"><strong>megőrző cselekvés</strong></span>ekkel (<span class="strong"><strong>persistence action</strong></span>s) oldjuk meg. Minden pozitív és negatív <span class="emphasis"><em>C</em></span> literálhoz egy megőrző cselekvést szúrunk be <span class="emphasis"><em>C</em></span> előfeltétellel és <span class="emphasis"><em>C</em></span> következménnyel. A 11.12. ábra az <span class="emphasis"><em>A</em></span><sub>0</sub> szinten egyetlen „valós” cselekvést az <span class="emphasis"><em>Eszik</em></span>(<span class="emphasis"><em>Süti</em></span>)-t tartalmazza, két megőrző cselekvéssel, amit kicsi négyzetek jelölnek.</p><p class="Képalá">Az <span class="emphasis"><em>A</em></span><sub>0</sub> tartalmazza az összes cselekvést, ami az <span class="emphasis"><em>S</em></span><sub>0</sub> állapotban előfordulhat, de ugyanilyen fontos, hogy rögzíti a cselekvések közötti ütközéseket is, amelyek megakadályozzák, hogy egyszerre történjenek. A 11.12. ábra szürke vonalai ezeket a <span class="strong"><strong>kölcsönös kizárás</strong></span>i (<span class="strong"><strong>mutual exclusion</strong></span>s vagy <span class="strong"><strong>mutex</strong></span>) kapcsolatokat jelölik. Például az <span class="emphasis"><em>Eszik</em></span>(<span class="emphasis"><em>Süti</em></span>) kölcsönös kizárásban van a <span class="emphasis"><em>Van</em></span>(<span class="emphasis"><em>Süti</em></span>) vagy a ¬<span class="emphasis"><em>Megevett</em></span>(<span class="emphasis"><em>Süti</em></span>)<span class="emphasis"><em> </em></span>megőrzésével. Hamarosan látjuk, hogy a mutex kapcsolatokat hogyan számíthatjuk.</p><div class="figure"><a id="id644515"/><p class="title"><strong>11.12. ábra - A „legyen süti és együnk is” probléma tervkészítési gráfja az <span class="emphasis"><em>S</em></span><sub>2</sub> szintig. A téglalapok az akciókat jelentik (a kicsi négyzetek a megőrző cselekvések), az egyenesek az előfeltételeket és a következményeket jelölik. A kölcsönös kizárásokat ívelt szürke vonalak jelölik.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/11-12.png" alt="A „legyen süti és együnk is” probléma tervkészítési gráfja az S2 szintig. A téglalapok az akciókat jelentik (a kicsi négyzetek a megőrző cselekvések), az egyenesek az előfeltételeket és a következményeket jelölik. A kölcsönös kizárásokat ívelt szürke vonalak jelölik."/></div></div></div><p class="Tartalom3">Az <span class="emphasis"><em>S</em></span><sub>1</sub> az összes olyan literált tartalmazza, ami az <span class="emphasis"><em>A</em></span><sub>0</sub> szint akcióinak bármely részhalmazát választva elérhető. Szintén tartalmaz mutex kapcsolatokat (szürke vonalakat) jelölve az olyan literálokat, melyek nem teljesülhetnek egyszerre, a választott cselekvésektől függetlenül. Például a <span class="emphasis"><em>Van</em></span>(<span class="emphasis"><em>Süti</em></span>)<span class="emphasis"><em> </em></span>és a<span class="emphasis"><em> Megevett</em></span>(<span class="emphasis"><em>Süti</em></span>) kölcsönösen kizárják egymást. Az <span class="emphasis"><em>A</em></span><sub>0</sub> kiválasztott cselekvéseitől függően az eredmény vagy az egyik vagy a másik lehet, de a kettő egyszerre nem. Más szavakkal az <span class="emphasis"><em>S</em></span><sub>1</sub>, csakúgy, mint a regressziós állapottér-keresés, több állapotot reprezentál, a kizárási kapcsolatok pedig kényszerek, melyek a lehetséges állapotok halmazát definiálják.</p><p class="Tartalom3">És ez így megy tovább. Az <span class="emphasis"><em>S<sub>i </sub></em></span>állapot- és az <span class="emphasis"><em>A<sub>i</sub></em></span> cselekvésszintek között mozgunk, egészen addig, míg elérünk egy szintet, ahol két egymást követő szint azonos. Ekkor azt mondjuk, hogy a gráf <span class="strong"><strong>kiegyenlítődött</strong></span> (<span class="strong"><strong>leveled off</strong></span>). Minden egymást követő szint azonos, így további kiterjesztésre nincsen szükség.</p><p class="Tartalom3">Egy olyan struktúrát kaptunk, ahol az <span class="emphasis"><em>A<sub>i</sub></em></span> szint tartalmaz minden <span class="emphasis"><em>S<sub>i</sub></em></span>-ben alkalmazható cselekvést, a kényszerekkel együtt, melyek megmondják, hogy melyik cselekvéspár nem hajtható végre egyidejűleg. Minden <span class="emphasis"><em>S<sub>i</sub></em></span> szint tartalmazza az összes literált, ami az <span class="emphasis"><em>A</em></span><sub><span class="emphasis"><em>i</em></span>–1</sub> összes lehetséges cselekvéshalmazának hatására teljesül, a kényszerekkel együtt, amelyek a nem lehetséges literálpárokat jelölik ki. Fontos megjegyezni, hogy a tervkészítési gráf elkészítési folyamatához <span class="emphasis"><em>nem</em></span> kell választanunk a cselekvések között, ami kombinatorikus keresést eredményezne. Ezzel szemben, a tervkészítési gráf konstrukciója csak a lehetetlen választásokat rögzíti, mutex kapcsolatok felhasználásával. Egy ilyen tervkészítési gráf elkészítésének bonyolultsága egy alacsonyrendű polinomiális komplexitás a cselekvések számát tekintve, ahol az állapottér exponenciális a literálok számában.</p><p class="Tartalom3">Most mutex kapcsolatokat definiálunk, mind a cselekvések, mind a literálok számára. Egy adott szinten, a mutex kapcsolat akkor érvényes két <span class="emphasis"><em>cselekvés</em></span> között, ha a következő három feltétel valamelyike fennáll:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="Tartalom3"><span class="emphasis"><em>Inkonzisztens hatások:</em></span> egy cselekvés negálja egy másik következményét. Például az <span class="emphasis"><em>Eszik</em></span>(<span class="emphasis"><em>Süti</em></span>) és a <span class="emphasis"><em>Van</em></span>(<span class="emphasis"><em>Süti</em></span>) megőrzése inkonzisztens hatású, mert a <span class="emphasis"><em>Van</em></span>(<span class="emphasis"><em>Süti</em></span>)<span class="emphasis"><em> </em></span>következmény tekintetében ellentétesek.</p></li><li class="listitem"><p><span class="emphasis"><em>Interferencia:</em></span> egy cselekvés egyik következménye a negálása egy másik cselekvés előfeltételének. Például az <span class="emphasis"><em>Eszik</em></span>(<span class="emphasis"><em>Süti</em></span>) interferál a <span class="emphasis"><em>Van</em></span>(<span class="emphasis"><em>Süti</em></span>)<span class="emphasis"><em> </em></span>megőrzésével, mert negálja az előfeltételét.</p></li><li class="listitem"><p><span class="emphasis"><em>Versenyhelyzet:</em></span> egy cselekvés előfeltétele kölcsönösen kizáró egy másik előfeltételével. Például a <span class="emphasis"><em>Süt</em></span>(<span class="emphasis"><em>Süti</em></span>) és az <span class="emphasis"><em>Eszik</em></span>(<span class="emphasis"><em>Süti</em></span>) mutexek, mert versenyeznek a <span class="emphasis"><em>Van</em></span>(<span class="emphasis"><em>Süti</em></span>) előfeltétel tekintetében.</p></li></ul></div><p>Két azonos szineten lévő <span class="emphasis"><em>literál</em></span> között mutex kapcsolat áll fenn, ha az egyik a másik negáltja, vagy bármely lehetséges cselekvéspár, amely a két literált elérheti, egymást kölcsönösen kizáró. Ezt az állapotot <span class="emphasis"><em>inkonzisztens háttérnek</em></span> nevezzük. Például a <span class="emphasis"><em>Van</em></span>(<span class="emphasis"><em>Süti</em></span>) és a <span class="emphasis"><em>Megevett</em></span>(<span class="emphasis"><em>Süti</em></span>) kizárják egymást <span class="emphasis"><em>S</em></span><sub>1</sub>-ben, mert az egyetlen mód a <span class="emphasis"><em>Van</em></span>(<span class="emphasis"><em>Süti</em></span>) teljesítésére egy megőrző cselekvés, ami mutex a <span class="emphasis"><em>Megevett</em></span>(<span class="emphasis"><em>Süti</em></span>)<span class="emphasis"><em> </em></span>egyetlen elérési lehetőségével, nevezetesen az <span class="emphasis"><em>Eszik</em></span>(<span class="emphasis"><em>Süti</em></span>) cselekvéssel. Az <span class="emphasis"><em>S</em></span><sub>2 </sub>szinten a két literál már nem mutex, mert új elérési lehetőségek vannak hozzájuk, mint a <span class="emphasis"><em>Süt</em></span>(<span class="emphasis"><em>Süti</em></span>) és a <span class="emphasis"><em>Megevett</em></span>(<span class="emphasis"><em>Süti</em></span>) megőrző cselekvése, melyek nem zárják ki egymást.</p><div class="section" title="Tervkészítési gráfok heurisztikus becslésekre"><div class="titlepage"><div><div><h2 class="title"><a id="id644809"/>Tervkészítési gráfok heurisztikus becslésekre</h2></div></div></div><div class="important" title="Fontos" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Fontos</h3><p class="3">A tervkészítési gráf, ha egyszer már létrehoztuk, nagyon gazdag információforrás a problémáról. Például <span class="emphasis"><em>egy literál</em></span>,<span class="emphasis"><em> ami nem található meg az utolsó szinten</em></span>,<span class="emphasis"><em> egyetlen tervvel sem érhető el</em></span>. Ez a megfigyelés a visszafelé keresésben használható a következőképp: bármely elérhetetlen literált tartalmazó állapot költsége <span class="emphasis"><em>h</em></span>(<span class="emphasis"><em>n</em></span>) = ∞. Hasonlóan a részben rendezett tervkészítésnél bármely tervnek a költsége egy elérhetetlen nyitott előfeltétellel, <span class="emphasis"><em>h</em></span>(<span class="emphasis"><em>n</em></span>) = ∞.</p></div><p class="Tartalom3">Ez az ötlet tovább általánosítható. Minden cél literál elérési költségét becsülhetjük azzal a szinttel, ahol először megjelenik a tervkészítési gráfban. Ezt a cél <span class="strong"><strong>szint költségé</strong></span>nek (<span class="strong"><strong>level cost</strong></span>) nevezzük. A 11.12. ábrán a <span class="emphasis"><em>Van</em></span>(<span class="emphasis"><em>Süti</em></span>) szint költsége 0, a <span class="emphasis"><em>Megevett</em></span>(<span class="emphasis"><em>Süti</em></span>) szint költsége 1. Könnyű megmutatni (lásd 11.9. feladat), hogy ezek a közelítések elfogadhatók az egyedülálló célokra. A becslés azonban lehet, hogy nem túl jó, mert a tervkészítési gráfok több cselekvést megengednek szintenként, míg a heurisztika csak a szintek számát tartalmazza, és nem a cselekvések számát. Ebből kifolyólag a heurisztikák számításában, gyakori a <span class="strong"><strong>soros tervkészítési gráf</strong></span> (<span class="strong"><strong>serial planning graph</strong></span>) használata. A soros gráf szerint egy adott időpillanatban csak egyetlen cselekvés hajtható végre, ami mutexekkel érhető el úgy, hogy a megőrző cselekvések kivételével, minden cselekvés közé mutex kapcsolatot teszünk. A soros tervkészítő gráfból kinyert szintköltségek gyakran egész elfogadható közelítését adják a valós költségeknek.</p><p>Három egyszerű megközelítés létezik, hogy célliterálok konjunkcióihoz költséget becsüljünk. A <span class="strong"><strong>maximális szint</strong></span> (<span class="strong"><strong>max-level</strong></span>) heurisztika egyszerűen a célok közüli maximális szintköltségét veszi, ami elfogadható, de nem feltétlen nagyon pontos. A <span class="strong"><strong>szintösszeg</strong></span> (<span class="strong"><strong>level sum</strong></span>) heurisztika a részcél függetlenségi feltételezésből a célok szintköltségeinek összegét adja. Ez nem elfogadható, de nagyon jól működik olyan gyakorlati problémákra, amelyek nagymértékben részekre bonthatók. Ez sokkal pontosabb, mint a 11.2. alfejezetben bemutatott nem-kielégített-célok-heurisztika. A mi feladatunkban a <span class="emphasis"><em>Van</em></span>(<span class="emphasis"><em>Süti</em></span>) ∧ <span class="emphasis"><em>Megevett</em></span>(<span class="emphasis"><em>Süti</em></span>) konjunktív célhoz rendelhető heurisztikus becslés 0 + 1 = 1, míg a helyes válasz 2. Mindezeken túl, ha eltávolítjuk a <span class="emphasis"><em>Süt</em></span>(<span class="emphasis"><em>Süti</em></span>)<span class="emphasis"><em> </em></span>cselekvést, a becslés még mindig 1, de a konjunktív cél ekkor már elérhetetlen. Végezetül, a <span class="strong"><strong>halmazszint</strong></span> (<span class="strong"><strong>set-level</strong></span>) heurisztika azt a szintet keresi meg, ahol a konjunktív cél összes literálja megjelenik a tervkészítési gráfban, és nincsenek közöttük kölcsönösen kizáró párok. A heurisztika a korrekt 2 értéket adja az eredeti feladatra és végtelent a <span class="emphasis"><em>Süt</em></span>(<span class="emphasis"><em>Süti</em></span>) nélküli feladatra. Ez előnyben van a maximális szint heurisztikával szemben, és kimagaslóan jól működik azon feladatokban, ahol sok kölcsönhatás van a résztervek között.</p><p>Lévén egy pontos heurisztika készítésére szolgáló eszköz, a tervkészítési gráf tekinthető úgy, mint egy relaxált probléma, ami hatékonyan megoldható. Hogy a relaxált probléma természetét megértsük, pontosan meg kell értenünk, hogy mit jelent, ha egy <span class="emphasis"><em>g</em></span> literál megjelenik a tervkészítési gráf <span class="emphasis"><em>S<sub>i</sub></em></span> szintjén. Ideális esetben garanciát szeretnénk arra, hogy létezik egy terv <span class="emphasis"><em>i</em></span> cselekvés szinttel, ami eléri <span class="emphasis"><em>g</em></span>-t, illetve ha <span class="emphasis"><em>g</em></span> nem jelenik meg, akkor nincs is ilyen terv. Sajnos ezt garantálni majdnem ugyanolyan nehéz, mint megoldani az eredeti tervkészítési problémát. A tervkészítési gráf a garancia második részéről gondoskodik (ha <span class="emphasis"><em>g</em></span> nem jelenik meg, akkor nincs terv), de ha <span class="emphasis"><em>g</em></span> megjelenik, akkor a tervkészítési gráf csak annyit ígér, hogy van egy terv, ami <span class="emphasis"><em>várhatóan</em></span> eléri <span class="emphasis"><em>g</em></span>-t, nincsenek „nyilvánvaló” hibák. Egy nyilvánvaló hiba definíció szerint egy olyan hiba, ami úgy detektálható, hogy két cselekvést vagy két literált tekintünk egyszerre, vagy más szavakkal a mutex relációkat vizsgáljuk. Lehetnek összetettebb hibák, melyek három, négy vagy több cselekvést tartalmaznak, de a tapasztalatok azt mutatják, hogy nem éri meg ezekkel foglalkozni. Ez hasonló a kényszerkielégítési problémáknál tanultakkal, hogy a megoldás megkeresése előtt gyakran megéri a 2-konzisztencia számítás, de a 3- vagy a magasabb konzisztencia kiszámítása ritkábban kifizetődő (lásd 5.2. alfejezet).</p></div><div class="section" title="A Graphplan algoritmus"><div class="titlepage"><div><div><h2 class="title"><a id="id647105"/>A Graphplan algoritmus</h2></div></div></div><p class="3">Ez a fejezet bemutatja, hogy hogyan nyerhető ki közvetlenül a terv a tervkészítési gráfból, ahelyett hogy azt csak a heurisztikákhoz használjuk. A <code class="code">GRAPHPLAN</code> algoritmusnak (11.13. ábra) két fő lépése van, melyek ciklikusan váltakoznak. Először ellenőrzi, hogy minden célliterál jelen van-e az adott szinten anélkül, hogy mutex kapcsolatok lennének közöttük. Ebben az esetben, az aktuális gráfban<span class="emphasis"><em> létezhet</em></span> megoldás, így az algoritmus megpróbálja azt kinyerni. Ellenkező esetben bővíti a gráfot úgy, hogy az aktuális szinthez a cselekvéseket, a következőhöz az állapotliterálokat adja: ez a folyamat folytatódik addig, amíg megtaláljuk a megoldást, vagy bebizonyosodik, hogy nem létezik megoldás.</p><div class="figure"><a id="id647120"/><p class="title"><strong>11.13. ábra - A <code class="code">GRAPHPLAN</code> algoritmus. A <code class="code">GRAPHPLAN</code> algoritmus egy megoldás kinyerő és egy gráf-bővítő lépés között alternál. A <code class="code">MEGOLDÁS-KINYERÉS</code> a befejezéstől visszafelé keresve ellenőrzi, hogy található-e megoldás. A <code class="code">GRÁF-BŐVÍTÉS</code> adja a cselekvéseket az adott szinthez és az állapotliterálokat a következőhöz.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/11-13.png" alt="A GRAPHPLAN algoritmus. A GRAPHPLAN algoritmus egy megoldás kinyerő és egy gráf-bővítő lépés között alternál. A MEGOLDÁS-KINYERÉS a befejezéstől visszafelé keresve ellenőrzi, hogy található-e megoldás. A GRÁF-BŐVÍTÉS adja a cselekvéseket az adott szinthez és az állapotliterálokat a következőhöz."/></div></div></div><p class="Képalá">Kövessük végig a <code class="code">GRAPHPLAN</code> működését a 11.1. alfejezet kerékcsere problémáján! A teljes gráf a 11.14. ábrán látható. A <code class="code">GRAPHPLAN</code> első lépésben inicializálja a tervkészítési gráfot egy egyszintű (<span class="emphasis"><em>S</em></span><sub>0</sub> szint) gráfra, ami a kiindulási állapot öt literálját tartalmazza. Az<span class="emphasis"><em> Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>)<span class="emphasis"><em> </em></span>célliterál nincs jelen az <span class="emphasis"><em>S</em></span><sub>0</sub>-ban, ezért nem kell meghívnunk a <code class="code">MEGOLDÁS-KINYERÉST</code>, hiszen biztosak vagyunk benne, hogy még nincs megoldás. Ehelyett a <code class="code">GRÁF-BŐVÍTÉS</code> hozzáad három cselekvést, melyeknek az előfeltétele már teljesül az <span class="emphasis"><em>S</em></span><sub>0</sub> szinten (például az összes cselekvés, kivéve a <span class="emphasis"><em>Felszerel</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) – cselekvést). Hozzáadja továbbá a megőrző-cselekvéseket <span class="emphasis"><em>S</em></span><sub>0</sub> összes literáljához. A cselekvések következményeit az <span class="emphasis"><em>S</em></span><sub>1</sub><span class="emphasis"><em> </em></span>szinthez adjuk hozzá. A <code class="code">GRÁF-BŐVÍTÉS</code> ezek után mutex kapcsolatokat keres, és hozzáadja ezeket a gráfhoz.</p><div class="figure"><a id="id647224"/><p class="title"><strong>11.14. ábra - A kerékcsere probléma tervkészítési gráfja az S<sub>2</sub> szintre bővítés után. A mutex kapcsolatokat szürke vonalak jelölik. Csak néhány fontos mutexet mutatunk, mert az ábra olvashatatlanná válna, ha az összeset jelölnénk. A megoldást megvastagított vonalak és kiemelések jelölik.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/11-14.png" alt="A kerékcsere probléma tervkészítési gráfja az S2 szintre bővítés után. A mutex kapcsolatokat szürke vonalak jelölik. Csak néhány fontos mutexet mutatunk, mert az ábra olvashatatlanná válna, ha az összeset jelölnénk. A megoldást megvastagított vonalak és kiemelések jelölik."/></div></div></div><p class="Képalá">Az <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>)<span class="emphasis"><em> </em></span>cselekvés még mindig nincs jelen az <span class="emphasis"><em>S</em></span><sub>1</sub> állapotban, ezért most sem hívjuk meg a <code class="code">MEGOLDÁS-KINYERÉS</code> lépést. A <code class="code">GRÁF-BŐVÍTÉS</code> hívással a 11.14. ábrán látható tervkészítési gráfot kapjuk. Most, hogy a cselekvések teljes skálája rendelkezésre áll, ideje néhány példát nézni a mutex kapcsolatokra és a hatásaikra:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="Tartalom3"><span class="emphasis"><em>Nem konzisztens hatások:</em></span> az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>,<span class="emphasis"><em> Csomagtartó</em></span>)<span class="emphasis"><em> </em></span>mutex kapcsolatban van az <span class="emphasis"><em>OtthagyÉjszakára</em></span> cselekvéssel, mert az egyik következménye az <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>,<span class="emphasis"><em> Föld</em></span>), míg a másiké ennek negáltja.</p></li><li class="listitem"><p><span class="emphasis"><em>Interferencia:</em></span> az<span class="emphasis"><em> Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) mutex az <span class="emphasis"><em>OtthagyÉjszakára</em></span> cselekvéssel, mert az egyiknek előfeltétele az <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Laposkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>), míg a másiknak ennek negáltja a következménye.</p></li><li class="listitem"><p><span class="emphasis"><em>Versenyhelyzet:</em></span> a <span class="emphasis"><em>Felszerel</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) mutex az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Laposkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) cselekvéssel, mert az egyiknek előfeltétele az <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Laposkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>), míg a másiké ennek negáltja.</p></li><li class="listitem"><p><span class="emphasis"><em>Inkonzisztens tartó:</em></span> az <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) és az <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Laposkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) kölcsönösen kizáróak az <span class="emphasis"><em>S</em></span><sub>2</sub>-ben, mert az <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) csak a <span class="emphasis"><em>Felszerel</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) cselekvéssel érhető el, ami mutex a megőrző cselekvéssel, mely az <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Laposkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) egyetlen elérése. A mutex kapcsolatok így azonnal érzékelik a konfliktust, ami abból adódik, hogy két objektumot ugyanazon időpontban azonos helyre próbálunk tenni.</p></li></ul></div><p>Ez alkalommal visszamegyünk a ciklus kezdetére. A cél minden literálja jelen van <span class="emphasis"><em>S</em></span><sub>2</sub>-ben, és egyik sem áll kölcsönös kizárásban egyetlen másikkal sem. Ez azt jelenti, hogy egy megoldás létezhet, és a <code class="code">MEGOLDÁS-KINYERÉS</code>megtalálhatja. Lényegében a <code class="code">MEGOLDÁS-KINYERÉS</code> egy kétértékű kényszerkielégítési problémát old meg, melynek változói a szintek cselekvései, és az értékeik pedig azt jelzik, hogy <span class="emphasis"><em>benne vannak-e</em></span> vagy <span class="emphasis"><em>nincsenek benne</em></span> a tervben. Ehhez egy egyszerű kényszerkielégítési algoritmust használhatunk, vagy definiálhatjuk a <code class="code">MEGOLDÁS-KINYERÉS</code>-t mint egy keresési problémát. Itt a keresés minden állapota a kielégítetlen célok egy halmazát tartalmazza, valamint egy mutatót a tervkészítési gráf egy szintjére. Ezt a keresési problémát a következőképpen definiáljuk:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>A kiindulási állapot a tervkészítési gráf utolsó szintje (<span class="emphasis"><em>S<sub>n</sub></em></span>) a tervkészítési probléma céljaival egyetemben.</p></li><li class="listitem"><p>Az <span class="emphasis"><em>S</em></span><sub><span class="emphasis"><em>i</em></span> </sub>szint állapotában rendelkezésre álló cselekvések összessége, az <span class="emphasis"><em>A</em></span><sub><span class="emphasis"><em>i</em></span>–1</sub> cselekvéseinek azon konfliktusmentes részhalmaza, melyek következményei elérik az állapotban lévő célokat. Az eredményként előálló állapot szintje <span class="emphasis"><em>S</em></span><sub><span class="emphasis"><em>i</em></span>–1</sub>, céljai pedig a kiválasztott cselekvések előfeltételei. A „konfliktusmentességen” olyan cselekvések halmazát értjük, amelyek között nincs kettő, amelyek kölcsönösen kizárnák egymást, és az előfeltételeik között sem szerepelnek kölcsönösen kizáró párok. </p></li><li class="listitem"><p>A cél, hogy elérjünk az <span class="emphasis"><em>S</em></span><sub>0</sub> szinten egy állapotot úgy, hogy minden cél teljesüljön. </p></li><li class="listitem"><p>Minden cselekvés költsége 1.</p></li></ul></div><p>Ehhez a problémához az <span class="emphasis"><em>S</em></span><sub>2<span class="emphasis"><em> </em></span></sub>szintről indulunk, az<span class="emphasis"><em> Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) céllal. Az egyetlen választásunk, hogy elérjük ezt a célt, a<span class="emphasis"><em> Felszerel</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) cselekvés. Ez az <span class="emphasis"><em>S</em></span><sub>1</sub> keresési állapothoz visz minket, melynek céljai az<span class="emphasis"><em> Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Föld</em></span>) és az ¬<span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Laposkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>). Az előbbit az<span class="emphasis"><em> Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>) cselekvéssel érhetjük el, míg a későbbit az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Laposkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) vagy az <span class="emphasis"><em>OtthagyÉjszakára</em></span> cselekvések egyikével. Az <span class="emphasis"><em>OtthagyÉjszakára </em></span>kölcsönösen kizáró kapcsolatban van a <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>)-val, ezért az egyetlen megoldás, hogy az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>)<span class="emphasis"><em> </em></span>és az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Laposkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>)<span class="emphasis"><em> </em></span>cselekvéseket választjuk. Ez az <span class="emphasis"><em>S</em></span><sub>0</sub> keresési állapotra vezet, az <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>)<span class="emphasis"><em> </em></span>és az <span class="emphasis"><em>Ott</em></span>(<span class="emphasis"><em>Laposkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>)<span class="emphasis"><em> </em></span>célokkal. Mindkettő jelen van az állapotban, így megvan a megoldásunk: az<span class="emphasis"><em> Eltávolít</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Csomagtartó</em></span>) cselekvés és az <span class="emphasis"><em>Eltávolít</em></span>(<span class="emphasis"><em>Laposkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>)<span class="emphasis"><em> </em></span>az <span class="emphasis"><em>A</em></span><sub>0</sub> szinten, melyet az <span class="emphasis"><em>A</em></span><sub>1</sub>-ben a <span class="emphasis"><em>Felszerel</em></span>(<span class="emphasis"><em>Pótkerék</em></span>, <span class="emphasis"><em>Tengely</em></span>) követ.</p><p>Tudjuk, hogy a tervkészítés polinomiális helyigényű, és hogy a tervkészítési gráf elkészítése polinomiális idejű, ezért tudjuk, hogy a megoldás kinyerése legrosszabb esetben kezelhetetlen. Ebből kifolyólag valamifajta heurisztika segítségére lesz szükségünk, hogy a cselekvések közül válasszunk a visszafelé keresés során. A gyakorlatban jól működik egy mohó algoritmus, mely a literálok között a szintköltség alapján választ. Bármely célhalmazra a következő sorrendben járunk el:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Elsőként a legmagasabb szintköltségű literált választjuk.</p></li><li class="listitem"><p>Hogy teljesítsük ezt a literált, válasszuk először a legegyszerűbb előfeltételekkel rendelkező cselekvést, azaz válasszuk azt az akciót, melynek előfeltételeire a szintköltségek összege (vagy maximuma) a legkisebb!</p></li></ol></div></div><div class="section" title="A Graphplan algoritmus leállása"><div class="titlepage"><div><div><h2 class="title"><a id="id647755"/>A Graphplan algoritmus leállása</h2></div></div></div><p>Eddig átsiklottunk a leállás kérdése fölött. Lehetünk-e biztosak abban, hogy amennyiben egy problémának nincs megoldása, a <code class="code">GRAPHPLAN</code> algoritmus nem kerül végtelen ciklusba, iterációnként bővítve a tervkészítési gráfot? A válasz igen, de ennek bizonyítása túlmutat ennek a könyvnek a keretein. Itt csak a fő ötleteket körvonalazzuk, különösen azokat, melyek a tervkészítési gráfok általános tulajdonságaira világítanak rá.</p><p class="Tartalom3">Az első lépés, hogy észrevegyük, hogy a tervkészítési gráfok bizonyos tulajdonságai monoton növekvők vagy csökkenők. „X monoton növekvő” azt jelenti, hogy az X-ek halmaza az <span class="emphasis"><em>i</em></span>-edik szinten az i + 1-edik szint halmazának (nem feltétlenül valódi) részhalmaza. A tulajdonságok a következők: </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><span class="emphasis"><em>Monoton növekvő literálok.</em></span> Ha egy literál megjelenik egy adott szinten, akkor az ezt követő összes szinten megjelenik. Ez a megőrző cselekvések miatt van, azaz, ha egy literál megjelenik, a megőrző cselekvések hatására örökké megmarad.</p></li><li class="listitem"><p><span class="emphasis"><em>Monoton növekvő cselekvések.</em></span> Ha egy cselekvés megjelenik egy adott szinten, akkor az ezt követő összes szinten megjelenik. Ez a literálok növekedésének a következménye, azaz, ha egy cselekvés előfeltételei megjelennek egy szinten, akkor az összes ezt követő szinten rendelkezésre állnak, így a cselekvés is.</p></li><li class="listitem"><p><span class="emphasis"><em>A kölcsönös kizárások monoton csökkenése.</em></span> Ha két cselekvés kölcsönösen kizárja egymást az <span class="emphasis"><em>A<sub>i</sub></em></span> szinten, akkor az összes ezt <span class="emphasis"><em>megelőző </em></span>szinten, ahol mindketten megjelennek, szintén kölcsönösen kizárják egymást. Ugyanez igaz a literálok közötti kölcsönös kizárásokra. Ez az ábrákon nem mindig látható, mert ezek a következő egyszerűsítést használják: nem ábrázolják sem azokat a literálokat, melyek egy adott <span class="emphasis"><em>S<sub>i</sub> </em></span>szinten nem teljesülnek, sem azokat a cselekvéseket, amelyek egy adott <span class="emphasis"><em>A<sub>i</sub></em></span> szinten nem végrehajthatók. Láthatjuk, hogy a kölcsönös kizárások monoton csökkenése igaz, ha figyelembe vesszük, hogy a nem látható literálok és cselekvések minden mással kölcsönösen kizárják egymást. </p></li></ul></div><p>	A bizonyítás egy kicsit összetett, de a következő esetekkel kezelhető: ha az <span class="emphasis"><em>A</em></span> és <span class="emphasis"><em>B</em></span> cselekvések kölcsönösen kizárják egymást az <span class="emphasis"><em>A<sub>i</sub></em></span> szinten, akkor ezt csak a háromféle kizárás egyike okozhatja. Az első kettő – az inkonzisztens hatások, illetve a következtetések – a cselekvések tulajdonságai, így, ha a cselekvések kölcsönösen kizárják egymást az <span class="emphasis"><em>A<sub>i</sub></em></span> szinten, akkor minden szinten kizárók lesznek. A harmadik eset a versenyhelyzet, az <span class="emphasis"><em>S<sub>i</sub> </em></span>szint feltételeitől függ: ennek a szintnek tartalmaznia kell az <span class="emphasis"><em>A</em></span><sub>1 </sub>olyan előfeltételét, amely kölcsönösen kizáró a <span class="emphasis"><em>B</em></span><sub>1</sub> előfeltétellel. Ez a két előfeltétel akkor lehet kölcsönösen kizáró, ha egymás negáltjai (amely esetben minden szinten kölcsönösen kizárók), vagy ha minden cselekvés, amely teljesíti az egyiket, kölcsönösen kizáró az összes cselekvéssel, mely a másikat érheti el. Mi már tudjuk, hogy a rendelkezésre álló cselekvések monoton növekednek, így indukcióval bizonyítható, hogy a kölcsönös kizárások csökkenők. </p><p>Mivel a cselekvések és a literálok növekednek, a kölcsönös kizárások csökkennek, és mivel csak véges számú cselekvés és literál van, minden tervkészítési gráf szükségszerűen kiegyenlítődik – azaz minden egymást követő szint azonos lesz. Ha hiányzik a probléma egy célja, vagy a célok között vannak kölcsönösen kizárók, miután a gráf kiegyenlítődött, akkor a probléma soha nem oldható meg, így leállíthatjuk a <code class="code">GRAPHPLAN</code> algoritmust, és hibával térhetünk vissza. Ha a gráf kiegyenlítődik, és minden cél jelen van kizárások nélkül, de a <code class="code">MEGOLDÁS-KINYERÉS</code> sikertelen a megoldás megtalálásában, akkor lehet, hogy véges lépésszámban bővítenünk kell a gráfot, de végezetül megállhatunk. A megállás problémaköre ennél összetettebb, amit itt nem tárgyalunk. </p></div></div></body></html>
