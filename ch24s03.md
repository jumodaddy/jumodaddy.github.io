<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/></head><body><div class="section" title="Előzetes képfeldolgozási műveletek"><div class="titlepage"><div><div><h1 class="title"><a id="id782362"/>Előzetes képfeldolgozási műveletek</h1></div></div></div><p>Láttuk eddig, hogy a fény hogyan tükröződik a jelenet tárgyairól egy mondjuk ötmillió hárombájtos képpontból álló képet formálva. Mint minden érzékelő esetében, most is lesz zaj a képben, és minden esetben nagyon sok adattal kell dolgozni. Elsőként a finomítás műveleteit nézzük meg, amelyekkel a zaj csökkenthető, majd az éldetektálás műveleteit vizsgáljuk. Ezeket „előzetes” vagy „alacsony szintű” műveleteknek hívjuk, mivel ezek az elsők egy műveletsorozatban. Az előzetes látási műveletekre egyrészt a lokalitás jellemző (a kép egy részletére végrehajthatók anélkül, hogy néhány képpontnál messzebb bármit is figyelembe vennénk), másrészt az ismeretek hiánya: anélkül finomíthatjuk a képeket vagy detektálhatunk éleket, hogy bármilyen fogalmunk lenne arról, milyen objektumok vannak a képeken. Ez az alacsony szintű műveleteket esélyessé teszi a párhuzamos hardveren történő megvalósításra, akár élőlényekben, akár mesterséges eszközökben. Ezek után a középső szinten levő műveletek nézzük majd meg, amelyekkel a kép régiókra bontható. A műveletek ezen fázisa még mindig a képen dolgozik, nem a jeleneten, de nem helyi feldolgozást igényel.</p><p>A 15.2. alfejezetben a <span class="strong"><strong>simítás</strong></span> (<span class="strong"><strong>smoothing</strong></span>) azt jelentette, hogy egy állapotváltozó értékét jósoltuk meg valamilyen múltbeli <span class="emphasis"><em>t</em></span> időpontra, bizonyos, a <span class="emphasis"><em>t</em></span> időpontra és további, egészen a jelenig terjedő időpontokra vonatkozó tények ismeretében. Most ugyanezt az ötletet alkalmazzuk a térbeli kiterjedésre az időbeli helyett: a simítás egy képpont értékének jóslását jelenti a környező képpontok alapján. Vegyük észre, hogy világosan megkülönböztetjük a képpontban mért megfigyelt értéket és azt a valódi értéket, amit ott mérnünk kellett volna. Ezek véletlenszerű és szisztematikus mérési hibák (például ha a CCD érzékelője elromlott) miatt különbözhetnek.</p><p>A simítás egyik módszere az, ha minden képponthoz az őt környező szomszédok értékeinek átlagát rendeljük. Ez az extrém értékek kihagyása felé mutató megoldás. De hány szomszédot kell figyelembe vennünk – az egy képpontnyi távolságra vagy a kettő esetleg több pont távolságra lévőket? Erre egy válasz, amely jól működik Gauss-zajok kiszűrésére, a <span class="strong"><strong>Gauss-szűrő</strong></span>t (<span class="strong"><strong>Gaussian filter</strong></span>) használó súlyozott átlag. Emlékezzünk a standard <span class="emphasis"><em>δ</em></span><sub> </sub>szórással rendelkező Gauss-függvényre: </p><p><span class="inlinemediaobject"><img src="math/mi-24-0005.gif" alt="Előzetes képfeldolgozási műveletek"/></span></p><p>Egy Gauss-szűrő alkalmazása azt jelenti, hogy az <span class="emphasis"><em>I</em></span>(<span class="emphasis"><em>x</em></span><sub>0</sub>, <span class="emphasis"><em>y</em></span><sub>0</sub>) intenzitást lecseréljük a minden<span class="emphasis"><em> </em></span>(<span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>)-ra kiszámolt <span class="emphasis"><em>I</em></span>(<span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>)<span class="emphasis"><em>G<sub>σ</sub></em></span>(<span class="emphasis"><em>d</em></span>)<span class="emphasis"><em> </em></span>intenzitások összegével, ahol <span class="emphasis"><em>d</em></span> az (<span class="emphasis"><em>x</em></span><sub>0</sub>, <span class="emphasis"><em>y</em></span><sub>0</sub>) és az (<span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>) pontok távolsága. Az ilyen fajta súlyozott összeg olyan gyakori, hogy van számára egy speciális elnevezés és jelölés. Azt mondjuk, hogy a <span class="emphasis"><em>h</em></span> függvény az <span class="emphasis"><em>f</em></span> és a <span class="emphasis"><em>g</em></span> függvények <span class="strong"><strong>konvolúció</strong></span>ja (<span class="strong"><strong>convolution</strong></span>) (amit <span class="emphasis"><em>h</em></span> = <span class="emphasis"><em>f </em></span>∗ <span class="emphasis"><em>g</em></span> alakban írunk), ha</p><p><span class="inlinemediaobject"><img src="math/mi-24-0006.gif" alt="Előzetes képfeldolgozási műveletek"/></span></p><p>Azaz a simított függvényt úgy kapjuk, hogy a képet a Gauss-függvénnyel konvolváljuk: <span class="emphasis"><em>I</em></span> ∗ <span class="emphasis"><em>G<sub>σ</sub></em></span>. Egy képpontnyi σ kevés zaj kisimításához elegendő, míg 2 képpontnyi több zajt fog elsimítani, de valamilyen mértékű részletvesztés mellett. Mivel a Gauss-hatás a távolsággal eltűnik, a gyakorlatban a ± ∞ a szummákban ± 3<span class="emphasis"><em>σ</em></span>-val helyettesíthető.</p><div class="section" title="Éldetektálás"><div class="titlepage"><div><div><h2 class="title"><a id="id782544"/>Éldetektálás</h2></div></div></div><p>Az előzetes látás következő lépése az <span class="strong"><strong>él</strong></span>ek (<span class="strong"><strong>edge</strong></span>s) detektálása a képsíkon. Az élek olyan egyenes vagy görbe vonalak a képsíkon, amelyekre merőlegesen a kép fényességében „lényegesen” változás van. Az éldetektálás végső célja, hogy eltávolodjunk a bonyolult, több megabájtos képtől egy tömörebb, absztrakt reprezentáció felé, mint amilyen a 24.4. ábrán látható. Az indíték az, hogy a kép élkontúrjai a jelenet fontos kontúrjainak felelnek meg. A képen három mélységi diszkontinuitás példa szerepel 1-gyel címkézve; a 2-vel címkézett felületi orientáció diszkontinuitásból két példa látható, míg a 3-mal címkézett visszaverődési képesség diszkontinuitásokról és a 4-gyel címkézett fényességi diszkontinuitásokról (árnyék) egy-egy. Az éldetektálás csak a képpel foglalkozik, így nem tesz különbséget a jelenet ezen diszkontinuitásfajtái között, de a későbbi feldolgozás igen.</p><p>A 24.5. (a) ábra egy asztalon nyugvó tűzőgépet tartalmazó jelenet képét mutatja, a 24.5. (b) pedig a képre lefuttatott éldetektáló algoritmus eredményét mutatja. Láthatjuk, hogy az éldetektáló kimenete és az ideális vonalas ábra között van különbség. A kis részek élei nem mind illeszkednek egymáshoz, vannak hézagok, ahol nincsenek vonalak, valamint „zajos” kontúrok, amelyek a jeleneten semmilyen lényeges vonásnak nem felelnek meg. A későbbi feldolgozási fázisokban ezeket a hibákat majd korrigálni kell. Hogyan detektáljuk a képen az éleket? Figyeljük meg a kép fényintenzitás-profilját egy egydimenziós keresztmetszet mentén egy élre merőleges irányban, pl. az asztal bal éle és a fal között. Nagyjából olyan lesz ez, mint amit a 24.6. (a) ábra mutat. Az él helye az <span class="emphasis"><em>x = </em></span>50-nek felel meg.</p><div class="figure"><a id="id782566"/><p class="title"><strong>24.4. ábra - Különféle élek: (1) mélységi diszkontinuitás, (2) felületi orientáció diszkontinuitás, (3) viszszaverődési képesség diszkontinuitás, (4) fényességi diszkontinuitás (árnyékok)</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/24-04.png" alt="Különféle élek: (1) mélységi diszkontinuitás, (2) felületi orientáció diszkontinuitás, (3) viszszaverődési képesség diszkontinuitás, (4) fényességi diszkontinuitás (árnyékok)"/></div></div></div><div class="figure"><a id="id782576"/><p class="title"><strong>24.5. ábra - (a) Egy asztalon nyugvó tűzőgép fényképe. (b) Az (a) alapján meghatározott élek.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/24-05.png" alt="(a) Egy asztalon nyugvó tűzőgép fényképe. (b) Az (a) alapján meghatározott élek."/></div></div></div><p>Tekintettel, hogy az élek azoknak a képhelyeknek felelnek meg, ahol a fényességben hirtelen változás tapasztalható, egy naiv ötlet az lehetne, hogy a képet differenciáljuk, és azokat a helyeket keressük meg, ahol az<span class="emphasis"><em> I'</em></span>(<span class="emphasis"><em>x</em></span>) derivált értéke nagy. Nos, az ötlet majdnem működőképes. A 24.6. (b) ábrán láthatjuk, hogy az <span class="emphasis"><em>x = </em></span>50 csúccsal együtt más helyeken, másodlagos csúcsok is megjelentek (például <span class="emphasis"><em>x = </em></span>75), amiket tévesen valódi éleknek fogadhatunk el. A jelenség oka a kép zajossága. Ha a képet először simítjuk, akkor a felesleges csúcsok eltűnnek, ahogy azt a (c) mutatja.</p><div class="figure"><a id="id782602"/><p class="title"><strong>24.6. ábra - Felül: Az <span class="emphasis"><em>I(x)</em></span> intenzitásprofil egy egydimenziós részlet mentén egy lépcsőfok élén át. Középen: Az intenzitás deriváltja, <span class="emphasis"><em>I'(x)</em></span>. A függvény nagy értékei éleknek felelnek meg, de a függvény zajos. Lent: Az intenzitás simított változatának deriváltja, (<span class="emphasis"><em>I</em></span> ∗<span class="emphasis"><em>G<sub> </sub><sub>σ</sub></em></span>)<span class="emphasis"><em>'</em></span>, amely <span class="emphasis"><em>I</em></span> ∗ <span class="emphasis"><em>G'</em></span>-hoz hasonlóan egy lépésben számolható. Az<span class="emphasis"><em> x</em></span> = 75 pontban levő zajos él jelölt eltűnt.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/24-06.png" alt="Felül: Az I(x) intenzitásprofil egy egydimenziós részlet mentén egy lépcsőfok élén át. Középen: Az intenzitás deriváltja, I'(x). A függvény nagy értékei éleknek felelnek meg, de a függvény zajos. Lent: Az intenzitás simított változatának deriváltja, (I ∗G σ)', amely I ∗ G'-hoz hasonlóan egy lépésben számolható. Az x = 75 pontban levő zajos él jelölt eltűnt."/></div></div></div><p>Van arra esélyünk, hogy optimalizáljuk a munkát ezen a ponton: egyetlen műveletben kombinálhatjuk a simítást és az éldetektálást. Egy tétel szerint tetszőleges <span class="emphasis"><em>f</em></span> és <span class="emphasis"><em>g</em></span> függvények esetén megmutatható, hogy a konvolúció deriváltja (<span class="emphasis"><em>f </em></span>∗<span class="emphasis"><em> g</em></span>)<span class="emphasis"><em>' </em></span>megegyezik a derivált konvolúciójával: <span class="emphasis"><em>f</em></span> ∗ (<span class="emphasis"><em>g</em></span>)<span class="emphasis"><em>'</em></span>. Tehát ahelyett, hogy először simítanánk, majd differenciálnánk, egyszerűen konvolváljuk a képet a Gauss simító függvény deriváltjával, <span class="emphasis"><em>G'<sub>σ</sub></em></span>-val. Így az egydimenziós éldetektálás algoritmusa a következő:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Az <span class="emphasis"><em>I</em></span> képet a <span class="emphasis"><em>G'<sub>σ</sub></em></span>-val kell konvolválnunk, hogy az <span class="emphasis"><em>R</em></span>-et megkapjuk.</p></li><li class="listitem"><p>Jelöljük be az azokat a csúcsokat ||<span class="emphasis"><em>R</em></span>(<span class="emphasis"><em>x</em></span>)||-ben, amelyek egy előre definiált <span class="emphasis"><em>T</em></span> küszöbnél magasabbak. A küszöb értékét úgy határozzuk meg, hogy a zaj miatti másodlagos csúcsokat elimináljuk.</p></li></ol></div><p>Két dimenzióban egy él irányítottsága tetszőleges <span class="emphasis"><em>θ </em></span>szögű lehet. A függőleges élek detektálásának módja nyilvánvaló: <span class="emphasis"><em>G'<sub>σ</sub></em></span>(<span class="emphasis"><em>x</em></span>) <span class="emphasis"><em>G<sub>σ</sub></em></span>(<span class="emphasis"><em>y</em></span>)-nal kell konvolválnunk a képet. A hatás <span class="emphasis"><em>y</em></span> irányban simító (a Gauss-konvolúció miatt), <span class="emphasis"><em>x</em></span> irányban pedig egy simítással kísért differenciálás. A függőleges élek detektálási algoritmusa így az alábbi:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Konvolváljuk az <span class="emphasis"><em>I</em></span> (<span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>) képet az <span class="emphasis"><em>f<sub>V</sub></em></span>(<span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>) = <span class="emphasis"><em>G'<sub>σ</sub></em></span> (<span class="emphasis"><em>x</em></span>) <span class="emphasis"><em>G<sub>σ</sub></em></span> (<span class="emphasis"><em>y</em></span>)-nal, hogy az <span class="emphasis"><em>R<sub>V</sub></em></span>(<span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>) -t megkapjuk.</p></li><li class="listitem"><p>Jelöljük be azokat a csúcsokat az ||<span class="emphasis"><em>R<sub>V </sub></em></span>(<span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>)||-ben, amelyek egy előre definiált <span class="emphasis"><em>T<sub>n</sub></em></span> küszöbnél magasabbak.</p></li></ol></div><p>A tetszőleges orientációjú él detektálásához a képet két szűrővel: az <span class="emphasis"><em>f<sub>V</sub></em></span> = <span class="emphasis"><em>G'<sub>σ</sub></em></span>(<span class="emphasis"><em>x</em></span>) <span class="emphasis"><em>G<sub>σ</sub></em></span>(<span class="emphasis"><em>y</em></span>) és az <span class="emphasis"><em>f<sub>H</sub></em></span> = <span class="emphasis"><em>G'<sub>σ</sub></em></span>(<span class="emphasis"><em>y</em></span>) <span class="emphasis"><em>G<sub>σ</sub></em></span>(<span class="emphasis"><em>x</em></span>) szűrővel kell konvolválni (az <span class="emphasis"><em>f<sub>H</sub></em></span> az <span class="emphasis"><em>f<sub>V</sub></em></span> 90°-kal elforgatott változata). A tetszőleges orientációjú éldetektáló algoritmus az alábbi:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Konvolváljuk az <span class="emphasis"><em>I</em></span> (<span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>) képet az <span class="emphasis"><em>f<sub>V</sub></em></span> (<span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>)-nal, valamint az <span class="emphasis"><em>f<sub>H </sub></em></span>(<span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>)-nal, hogy az <span class="emphasis"><em>R<sub>V</sub></em></span>(<span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>)-t és az <span class="emphasis"><em>R<sub>H</sub></em></span>(<span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>) -t megkaphassuk. Definiáljuk az <span class="inlinemediaobject"><img src="math/mi-24-0016.gif" alt="Felül: Az I(x) intenzitásprofil egy egydimenziós részlet mentén egy lépcsőfok élén át. Középen: Az intenzitás deriváltja, I'(x). A függvény nagy értékei éleknek felelnek meg, de a függvény zajos. Lent: Az intenzitás simított változatának deriváltja, (I ∗G σ)', amely I ∗ G'-hoz hasonlóan egy lépésben számolható. Az x = 75 pontban levő zajos él jelölt eltűnt."/></span>-t.</p></li><li class="listitem"><p>Jelöljük be azokat a csúcsokat az ||<span class="emphasis"><em>R</em></span>(<span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>)||-ban, amelyek egy előre definiált <span class="emphasis"><em>T</em></span> küszöbnél magasabbak.</p></li></ol></div><p>Miután ezzel az algoritmussal megjelöltük az élek képpontjait, a következő lépés az azonos élekhez tartozó képpontok összekötése. Ez megtehető, ha feltételezzük, hogy bármely két szomszédos képpont, amely élpont és konzisztens irányítottságú, szükségszerűen ugyanahhoz az élhez tartozik. Ezt a folyamatot <span class="strong"><strong>Canny-féle éldetektor</strong></span>nak (<span class="strong"><strong>Canny edge detection</strong></span>) nevezzük, kitalálója, John Canny után.</p><p>Miután detektáltuk őket, az élek alkotják több következő feldolgozási lépés alapját: felhasználhatjuk őket a térbeli képalkotásban, a mozgásdetektálásban és az objektumok felismerésében.</p></div><div class="section" title="A kép szegmentálása"><div class="titlepage"><div><div><h2 class="title"><a id="id783012"/>A kép szegmentálása</h2></div></div></div><p>Az emberek <span class="emphasis"><em>rendszerezik</em></span> észleléseiket; az egyes fotóérzékelőkhöz tartozó fényességértékek halmaza helyett vizuális csoportokat észlelünk, amelyek általában objektumokkal vagy azok részeivel asszociáltak. Ez a képesség a számítógépes látás számára is éppúgy fontos.</p><p>A <span class="strong"><strong>szegmentálás</strong></span> (<span class="strong"><strong>segmentation</strong></span>) a kép felbontása részcsoportokra a képpontok hasonlósága alapján. Az alapötlet a következő: minden képponthoz rendelhetünk bizonyos vizuális tulajdonságokat, mint például fényesség, szín és mintázat.<sup>[<a id="id783034" href="#ftn.id783034" class="footnote">271</a>]</sup> Ezek az attribútumok egy objektumon vagy annak egyetlen részén belül, csak kismértékben változnak, míg az objektumok közötti határok mentén tipikusan egyik vagy másik attribútum jelentősen változik. Úgy kell a képet képpontok halmazaira felosztanunk, hogy ezeket a kényszereket amennyire csak lehet, kielégítsük.</p><p>Többféle módszer létezik ezen intuitív elképzelés matematikai formalizálására. Például Shi és Malik (Shi és Malik, 2000) ezt gráfparticionálási problémaként határozzák meg. A gráf csomópontjai a képpontoknak felelnek meg, az élek pedig a köztük levő kapcsolatoknak. Egy <span class="emphasis"><em>W<sub>ij</sub></em></span> súly értéke az <span class="emphasis"><em>i</em></span> és <span class="emphasis"><em>j</em></span> képpontokat összekötő élen attól függ, hogy a két képpont mennyire hasonló fényességben, színben, mintázatban és más tulajdonságokban. Ezek után olyan partíciókat keresnek, amelyek minimalizálnak egy <span class="emphasis"><em>normalizált vágási </em></span>kritériumot. Durván fogalmazva a gráf particionálásának kritériuma, hogy a csoportok közötti élek súlyainak összegét minimalizáljuk, a csoportokon belüli élek súlyainak összegét pedig maximalizáljuk.</p><p>A pusztán alacsony szintű, helyi tulajdonságokon – például a fényességen és színen – alapuló szegmentáció hibázásra hajlamos eljárás. Ahhoz, hogy az objektumokhoz rendelt határokat megbízhatóan megtalálhassuk, a jelenetben várható objektumfajtákról magas szintű tudást is be kell építenünk. A beszédfelismerésre ezt a rejtett Markov-modell formalizmusa teszi lehetővé, míg a képek kontextusában egy ilyen egységes keretrendszer még mindig az aktív kutatás tárgya. Mindenesetre az objektumokról szóló magas szintű tudás a következő alfejezet tárgya.</p></div><div class="footnotes"><br/><hr/><div class="footnote"><p class="footnote text"><sup>[<a id="ftn.id783034" href="#id783034" class="para">271</a>] </sup> A mintázati jellemzők a képpontra középpontozott kis felületdarabka statisztikai elemzésén alapulnak.</p></div></div></div></body></html>
