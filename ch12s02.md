<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/></head><body><div class="section" title="Hierarchikus feladatháló tervkészítés"><div class="titlepage"><div><div><h1 class="title"><a id="id652393"/>Hierarchikus feladatháló tervkészítés</h1></div></div></div><p>Az egyik legelterjedtebb módszer a komplexitás kezelésére a <span class="strong"><strong>hierarchikus dekompozíció</strong></span> (<span class="strong"><strong>hierarchical decomposition</strong></span>). Az összetett szoftvereket szubrutinok vagy objektum osztályok hierarchiájából építik fel, a hadseregek különböző egységek hierarchiái, a kormányok és cégek igazgatóságokból, osztályokból és alosztályokból állnak. A hierarchikus struktúra fő előnye, hogy a hierarchia minden szintjén egy számítási feladat, egy hadművelet vagy egy adminisztratív feladat az eggyel alatta lévő szint néhány cselekvésére épül, így e cselekvések megfelelő elrendezése a magasabb szinten lévő feladat megoldásához <span class="emphasis"><em>kis</em></span> számítási költséggel jár. Másrészről a nem hierarchikus módszerek a feladatot <span class="emphasis"><em>nagy</em></span>számú, független cselekvésre bontják fel, ami nagy léptékű feladatok esetén egyáltalán nem praktikus. A legjobb esetben – amikor a magas szintű megoldásokhoz mindig kielégítő alacsony szintű megvalósítás tartozik – a hierarchikus megoldások az exponenciális idejű tervkészítő algoritmusokkal szemben lineáris időre vezetnek. </p><p>Ez az alfejezet a <span class="strong"><strong>hierarchikus feladatháló</strong></span>kon vagy <span class="strong"><strong>HFH</strong></span>-kon (<span class="strong"><strong>hierarchical task </strong></span><span class="strong"><strong>networks</strong></span> – <span class="strong"><strong>HTN</strong></span>) alapuló tervkészítési módszert mutatja be. A megközelítésünk ötvözi a részben rendezett tervkészítés (11.3.<span class="emphasis"><em> </em></span>alfejezet) alapötleteit, illetve a „HFH-tervkészítés” területét. A HFH-tervkészítésben a kiinduló problémát, amely a feladatot írja le, a végrehajtandó feladat egy nagyon magas szintű leírásának tekintjük, például: építsünk egy házat. A terveket <span class="strong"><strong>cselekvésdekompozíció</strong></span>kkal (<span class="strong"><strong>action decompositions</strong></span>) finomítjuk. Minden cselekvésdekompozíció a magas szintű cselekvést alacsonyabb szintű cselekvések részben rendezett halmazára bontja. A cselekvésdekompozíció ezért a cselekvések megvalósítására vonatkozó ismereteket testesíti meg. Például egy ház felépítése az engedélyek megszerzésére, a kivitelező megbízására, az építkezés elvégzésére és a kivitelező kifizetésére redukálható. (A 12.5.<span class="emphasis"><em> </em></span>ábra egy ilyen dekompozícióra mutat példát.) A folyamat addig folytatódik, amíg csak az <span class="strong"><strong>egyszerű cselekvés</strong></span>ek (<span class="strong"><strong>primitive action</strong></span>s) maradnak a tervben. Az egyszerű cselekvések tipikusan azok a cselekvések, amelyeket az ágens automatikusan végre tud hajtani. Egy általános kivitelezőre a „kertépítés” egy egyszerű cselekvés lehet, mert egyszerűen csak egy kertépítő bevonását jelenti. Egy kertépítő számára azonban az olyan cselekvések tekinthetők egyszerűnek, mint az „ültessen rododendront ide”.</p><p>A „tiszta” HFH-tervkészítésben a terveket <span class="emphasis"><em>csak</em></span> egymást követő cselekvésdekompozíciókkal állítjuk elő. A HFH ezért a tervkészítést a cselekvésleírások <span class="emphasis"><em>konkretizálásának</em></span> tekinti, szemben az üres cselekvésből kiinduló cselekvésleírás <span class="emphasis"><em>elkészítésének</em></span> folyamatával (ami az állapottér-keresésre és a részben rendezett tervkészítésre is igaz). Végezetül kiderül, hogy minden <code class="code">STRIPS</code> cselekvésleírás egy cselekvésdekompozícióra írható át (lásd 12.6.<span class="emphasis"><em> </em></span>feladat), és a részben rendezett tervkészítés a tiszta HFH-tervkészítés egy speciális esetének tekinthető. Bizonyos feladatokra azonban – különösen „szokatlan” konjunktív célokra — a tiszta HFH-nézőpont eléggé természetellenes, így egy <span class="emphasis"><em>hibrid</em></span> megközelítést részesítünk előnyben, ahol a cselekvésdekompozíciókat mint a részben rendezett tervkészítés tervfinomításait használjuk fel, a nyitott előfeltételek teljesítése és az ütközés feloldásra szolgáló rendezési megkötések hozzáadása mellett. (Annak, hogy a HFH-tervkészítést a részben rendezett tervkészítés kiterjesztésének tekintjük, további előnye, hogy egy teljesen új jelölésrendszer bevezetése helyett ugyanaz használható.) Kezdésként a cselekvések dekomponálását mutatjuk be részletesebben, majd elmagyarázzuk, hogy a részben rendezett tervkészítést hogyan kell módosítani a dekompozíciók kezeléséhez. Végezetül a teljesség, a komplexitás és a használhatóság kérdéseit tárgyaljuk.</p><div class="section" title="A cselekvésdekompozíciók reprezentációja"><div class="titlepage"><div><div><h2 class="title"><a id="id654430"/>A cselekvésdekompozíciók reprezentációja</h2></div></div></div><p>A cselekvésdekompozíciós módszerek általános leírásait egy <span class="strong"><strong>tervkönyvtár</strong></span>ban (<span class="strong"><strong>plan libary</strong></span>) tároljuk, ahonnan kinyerhetők és a készülő terv igényeinek megfelelően felhasználhatók. Minden módszer egy <span class="emphasis"><em>Dekomponál</em></span>(<span class="emphasis"><em>a</em></span>, <span class="emphasis"><em>d</em></span>) formájú kifejezés, amelynek jelentése, hogy egy <span class="emphasis"><em>a</em></span> cselekvés dekomponálható a <span class="emphasis"><em>d</em></span> tervbe, mely egy – a 11.3.<span class="emphasis"><em> </em></span>alfejezetben leírtaknak megfelelő – részben rendezett tervként van megadva. </p><p>A házépítés egy szép, konkrét példa, ezért ezt használjuk fel a cselekvésdekompozíció bemutatására. A 12.5.<span class="emphasis"><em> </em></span>ábra a <span class="emphasis"><em>HázatÉpít</em></span> cselekvés egy lehetséges dekompozícióját mutatja négy alacsonyabb szintű cselekvésre. A 12.6.<span class="emphasis"><em> </em></span>ábra néhány cselekvés leírását tartalmazza erre a feladatkörre, valamint a házépítés dekompozícióját, ahogyan az a tervkönyvtárban megjelenne. A könyvtárban más lehetséges dekompozíciók is szerepelhetnek. </p><p>A dekompozíció <span class="emphasis"><em>Indít</em></span> cselekvése szolgáltatja a terv cselekvéseinek összes olyan előfeltételét, melyet más cselekvés nem állít elő. Ezeket <span class="strong"><strong>külső előfeltétel</strong></span>eknek (<span class="strong"><strong>external precondition</strong></span>s) nevezzük. Példánkban a dekompozíció külső előfeltételei a <span class="emphasis"><em>Telek</em></span> és a <span class="emphasis"><em>Pénz</em></span>. Hasonlóképp a <span class="emphasis"><em>Befejez</em></span> előfeltételei a <span class="strong"><strong>külső következmény</strong></span>ek (<span class="strong"><strong>external effect</strong></span>s). Ezek a terv cselekvéseinek összes olyan következményét jelentik, melyeket más cselekvések nem negálnak. Példánkban a <span class="emphasis"><em>HázatÉpít</em></span> külső következményei a <span class="emphasis"><em>Ház</em></span> és a ¬<span class="emphasis"><em>Pénz</em></span>. Néhány HFH-tervkészítő szintén különbséget tesz az <span class="strong"><strong>elsődleges</strong></span><span class="strong"><strong> következmény</strong></span>ek (<span class="strong"><strong>primary effect</strong></span>s), mint a <span class="emphasis"><em>Ház</em></span>, és a <span class="strong"><strong>másodlagos következmény</strong></span>ek (<span class="strong"><strong>secondary effect</strong></span>s), mint a ¬<span class="emphasis"><em>Pénz</em></span> között. Mivel mindkét típusú következmény felhasználása ütközésekhez vezethet más cselekvésekkel, csak az elsődleges következményeket használhatjuk a célok elérésére, ami nagymértékben csökkenti a keresési teret.<sup>[<a id="id654561" href="#ftn.id654561" class="footnote">119</a>]</sup></p><div class="figure"><a id="id654573"/><p class="title"><strong>12.5. ábra - A <span class="emphasis"><em>HázatÉpít</em></span> cselekvés egy lehetséges dekompozíciója</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/12-05.png" alt="A HázatÉpít cselekvés egy lehetséges dekompozíciója"/></div></div></div><p>A dekompozíciónak a cselekvés egy <span class="emphasis"><em>korrekt</em></span> megvalósításának kell lennie. A <span class="emphasis"><em>d</em></span> terv egy <span class="emphasis"><em>a</em></span> cselekvést korrekten valósít meg, ha <span class="emphasis"><em>d</em></span> egy teljes és konzisztens részben rendezett terv arra a problémára, ahol <span class="emphasis"><em>a</em></span> előfeltételeiből <span class="emphasis"><em>a</em></span> következményeit kell elérnünk. Ha a dekompozíció egy helyesen működő részben rendezett tervkészítő futásának eredménye, akkor nyilvánvalóan korrekt.</p><p>Bármely magas szintű cselekvéshez a tervkönyvtár számos dekompozíciót tartalmazhat, például a <span class="emphasis"><em>HázatÉpít</em></span>-nek lehet egy másik dekompozíciója, amely a folyamatot úgy írja le, hogy a házat az ágens saját kezűleg építi kövekből és malterből. Minden dekompozíciónak egy korrekt tervnek kell lennie, de a magas szintű cselekvésleírásban szereplőkön túl további előfeltételeket és következményeket is tartalmazhat. Például a <span class="emphasis"><em>HázatÉpít </em></span>12.5.<span class="emphasis"><em> </em></span>ábrán látható dekompozíciója a <span class="emphasis"><em>Telek</em></span> mellett a <span class="emphasis"><em>Pénz-</em></span>t is megköveteli, és következménye a ¬<span class="emphasis"><em>Pénz</em></span>. Másrészről a saját kezű építés nem igényel pénzt, de szükséges hozzá egy felhasználásra váró <span class="emphasis"><em>Kő</em></span> és <span class="emphasis"><em>Malter</em></span> készlet, valamint eredménye lehet egy <span class="emphasis"><em>FájósHát</em></span>.</p><p>Mivel egy magas szintű cselekvésnek, mint amilyen a <span class="emphasis"><em>HázatÉpít</em></span>, számos lehetséges dekompozíciója lehet, elkerülhetetlen, hogy a <code class="code">STRIPS</code> cselekvésleírása elrejtse ezen dekompozíciók néhány előfeltételét vagy következményét. A magas szintű cselekvés előfeltételeit a dekompozícióiban szereplő külső előfeltételek <span class="emphasis"><em>metszete,</em></span> míg a következményit a dekompozíciók külső következményeinek metszete adja. Másképpen, a magas szintű előfeltételek és következmények garantáltan részhalmazai minden egyszerű implementáció valós előfeltételeinek és következményeinek. </p><div class="figure"><a id="id654658"/><p class="title"><strong>12.6. ábra - A házépítési probléma cselekvéseinek leírása és a <span class="emphasis"><em>HázatÉpít</em></span> cselekvés részletes dekompozíciója. A leírások a pénzzel kapcsolatban egy egyszerűsített, az építőkkel kapcsolatban egy optimista nézetet alkalmaznak.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/12-06.png" alt="A házépítési probléma cselekvéseinek leírása és a HázatÉpít cselekvés részletes dekompozíciója. A leírások a pénzzel kapcsolatban egy egyszerűsített, az építőkkel kapcsolatban egy optimista nézetet alkalmaznak."/></div></div></div><p>Az információ elrejtésének két másik formáját is meg kell említenünk. Először, a magas szintű leírás teljes mértékben figyelmen kívül hagyja a dekompozíciók <span class="strong"><strong>összes belső követ</strong></span><span class="strong"><strong>kezmény</strong></span>ét (<span class="strong"><strong>internal effect</strong></span>s). Például a <span class="emphasis"><em>HázatÉpít </em></span>általunk javasolt dekompozíciójának ideiglenes belső következménye az <span class="emphasis"><em>Engedély</em></span> és a <span class="emphasis"><em>Szerződés.<sup>[<a id="id654696" href="#ftn.id654696" class="footnote">120</a>]</sup></em></span> Másodszor, a magas szintű leírás nem specifikálja a cselekvésen belüli időintervallumot, ami alatt a magas szintű előfeltételeknek és következményeknek teljesülniük kell. Például a <span class="emphasis"><em>Telek</em></span> előfeltételnek csak addig kell teljesülnie (a közelítő modellünkben), amíg az <span class="emphasis"><em>EngedélytSzerez </em></span>nem hajtódik végre, és a <span class="emphasis"><em>Ház</em></span> csak a <span class="emphasis"><em>KivitelezőtKifizet </em></span>végrehajtása után igaz.</p><p>Az információ elrejtésének ez a módja szükségszerű, ha a hierachikus tervezés célja a komplexitás csökkentése. Szükséges, hogy a magas szintű cselekvésekről anélkül dönthessünk, hogy a számtalan implementációs részlet miatt aggódnánk. Ennek azonban ára van. Konfliktusok léphetnek fel, például egy magas szintű cselekvés belső feltételei, valamint egy másik magas szintű cselekvés belső cselekvései között, miközben a magas szintű leírások alapján nincs mód ezek detektálására. Ennek a problémának komoly hatásai vannak a HFH-tervkészítő algoritmusokra. Dióhéjban, míg a tervkészítő algoritmus az atomi cselekvéseket, mint pontszerű eseményeket kezelheti, a magas szintű cselekvéseknek időbeli kiterjedése van, ami alatt minden mehet tovább.</p></div><div class="section" title="A tervkészítő módosítása a dekompozíciók kezeléséhez"><div class="titlepage"><div><div><h2 class="title"><a id="id654738"/>A tervkészítő módosítása a dekompozíciók kezeléséhez</h2></div></div></div><p>Most megmutatjuk, hogyan módosítható a részben rendezett tervkészítő, hogy egy HFH-tervkészítőt is tartalmazzon. Ehhez a részben rendezett tervkészítő állapotátmenet-függvényét (lásd <a class="xref" href="ch11s03.md#ID_468_oldal">„Példa a részben rendezett tervkészítésre”</a> részben) módosítsuk úgy, hogy lehetővé tegye a <span class="emphasis"><em>T</em></span> aktuális részleges terven a dekompozíciós módszerek alkalmazását. Az új következő terveket úgy alakítjuk ki, hogy először kiválasztunk néhány nem-atomi <span class="emphasis"><em>a</em></span>’ cselekvést a <span class="emphasis"><em>T</em></span>-ből, majd a tervkönyvtár minden <span class="emphasis"><em>Dekomponál</em></span>(<span class="emphasis"><em>a</em></span>, <span class="emphasis"><em>d</em></span>) metódusára, amelyben a <span class="emphasis"><em>θ </em></span>behelyettesítéssel az <span class="emphasis"><em>a</em></span> és <span class="emphasis"><em>a</em></span>’ egyenlővé válik, az <span class="emphasis"><em>a</em></span>’<span class="emphasis"><em>-</em></span>t behelyettesítjük a <span class="emphasis"><em>d</em></span>’ = <code class="code">SUBST</code> (<span class="emphasis"><em>θ</em></span>, <span class="emphasis"><em>d</em></span>)-vel.</p><p>A 12.7.<span class="emphasis"><em> </em></span>ábrán egy példa látható. Az ábra tetején egy ház megszerzésére vezető <span class="emphasis"><em>T</em></span> terv található. Az <span class="emphasis"><em>a</em></span>’ = <span class="emphasis"><em>HázatÉpít </em></span>magas szintű cselekvést választottuk a dekompozícióra. A 12.5.<span class="emphasis"><em> </em></span>ábráról a <span class="emphasis"><em>d</em></span> dekompozíciót választottuk, és a <span class="emphasis"><em>HázatÉpít </em></span>cselekvést ezzel helyettesítettük. A dekompozíciós lépés által létrehozott <span class="emphasis"><em>Pénz</em></span> nyitott feltétel teljesítésére a <span class="emphasis"><em>KölcsöntVeszFel </em></span>járulékos lépést vezettük be. Egy cselekvés helyettesítése annak dekompozíciójával egy kicsit hasonlít a szervátültetéses műtétekhez. Az új résztervet ki kell bontanunk a csomagolásából (az <span class="emphasis"><em>Indít</em></span> és <span class="emphasis"><em>Befejez</em></span> lépések közül), be kell illesztenünk és mindent megfelelően le kell zárnunk. Ezt többféleképpen is megtehetjük. Hogy pontosabbak legyünk, minden lehetséges <span class="emphasis"><em>d</em></span>’ dekompozícióhoz az alábbiakat kell megtennünk:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Először is az <span class="emphasis"><em>a</em></span>’ cselekvést el kell távolítani a <span class="emphasis"><em>T</em></span> tervből. Ezután a <span class="emphasis"><em>d</em></span>’ minden <span class="emphasis"><em>s </em></span>lépésére ki kell választanunk egy cselekvést, amely kitölti az <span class="emphasis"><em>s</em></span> szerepét, és hozzá kell adnunk a tervhez. Ez lehet az <span class="emphasis"><em>s</em></span> egy új példányosítása vagy egy meglévő <span class="emphasis"><em>s</em></span>’ lépés a <span class="emphasis"><em>T</em></span>-ből, ami <span class="emphasis"><em>s</em></span>-sel azonos. A <span class="emphasis"><em>Borkészítés</em></span> cselekvésdekompozíciója például megkövetelheti a <span class="emphasis"><em>TelketVesz</em></span> cselekvést, de várhatóan használhatjuk ugyanazt a <span class="emphasis"><em>TelketVesz</em></span> cselekvést, mely már szerepel a tervben. Ezt <span class="strong"><strong>részfeladat-megosztás</strong></span>nak (<span class="strong"><strong>subtask sharing</strong></span>) nevezzük. </p></li></ol></div><p>	A 12.7.<span class="emphasis"><em> </em></span>ábrán nincsenek megosztási lehetőségek, ezért új cselekvéspéldányokat hoztunk létre. Ha egy cselekvést kiválasztottunk, <span class="emphasis"><em>d</em></span>’ minden belső előfeltételét átmásoljuk. Például az <span class="emphasis"><em>EngedélytSzerez </em></span>cselekvés, az építkezés elé rendelt, és létezik egy okozati kapcsolat ezen lépések között, mely szerint az <span class="emphasis"><em>Engedély</em></span> előfeltétele az <span class="emphasis"><em>Építkezés-</em></span>nek. Ez lezárja az <span class="emphasis"><em>a</em></span>’ helyettesítését a <span class="emphasis"><em>dθ</em></span> példányosításával.</p><div class="figure"><a id="id654936"/><p class="title"><strong>12.7. ábra - Egy magas szintű cselekvés dekompozíciója egy létező tervben. A <span class="emphasis"><em>HázatÉpít</em></span> cselekvést a 12.5.<span class="emphasis"><em> </em></span>ábra dekompozíciójával helyettesítjük. A <span class="emphasis"><em>Telek</em></span> külső előfeltételt a már létező <span class="emphasis"><em>TelketVesz</em></span>-ből kiinduló okozati kapcsolat biztosítja. A <span class="emphasis"><em>Pénz</em></span> külső előfeltétel nyitott marad a dekompozíciós lépés után, ezért a <span class="emphasis"><em>KölcsöntVeszFel</em></span> cselekvést szúrjuk be.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/12-07.png" alt="Egy magas szintű cselekvés dekompozíciója egy létező tervben. A HázatÉpít cselekvést a 12.5. ábra dekompozíciójával helyettesítjük. A Telek külső előfeltételt a már létező TelketVesz-ből kiinduló okozati kapcsolat biztosítja. A Pénz külső előfeltétel nyitott marad a dekompozíciós lépés után, ezért a KölcsöntVeszFel cselekvést szúrjuk be."/></div></div></div><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>A következő lépés, hogy az eredeti tervben szereplő <span class="emphasis"><em>a</em></span>’ sorrendezési megkötéseit megfelelően átvezessük a <span class="emphasis"><em>d</em></span>’ lépéseihez. Először vegyük <span class="emphasis"><em>T B </em></span>≺<span class="emphasis"><em> a</em></span>’ alakú sorrendezési megkötéseit. Hogyan kellene <span class="emphasis"><em>B-</em></span>t rendezni a <span class="emphasis"><em>d</em></span>’ lépéseinek megfelelően? A legkézenfekvőbb megoldás, hogy <span class="emphasis"><em>B</em></span> az összes <span class="emphasis"><em>d</em></span>’<span class="emphasis"><em>-</em></span>ben szereplő lépés előtt jöjjön, amit úgy érhetünk el, hogy <span class="emphasis"><em>d</em></span>’ minden <span class="emphasis"><em>Indít </em></span>≺<span class="emphasis"><em> s</em></span> alakú megkötését a <span class="emphasis"><em>B </em></span>≺<span class="emphasis"><em> s</em></span> megkötéssel helyettesítjük. Másrészről ez a megközelítés túlzottan szigorú lehet! Például a <span class="emphasis"><em>TelketVesz</em></span> a <span class="emphasis"><em>HázatÉpít</em></span> előtt kell következzen, de nincsen szükség arra, hogy a <span class="emphasis"><em>TelketVesz</em></span> a <span class="emphasis"><em>KivitelezőtVeszFel</em></span> előtt jöjjön a kiterjesztett tervben. Egy túlzottan szigorú rendezés felállítása lehetetlenné teheti néhány megoldás megtalálását. Ezért minden rendezési megkötésre a legjobb megoldás, hogy rögzítsük a megkötés <span class="emphasis"><em>okát</em></span>. Ha ezután egy magas szintű cselekvést kibontunk, az új rendezési megkötések a lehető leglazábbra vehetők az eredeti megkötés okával összhangban. Ugyanezek a megfontolások alkalmazhatók, amikor az <span class="emphasis"><em>a</em></span>’<span class="emphasis"><em> </em></span>≺<span class="emphasis"><em> C</em></span> alakú megkötéseket helyettesítjük. </p></li></ol></div><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Az utolsó lépés, hogy az okozati kapcsolatokat átvezessük. Ha a<span class="emphasis"><em> </em></span><span class="inlinemediaobject"><img src="math/mi-12-0001.gif" alt="Egy magas szintű cselekvés dekompozíciója egy létező tervben. A HázatÉpít cselekvést a 12.5. ábra dekompozíciójával helyettesítjük. A Telek külső előfeltételt a már létező TelketVesz-ből kiinduló okozati kapcsolat biztosítja. A Pénz külső előfeltétel nyitott marad a dekompozíciós lépés után, ezért a KölcsöntVeszFel cselekvést szúrjuk be."/></span> az eredeti terv egy okozati kapcsolata volt, helyettesítsük azt egy okozati kapcsolathalmazzal, amely <span class="emphasis"><em>B-</em></span>ből <span class="emphasis"><em>d</em></span>’ összes olyan lépéséhez vezet, amelynek előfeltétele a <span class="emphasis"><em>d</em></span> dekompozíció <span class="emphasis"><em>Indít</em></span> lépése által előállított <span class="emphasis"><em>p </em></span>(például <span class="emphasis"><em>d</em></span>’ összes lépése, melyekre <span class="emphasis"><em>p</em></span> egy külső előfeltétel). A példában a <span class="inlinemediaobject"><img src="math/mi-12-0002.gif" alt="Egy magas szintű cselekvés dekompozíciója egy létező tervben. A HázatÉpít cselekvést a 12.5. ábra dekompozíciójával helyettesítjük. A Telek külső előfeltételt a már létező TelketVesz-ből kiinduló okozati kapcsolat biztosítja. A Pénz külső előfeltétel nyitott marad a dekompozíciós lépés után, ezért a KölcsöntVeszFel cselekvést szúrjuk be."/></span> okozati kapcsolatot a <span class="inlinemediaobject"><img src="math/mi-12-0003.gif" alt="Egy magas szintű cselekvés dekompozíciója egy létező tervben. A HázatÉpít cselekvést a 12.5. ábra dekompozíciójával helyettesítjük. A Telek külső előfeltételt a már létező TelketVesz-ből kiinduló okozati kapcsolat biztosítja. A Pénz külső előfeltétel nyitott marad a dekompozíciós lépés után, ezért a KölcsöntVeszFel cselekvést szúrjuk be."/></span> kapcsolattal helyettesítjük. (A dekompozícióban szereplő <span class="emphasis"><em>KivitelezőtKifizet</em></span>,<span class="emphasis"><em> Pénz</em></span> előfeltétele nyitott feltétellé válik, mert az eredeti tervben nincs olyan cselekvés, ami a <span class="emphasis"><em>Pénz</em></span>-t biztosítja a <span class="emphasis"><em>HázatÉpít</em></span>-hez.) Hasonlóképpen a terv összes <span class="inlinemediaobject"><img src="math/mi-12-0004.gif" alt="Egy magas szintű cselekvés dekompozíciója egy létező tervben. A HázatÉpít cselekvést a 12.5. ábra dekompozíciójával helyettesítjük. A Telek külső előfeltételt a már létező TelketVesz-ből kiinduló okozati kapcsolat biztosítja. A Pénz külső előfeltétel nyitott marad a dekompozíciós lépés után, ezért a KölcsöntVeszFel cselekvést szúrjuk be."/></span> okozati kapcsolatát helyettesítsük <span class="emphasis"><em>d</em></span>’ bármely, a <span class="emphasis"><em>d</em></span> dekompozíció <span class="emphasis"><em>Vége</em></span> lépéséhez <span class="emphasis"><em>p-</em></span>t szolgáltató lépésből <span class="emphasis"><em>C-</em></span>be mutató okozati kapcsolathalmazzal (például <span class="emphasis"><em>d</em></span>’ <span class="emphasis"><em>p-</em></span>t külső következményként tartalmazó lépéséből). Példánkban a <span class="inlinemediaobject"><img src="math/mi-12-0005.gif" alt="Egy magas szintű cselekvés dekompozíciója egy létező tervben. A HázatÉpít cselekvést a 12.5. ábra dekompozíciójával helyettesítjük. A Telek külső előfeltételt a már létező TelketVesz-ből kiinduló okozati kapcsolat biztosítja. A Pénz külső előfeltétel nyitott marad a dekompozíciós lépés után, ezért a KölcsöntVeszFel cselekvést szúrjuk be."/></span> kapcsolatot a <span class="inlinemediaobject"><img src="math/mi-12-0006.gif" alt="Egy magas szintű cselekvés dekompozíciója egy létező tervben. A HázatÉpít cselekvést a 12.5. ábra dekompozíciójával helyettesítjük. A Telek külső előfeltételt a már létező TelketVesz-ből kiinduló okozati kapcsolat biztosítja. A Pénz külső előfeltétel nyitott marad a dekompozíciós lépés után, ezért a KölcsöntVeszFel cselekvést szúrjuk be."/></span> kapcsolattal helyettesítjük. </p></li></ol></div><p>Ez lezárja a részben rendezett tervkészítőknél alkalmazott, a dekompozíciók elkészítéséhez szükséges kiterjesztéseket.<sup>[<a id="id655186" href="#ftn.id655186" class="footnote">121</a>]</sup></p><p>A részben rendezett tervkészítő algoritmushoz további módosítások szükségesek, mert a magas szintű cselekvések <span class="emphasis"><em>elrejtik az információt </em></span>a végső elemi megvalósításukról. Nevezetesen az eredeti részben rendezett tervkészítő algoritmus hibával lép vissza, ha az aktuális terv feloldhatatlan ütközést tartalmaz, vagyis ha egy cselekvés ütközik egy okozati kapcsolattal, de nem helyezhető sem elé, sem pedig mögé. (Erre a 11.9.<span class="emphasis"><em> </em></span>ábra mutat példát.) Másrészről, a magas szintű cselekvések esetén a feloldhatatlan ütközések néha feloldhatók az ütköző cselekvések <span class="emphasis"><em>dekompozíciójával</em></span> és lépéseik összerendezésével. Erre a 12.8.<span class="emphasis"><em> </em></span>ábra mutat be egy példát. Így előfordulhat olyan eset, ahol dekompozícióval egy teljes és konzisztens alapterv nyerhető, <span class="emphasis"><em>még akkor is, hogyha nem létezik teljes és konzisztensen magas szintű terv</em></span>. Ez a lehetőség azt jelenti, hogy egy teljes HFH-tervkészítőnek végig kell tekintenie az eredeti részben rendezett tervkészítőhöz található számos metszési lehetőséget. Egyébként használhatjuk bármely metszési eljárást, remélve, hogy nem hagyunk figyelmen kívül lehetséges megoldást.</p><div class="figure"><a id="id655210"/><p class="title"><strong>12.8. ábra - Az O. Henrik történetből kiragadott <span class="emphasis"><em>Mágusok ajándéka</em></span> probléma egy inkonzisztens absztrakt tervet mutat, ami azonban dekomponálható egy konzisztens megoldásra. Az (a) ábra a problémát mutatja be: egy szegény házaspárnak csak két értékes tulajdona van. A férfinek egy aranyórája, a nőnek pedig a gyönyörű hosszú haja. Mindketten azt tervezik, hogy ajándékot vásárolnak a másiknak, hogy az boldog legyen. A férfi úgy dönt, hogy az óráját egy ezüstfésűre cseréli be, míg a nő eladja a haját, hogy aranyláncot vegyen az órához. (Feltételezzük, hogy a „Fésűt ad” cselekvés előfeltétele a <span class="emphasis"><em>Haj</em></span>, mivel ha a feleségnek nincs hosszú haja, a cselekvés nem éri el a kívánt hatást, hogy boldoggá tegye; és hasonlóképpen a „Láncot ad” cselekvésre.) A (b) ábrán szereplő részleges terv inkonzisztens, mert a „Fésűt ad” és „Láncot ad” absztrakt lépések nem sorrendezhetők konfliktus nélkül. (c) Dekomponáljuk a „Fésűt ad” lépést egy „beilleszt terv” metódussal. A dekompozíció első lépésében a férj megszerzi a fésűt, és odaadja feleségének, miközben az órát egy későbbi időpontban adja oda fizetségül. A második lépésben az órát átadja, és a kötelezettséget teljesíti. Egy hasonló módszer dekomponálja a „Láncot ad” lépést. Amíg mindkét odaadó lépést a szállítási lépés elé sorrendezzük, ez a dekompozíció megoldja a feladatot. (Vegyük észre, hogy ez azon múlik, hogy a lánc használata az órához vagy a fésű használata a hajhoz boldogságot okoz még akkor is, ha a tulajdonjogot már elvesztették.)</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/12-08.png" alt="Az O. Henrik történetből kiragadott Mágusok ajándéka probléma egy inkonzisztens absztrakt tervet mutat, ami azonban dekomponálható egy konzisztens megoldásra. Az (a) ábra a problémát mutatja be: egy szegény házaspárnak csak két értékes tulajdona van. A férfinek egy aranyórája, a nőnek pedig a gyönyörű hosszú haja. Mindketten azt tervezik, hogy ajándékot vásárolnak a másiknak, hogy az boldog legyen. A férfi úgy dönt, hogy az óráját egy ezüstfésűre cseréli be, míg a nő eladja a haját, hogy aranyláncot vegyen az órához. (Feltételezzük, hogy a „Fésűt ad” cselekvés előfeltétele a Haj, mivel ha a feleségnek nincs hosszú haja, a cselekvés nem éri el a kívánt hatást, hogy boldoggá tegye; és hasonlóképpen a „Láncot ad” cselekvésre.) A (b) ábrán szereplő részleges terv inkonzisztens, mert a „Fésűt ad” és „Láncot ad” absztrakt lépések nem sorrendezhetők konfliktus nélkül. (c) Dekomponáljuk a „Fésűt ad” lépést egy „beilleszt terv” metódussal. A dekompozíció első lépésében a férj megszerzi a fésűt, és odaadja feleségének, miközben az órát egy későbbi időpontban adja oda fizetségül. A második lépésben az órát átadja, és a kötelezettséget teljesíti. Egy hasonló módszer dekomponálja a „Láncot ad” lépést. Amíg mindkét odaadó lépést a szállítási lépés elé sorrendezzük, ez a dekompozíció megoldja a feladatot. (Vegyük észre, hogy ez azon múlik, hogy a lánc használata az órához vagy a fésű használata a hajhoz boldogságot okoz még akkor is, ha a tulajdonjogot már elvesztették.)"/></div></div></div></div><div class="section" title="Elemzés"><div class="titlepage"><div><div><h2 class="title"><a id="id655227"/>Elemzés</h2></div></div></div><p>Kezdjük a rossz hírrel: a tiszta HFH-tervkészítés (ahol az egyetlen megengedett tervfinomítás a dekompozíció), <span class="emphasis"><em>a véges állapottér ellenére is,</em></span> eldönthetetlen! Ez nagyon elszomorítónak tűnhet, mivel a HFH-tervkészítés lényege, hogy növeljük a hatékonyságot. Ez a nehézség azért lép fel, mert a cselekvésdekompozíciók <span class="strong"><strong>rekurzív</strong></span>ak (<span class="strong"><strong>recursive</strong></span>) (például a sétálás implementálható egy lépés megtételével és utána egy sétálással), így a HFH-tervek tetszőlegesen hosszúra nyúlhatnak. Nevezetesen a legrövidebb HFH-megoldás is tetszőlegesen hosszú lehet, így nincs arra lehetőség, hogy a keresést egy megadott idő után leállítsuk. Ennek ellenére azonban legalább három okunk van a bizakodásra:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Kizárhatjuk a rekurziót, amit csak nagyon kevés tervkészítési feladat igényel meg. Ebben az esetben az összes HFH-terv véges vagy megszámlálható hosszúságú. </p></li><li class="listitem"><p>Korlátozhatjuk azon megoldások hosszát, amelyekre kíváncsiak vagyunk. Mivel az állapottér véges, az olyan terv, amelynek több lépése van, mint az állapottér állapotainak száma, <span class="emphasis"><em>mindenképpen</em></span> tartalmaz ciklust, ami ugyanabba az állapotba többször lép be. Az ilyen HFH-megoldások kizárásával nagyon picit vesztünk, de uraljuk a keresést. </p></li><li class="listitem"><p>Létrehozhatunk egy hibrid megközelítést, ami a részben rendezett és a HFH-tervkészítőket kombinálja. A részben rendezett tervkészítés önmagában elegendő, hogy eldöntsük, létezik-e terv, így a hibrid feladat is nyilvánvalóan eldönthető. </p></li></ol></div><p>A harmadik megoldással egy kicsit óvatosan kell bánnunk. A részben rendezett tervkészítő különböző módokon tud elemi cselekvéseket összehuzalozni, így olyan megoldásokkal találhatjuk magunkat szembe, amelyek nagyon nehezen érhetők, és amelyeknek nincs meg a HFH-tervek szép hierarchikus rendezése. Egy megfelelő kompromisszum, hogy a hibrid keresést úgy szabályozzuk, hogy a cselekvésdekompozíciókat előnyben részesítjük az új cselekvések hozzáadása előtt, de nem olyan mértékben, hogy tetszőlegesen hosszú HFH-tervek jöjjenek létre, mielőtt egy elemi cselekvést hozzáadnánk. A megvalósítás egyik lehetséges módja egy költségfüggvény alkalmazása, amely engedményt ad a dekompozíció által bevezetett cselekvésekre. Minél nagyobb az engedmény, a keresés annál inkább a tiszta HFH-tervkészítésre hasonlít, és a megoldás annál inkább hierarchikus. A hierarchikus tervek rendszerint sokkal könnyebben végrehajthatók a valós helyzetekben, és könnyebben javíthatók, ha valami elromlik.</p><p>A HFH-tervek egy másik fontos tulajdonsága a részfeladat-megosztás lehetősége. Emlékezzünk vissza, hogy a részfeladat-megosztás azt jelenti, hogy ugyanazt a cselekvést használjuk fel a tervdekompozícióban szereplő két különböző lépéshez. Ha megtiltjuk az alfeladat megosztását, akkor a <span class="emphasis"><em>d</em></span>’ dekompozíció minden példányosítása csak egyetlen módon hajtható végre, nem pedig sokféleképp, így jelentősen szűkítjük a keresési teret. Rendszerint ez a szűkítés időt spórol, és a legrosszabb esetben is az optimálisnál csak kicsivel hosszadalmasabb megoldásra vezet. Néhány esetben azonban több problémát is okozhat. Vegyük például az „élvezzük a mézesheteket, és neveljünk fel egy családot” célt. A tervkönyvtár a „házasodj és menj Hawaiira” tervvel állhat elő az első részcélra és a „házasodj és legyenek gyermekeid” tervvel a másodikra. A részfeladat megosztás nélkül a terv két különálló házasodás cselekvést tartalmaz, ami nagymértékben kerülendő. </p><p>Egy érdekes példa a részfeladat-megosztás költségeire és előnyeire a fordítók optimalizálásánál fordul elő. Vegyük a tan(<span class="emphasis"><em>x</em></span>) – sin(<span class="emphasis"><em>x</em></span>) kifejezés fordításának problémáját. A legtöbb fordító ezt két külön szubrutin triviális összeolvasztásával éri el: a tan lépések a sin lépések előtt következnek. Vegyük azonban a sin és tan alábbi Taylor soros közelítéseit:</p><p><span class="inlinemediaobject"><img src="math/mi-12-0007.gif" alt="Elemzés"/></span></p><p>Egy részfeladat-megosztást tartalmazó HFH-tervkészítő sokkal hatékonyabb megoldásokat készíthet, mert a sin kiszámításának számos lépésére választhatja a tan meglévő lépéseit. A legtöbb fordító nem alkalmazza ezt a fajta procedúrák közötti megosztást, mert az összes lehetséges megosztott terv figyelembevétele túl sok időt venne igénybe. Ehelyett a legtöbb fordító minden résztervet függetlenül készít el, majd esetleg módosítja az eredményt egy <span class="strong"><strong>optimalizáló</strong></span> használatával.</p><p>A cselekvésdekompozíció által bevezetett járulékos bonyolítások tudatában miért hisszük mégis, hogy a HFH-tervkészítés hatékony lehet? A komplexitás valós forrásai a gyakorlatban nehezen analizálhatók, ezért vegyünk egy idealizált esetet. Tegyük fel például, hogy egy <span class="emphasis"><em>n</em></span> cselekvésből álló tervet akarunk létrehozni. Egy nemhierarchikus előrefelé haladó állapottér-tervező költsége, minden állapotban <span class="emphasis"><em>b</em></span> megengedett cselekvéssel, <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>b<sup>n</sup></em></span>). A HFH-tervkészítő esetén feltételezzünk egy nagyon általános dekompozíciós formát: minden nem elemi cselekvésnek, <span class="emphasis"><em>d</em></span> lehetséges dekompozíciója van, mindegyik a következő alacsonyabb szinten <span class="emphasis"><em>k</em></span> cselekvésből áll. Tudni szeretnénk, hogy ebben a struktúrában hány különböző dekompozíciós fa létezik. Ha a kiindulási szinten <span class="emphasis"><em>n</em></span> cselekvés van, akkor a gyökér alatti szintek száma log<span class="emphasis"><em><sub>k</sub>n</em></span>, így a belső dekompozíciós csomópontok száma 1 + <span class="emphasis"><em>k </em></span> + <span class="emphasis"><em>k<sup>2</sup></em></span> + … <span class="emphasis"><em>k</em></span><sup>log k n–1</sup> = (<span class="emphasis"><em>n </em></span>– 1)/(<span class="emphasis"><em>k</em></span> – 1). Minden belső csomópontnak <span class="emphasis"><em>d</em></span> lehetséges dekompozíciója van, így összesen <span class="emphasis"><em>d</em></span><sup>(<span class="emphasis"><em>n</em></span>–1)/(<span class="emphasis"><em>k</em></span>–1)<span class="emphasis"><em> </em></span></sup>lehetséges dekompozíciós fa alkotható. Ezt a képletet megvizsgálva láthatjuk, hogy <span class="emphasis"><em>d</em></span> alacsonyan tartása nagy <span class="emphasis"><em>k</em></span> mellett óriási megtakarításokat eredményezhet. Ha <span class="emphasis"><em>b</em></span> és <span class="emphasis"><em>d</em></span> összemérhető, akkor gyakorlatilag a nemhierarchikus költség <span class="emphasis"><em>k</em></span>-adik gyökét vesszük. Másrészről azonban egy kisszámú, de hosszú dekompozíciót tartalmazó tervkönyvtár megalkotása, bár lehetővé teszi bármely probléma megoldását, nem mindig lehetséges. Másképp mondva, a hosszú makrók, amelyek problémák széles körén alkalmazhatók, kiemelten értékesek.</p><p>Egy másik és talán jobb ok arra, hogy a HFH-tervkészítő hatékonyságában higgyünk, az, hogy a gyakorlatban működik. A nagyméretű alkalmazásokhoz használt tervkészítők majdnem mindegyike HFH-tervkészítő, mert a HFH-tervkészítés lehetőséget ad az emberi szakértő számára, hogy a komplex feladatok végrehajtásához szükséges elengedhetetlen tudást átadhassák, hogy a nagy tervek kicsi számítási ráfordítással elkészíthetők legyenek. Például a HFH-tervkészítést az ütemezéssel ötvöző O-<code class="code">PLAN</code>-t (Bell és Tate, 1985) arra használták, hogy a Hitachi számára készítsen gyártási terveket. Egy tipikus gyártási sor probléma 350 különböző terméket, 35 összeszerelő gépet és több mint 2000 különböző műveletet tartalmaz. A tervkészítő egy 30 napos ütemezést készít, naponta három 8 órás műszakkal és több millió lépéssel. </p><p>A HFH-tervkészítés kulcsa így egy tervkönyvtár megalkotása, amely a komplex magas szintű cselekvések megvalósításához tartalmazza az ismert módszereket. A könyvtár megalkotásának egyik módja, hogy a problémamegoldások tapasztalataiból <span class="emphasis"><em>tanuljunk</em></span> módszereket. Egy terv elkészítésének gyötrelmes tapasztalatai után az ágens elmentheti a tervet a könyvtárba mint egy a <span class="emphasis"><em>feladat (task)</em></span> által definiált magas szintű cselekvés megvalósítási módját. Ily módon az ágens egyre kifinomultabbá válik, ahogy a régi módszerekre alapozva új módszerek épülnek. Ennek a tanulási folyamatnak egyik fontos szempontja, hogy az elkészített módszereket <span class="emphasis"><em>általánosítani</em></span> tudja, a tervből csak a kulcslépéseket megtartva, azaz a probléma példányainak specifikus részleteit elhagyva (például az építő nevének és címének elhagyása a tervekről). Az ilyen általánosításra alkalmas módszereket a 19.<span class="emphasis"><em> </em></span>fejezetben mutatjuk be. Számunkra elképzelhetetlen, hogy hasonló mechanizmusok nélkül az emberek olyan kompetensek lehetnek, mint amilyenek.</p></div><div class="footnotes"><br/><hr/><div class="footnote"><p class="footnote text"><sup>[<a id="ftn.id654561" href="#id654561" class="para">119</a>] </sup> Ez néhány nem várt terv előállítását is megakadályozhatja. Például egy csődeljárás előtt álló személy minden ingó vagyonát eltüntetheti (a ¬<span class="emphasis"><em>Pénz</em></span> elérésével) egy ház megvásárlásával vagy megépítésével. Ez a terv hasznos, mert az aktuális törvény kizárja az elsődleges lakóhely hitelezők általi lefoglalását (legalábbis az USA-ban – <span class="emphasis"><em>a szerk.</em></span>).</p></div><div class="footnote"><p class="footnote text"><sup>[<a id="ftn.id654696" href="#id654696" class="para">120</a>] </sup> Az <span class="emphasis"><em>Építkezés</em></span> negálja az <span class="emphasis"><em>Engedély</em></span>-t, egyébként ugyanazon engedély több ház megépítéséhez is használható lenne. Sajnos az <span class="emphasis"><em>Építkezés</em></span> nem zárja le a <span class="emphasis"><em>Szerződés</em></span>-t, mert előbb a <span class="emphasis"><em>KivitelezőtKifizet</em></span>-et kell végrehajtanunk.</p></div><div class="footnote"><p><sup>[<a id="ftn.id655186" href="#id655186" class="para">121</a>] </sup> Vannak további apró módosítások a magas szintű cselekvések konfliktusfeloldásának kezelésére. Az érdeklődő olvasó ezeknek a fejezet végén hivatkozott irodalmakban nézhet utána.</p></div></div></div></body></html>
