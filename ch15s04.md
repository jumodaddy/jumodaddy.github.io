<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/></head><body><div class="section" title="Kalman-szűrők"><div class="titlepage"><div><div><h1 class="title"><a id="id695139"/>Kalman-szűrők</h1></div></div></div><p>Képzeljünk el egy kismadarat, amint a dzsungel sűrűjében repül szürkületkor: a mozgásának csupán rövid, szakaszos felvillanásait pillanthatjuk meg; minden igyekezetünkkel azt próbáljuk megjósolni, hogy hol van most a madár, és legközelebb hol fog felbukkanni, hogy nehogy szem elől tévesszük. Vagy képzeljük azt, hogy a második világháborúban radarkezelők vagyunk, egy gyenge, mozgó radarjelet kémlelve, ami 10 másodpercenként jelenik meg a képernyőn. Vagy, kissé még távolabbra visszalépve, képzeljük magunkat Kepler helyébe, ahogy a bolygók mozgását próbálja rekonstruálni igen pontatlan szögmérések sokaságából, amit rendszertelen és pontatlanul mért intervallumokban rögzítettek. Mindegyik esetben egy fizikai rendszer állapotát próbáljuk megbecsülni (helyet és sebességet például) időben egymást követő zajos megfigyelésekből. A problémát megfogalmazhatjuk egy időbeli valószínűségi modellben való következtetésként, ahol az állapotátmenet-modell a mozgás fizikáját írja le, az érzékelő modell pedig a mérési folyamatot. Ez a fejezet azokat a speciális reprezentációkat és következtetési algoritmusokat vizsgálja, amelyeket ilyen típusú problémákra fejlesztettek ki; a tárgyalt eljárást <span class="strong"><strong>Kalman-szűrés</strong></span>nek (<span class="strong"><strong>Kalman filtering</strong></span>) nevezik, a kidolgozója Rudolf E. Kalman<sup>[<a id="id695154" href="#ftn.id695154" class="footnote">159</a>]</sup> után.</p><p>Világos, hogy több <span class="emphasis"><em>folytonos</em></span> változóra lesz szükségünk a rendszer állapotának megadásához. Például a madár repülése megadható egy (<span class="emphasis"><em>X</em></span>, <span class="emphasis"><em>Y</em></span>, <span class="emphasis"><em>Z</em></span>) pozícióval és egy (<span class="emphasis"><em>X</em></span>,<span class="emphasis"><em> Y</em></span>,<span class="emphasis"><em> Z</em></span>) sebességgel minden egyes időpillanatban. Szükségünk lesz még alkalmas feltételes sűrűségfüggvényekre az állapotátmenet- és érzékelő modellekhez; a 14. fejezethez hasonlóan, <span class="strong"><strong>lineáris Gauss-eloszlás</strong></span>okat (<span class="strong"><strong>linear Gaussian</strong></span>) fogunk használni. Ez azt jelenti, hogy a következő <span class="strong"><strong>X</strong></span><sub><span class="emphasis"><em>t</em></span>+1</sub> állapot a jelenlegi <span class="strong"><strong>X</strong></span><sub>t</sub> állapot lineáris függvénye, amihez még egy Gauss-zaj adódik, amely feltétel a gyakorlatban igen elfogadhatónak bizonyul. Tekintsük például a madár <span class="emphasis"><em>X</em></span> koordinátáját, pillanatnyilag figyelmen kívül hagyva a többi koordinátát. Legyen a megfigyelések közötti intervallum Δ, és tételezzünk fel állandó sebességet; ekkor a pozíció frissítésére az adódik, hogy</p><p><span class="inlinemediaobject"><img src="math/mi-15-0019.gif" alt="Kalman-szűrők"/></span></p><p>Ha Gauss-zajt adunk hozzá, akkor egy lineáris Gauss-féle állapotátmenet-modellt kapunk:</p><p><span class="inlinemediaobject"><img src="math/mi-15-0020.gif" alt="Kalman-szűrők"/></span></p><p>Az <span class="strong"><strong>X</strong></span><sub>t</sub> pozíció és <span class="inlinemediaobject"><img src="math/mi-15-0021.gif" alt="Kalman-szűrők"/></span> sebességvektorok alkotta rendszerhez tartozó Bayes-hálóstruktúra a 15.7. ábrán látható. Vegyük észre, hogy ez a lineáris Gauss-modellnek egy nagyon speciális alakja; az általános alakot a fejezetben később írjuk le, ami alkalmazások nagyon széles körét fedi le az első bekezdés egyszerű mozgásos példáin túl. Az olvasónak hasznos lehet az A) függelékben átnézni a Gauss-eloszlások egyes matematikai tulajdonságait; a jelenlegi céljainkhoz a legfontosabb, hogy egy <span class="strong"><strong>többváltozós Gauss-eloszlás</strong></span>t (<span class="strong"><strong>multivariate Gaussian</strong></span>) <span class="emphasis"><em>d</em></span> változó esetén egy <span class="emphasis"><em>d</em></span> elemű <span class="emphasis"><em><span xml:lang="hu" class="bold"><strong>μ</strong></span></em></span> átlag és egy <span class="emphasis"><em>d</em></span> × <span class="emphasis"><em>d</em></span>-s <span xml:lang="hu" class="bold"><strong>Σ</strong></span> kovarianciamátrix ad meg.</p><div class="figure"><a id="id695294"/><p class="title"><strong>15.7. ábra - Egy <span class="strong">X</span><sub>t </sub>hely, <span class="inlinemediaobject"><img src="math/mi-15-0022.gif" alt="Egy Xt hely, sebesség és Zt helymegfigyelés alkotta lineáris dinamikus rendszerhez tartozó Bayes-hálóstruktúra"/></span><sub> </sub>sebesség és <span class="strong">Z</span><sub>t</sub> helymegfigyelés alkotta lineáris dinamikus rendszerhez tartozó Bayes-hálóstruktúra</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/15-07.png" alt="Egy Xt hely, sebesség és Zt helymegfigyelés alkotta lineáris dinamikus rendszerhez tartozó Bayes-hálóstruktúra"/></div></div></div><div class="section" title="Gauss-eloszlások frissítése"><div class="titlepage"><div><div><h2 class="title"><a id="id695328"/>Gauss-eloszlások frissítése</h2></div></div></div><p>A 14. fejezetben hivatkoztunk a lineáris Gauss-eloszlások családjának egy alaptulajdonságára: az eloszláscsalád zárt a standard Bayes-hálóbeli műveletekre. Most ezt az állítást pontosítjuk az időbeli valószínűségi modellben végzett szűrés esetére. A megkövetelt tulajdonságok megfelelnek a szűrés (15.3) egyenletben megadott kétlépéses számításának:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Ha a jelenlegi <span class="strong"><strong>P</strong></span>(<span class="strong"><strong>X</strong></span><sub>t</sub>|<span class="strong"><strong>e</strong></span><sub>1:<span class="emphasis"><em>t</em></span></sub>) eloszlás Gauss-eloszlás és a <span class="strong"><strong>P</strong></span>(<span class="strong"><strong>X</strong></span><sub><span class="emphasis"><em>t</em></span>+1</sub>|<span class="strong"><strong>x</strong></span><sub>t</sub>) állapotátmenet-modell lineáris Gauss-modell, akkor az egylépéses előrejelzés eloszlása </p></li></ol></div><p><span class="inlinemediaobject"><img src="math/mi-15-0023.gif" alt="Gauss-eloszlások frissítése"/></span></p><p>	szintén Gauss-eloszlás.</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Ha az előrejelzés <span class="strong"><strong>P</strong></span>(<span class="strong"><strong>X</strong></span><sub><span class="emphasis"><em>t</em></span>+1</sub>|<span class="strong"><strong>e</strong></span><sub>1:<span class="emphasis"><em>t</em></span></sub>) eloszlása Gauss-eloszlás és a <span class="strong"><strong>P</strong></span>(<span class="strong"><strong>e</strong></span><sub><span class="emphasis"><em>t</em></span>+1</sub>|<span class="strong"><strong>X</strong></span><sub><span class="emphasis"><em>t</em></span>+1</sub>) érzékelő modell lineáris Gauss-modell, akkor az új bizonyítékkal, mint feltétellel, a frissített eloszlás</p></li></ol></div><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">X</span></em><sub>t+1</sub>|<em><span class="remark">e</span></em><sub>1:t+1</sub>) = α<em><span class="remark">P</span></em>(<em><span class="remark">e</span></em><sub>t+1</sub>|<em><span class="remark">X</span></em><sub>t+1</sub>)<em><span class="remark">P</span></em>(<em><span class="remark">X</span></em><sub>t+1</sub>|<em><span class="remark">e</span></em><sub>1:t</sub>) 	(15.16)</code></p><p>szintén Gauss-eloszlás.</p><p>Így a Kalman-szűrés <code class="code">ELŐRE</code> művelete fogad egy <sub>t</sub> átlaggal és <sub>t</sub> kovarianciamátrixszal meghatározott <span class="strong"><strong>f</strong></span><sub>1:<span class="emphasis"><em>t</em></span></sub> Gauss előre üzenetet, és előállít egy új többváltozós <span class="strong"><strong>f</strong></span><sub><sub>1:<span class="emphasis"><em>t</em></span>+1</sub><span class="emphasis"><em> </em></span></sub>Gauss előre üzenetet <span class="emphasis"><em><span class="strong"><strong>μ</strong></span></em></span><sub><span class="emphasis"><em>t</em></span>+1</sub> átlaggal és <span class="strong"><strong>Σ</strong></span><sub><span class="emphasis"><em>t</em></span>+1</sub> kovarianciamátrixszal. Így, ha egy <span class="strong"><strong>f</strong></span><sub>1:0</sub>= <span class="strong"><strong>P</strong></span>(<span class="strong"><strong>X</strong></span><sub>0</sub>) = <span class="emphasis"><em>N</em></span>(<span class="emphasis"><em><span class="strong"><strong>μ</strong></span></em></span><sub>0</sub>, <span class="strong"><strong>Σ</strong></span><sub>0</sub>)<sub> </sub>Gauss-eloszlással indulunk, egy lineáris Gauss-modellel való szűrés az állapotokon Gauss-eloszlást eredményez minden időpontban.</p><div class="important" title="Fontos" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Fontos</h3><p>Ez tetszetős és elegáns eredménynek tűnik, de miért is olyan fontos? Ennek a magyarázata az, hogy a most tárgyalt esethez hasonló néhány speciális esetet kivéve, <span class="emphasis"><em>a szűrés folytonos vagy hibrid (diszkrét és folytonos) hálókkal olyan állapoteloszlásokat generál, amelyek reprezentációja az idővel korlátlanul nő</em></span>. Ezt az állítást általában nem könnyű bizonyítani, de a 15.5. feladat egy egyszerű példán mutatja be, hogy mi történik.</p></div></div><div class="section" title="Egy egyszerű egydimenziós példa"><div class="titlepage"><div><div><h2 class="title"><a id="id695612"/>Egy egyszerű egydimenziós példa</h2></div></div></div><p>Azt állítottuk, hogy a Kalman-szűrés <code class="code">ELŐRE</code> művelete egy Gauss-eloszlást egy új Gauss-eloszlásba visz át. Ez új átlag- és kovarianciamátrix kiszámítását jelenti az előző átlagból és kovarianciamátrixból. Az általános (többváltozós) eset frissítési szabályának származtatása igen sok lineáris algebrai lépést igényel, így egyelőre a nagyon egyszerű egyváltozós esetnél maradunk, és később adjuk meg az eredményeket az általános esetre. A számítások még az egyváltozós esetre is unalmasak kissé, de úgy érezzük, hogy érdemes látni őket, mivel a Kalman-szűrő hasznossága olyan szorosan kötődik a Gauss-eloszlások matematikai tulajdonságaihoz.</p><p>A tárgyalt időbeli modell egyetlen folytonos <span class="emphasis"><em>X<sub>t</sub></em></span> állapotváltozós <span class="strong"><strong>véletlen bolyongás</strong></span>t (<span class="strong"><strong>random walk</strong></span>) ír le egy zajos <span class="emphasis"><em>Z<sub>t </sub></em></span>megfigyeléssel. Egy példa lehet erre a „vásárlói bizalom” mutatója, amit modellezhetünk úgy, mint ami havonként egy véletlen Gauss-eloszlású változáson megy át, és amelyet egy véletlen vásárlói kérdőív mér fel, ami szintén Gauss-mintavételi zajt okoz. Az a priori eloszlást gaussinak tételezzük fel <span class="inlinemediaobject"><img src="math/mi-15-0024.gif" alt="Egy egyszerű egydimenziós példa"/></span> szórásnégyzettel:</p><p><span class="inlinemediaobject"><img src="math/mi-15-0025.gif" alt="Egy egyszerű egydimenziós példa"/></span></p><p>(Az egyszerűség kedvéért ebben a fejezetben ugyanazt az α szimbólumot fogjuk használni minden normalizációs állandó jelölésére.) Az állapotátmenet-modell egyszerűen a jelenlegi állapot egy Gauss-eloszlású módosítását jelenti állandó <span class="inlinemediaobject"><img src="math/mi-15-0026.gif" alt="Egy egyszerű egydimenziós példa"/></span> szórásnégyzettel:</p><p><span class="inlinemediaobject"><img src="math/mi-15-0027.gif" alt="Egy egyszerű egydimenziós példa"/></span></p><p>Az érzékelő modell egy Gauss-eloszlású zajt tételez fel <span class="inlinemediaobject"><img src="math/mi-15-0028.gif" alt="Egy egyszerű egydimenziós példa"/></span> szórásnégyzettel:</p><p><span class="inlinemediaobject"><img src="math/mi-15-0029.gif" alt="Egy egyszerű egydimenziós példa"/></span></p><p>Most, az a priori <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>X</em></span><sub>0</sub>) eloszlás ismeretében kiszámíthatjuk az egylépéses előrejelzés eloszlását felhasználva a (15.15) egyenletet:</p><p><span class="inlinemediaobject"><img src="math/mi-15-0030.gif" alt="Egy egyszerű egydimenziós példa"/></span></p><p>Az integrál igen bonyolultnak néz ki. A továbbhaladás lehetőségét annak észrevétele jelenti, hogy a kitevő két olyan kifejezés összege, amelyek négyzetesek x0-ban, és így az maga is négyzetes x0-ban. Egy egyszerű trükk, amit teljes négyzetté kiegészítésként (completing the square) ismerünk, lehetővé teszi bármely <span class="inlinemediaobject"><img src="math/mi-15-0031.gif" alt="Egy egyszerű egydimenziós példa"/></span><span class="emphasis"><em> </em></span>átírását egy <span class="inlinemediaobject"><img src="math/mi-15-0032.gif" alt="Egy egyszerű egydimenziós példa"/></span>  négyzetes tag és egy <span class="inlinemediaobject"><img src="math/mi-15-0033.gif" alt="Egy egyszerű egydimenziós példa"/></span> <span class="emphasis"><em>x</em></span><sub>0</sub>-tól független maradék tag összegévé. A maradék tag az integrálból kivihető, így azt kapjuk, hogy</p><p><span class="inlinemediaobject"><img src="math/mi-15-0034.gif" alt="Egy egyszerű egydimenziós példa"/></span></p><p>Most az integrál pontosan egy Gauss-eloszlás teljes tartomány feletti integrálja, ami egyszerűen 1-et ad. Így csupán a maradék tag maradt a négyzetesből.</p><p>A második kulcslépés annak észrevétele, hogy a maradék tagnak <span class="emphasis"><em>x</em></span><sub>1</sub><span class="emphasis"><em>-</em></span>ben négyzetesnek kell lennie; valóban, egyszerűsítés után azt kapjuk, hogy</p><p><span class="inlinemediaobject"><img src="math/mi-15-0035.gif" alt="Egy egyszerű egydimenziós példa"/></span></p><div class="figure"><a id="id695787"/><p class="title"><strong>15.8. ábra - A Kalman-szűrés frissítési ciklusának a lépései egy véletlen bolyongás esetén. A véletlen bolyongás a priori eloszlása <span xml:lang="hu" class="emphasis"><em>μ</em></span><sub>0 </sub>= 0,0 és σ<sub> 0 </sub>= 1,0, az átmenet bizonytalansága σ<sub> x </sub>= 2,0, az érzékelő bizonytalansága σ<sub> z </sub>= 1,0, az első megfigyelés pedig <span class="emphasis"><em>z</em></span><sub>1 </sub>= 2,5 (az <span class="emphasis"><em>x</em></span> tengelyen csillaggal jelölve).Vegyük észre, ahogy a <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>x</em></span><sub>1</sub>) előrejelzés ellapul a <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>x</em></span><sub>0</sub>)-hoz képest az átmenet bizonytalansága miatt. Vegyük azt is észre, hogy az a posteriori <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>x</em></span><sub>1</sub>|<span class="emphasis"><em>z</em></span><sub>1</sub>) kissé balra helyezkedik el a <span class="emphasis"><em>z</em></span><sub>1 </sub>megfigyeléstől, mivel az átlag az előrejelzés és a megfigyelés súlyozott átlaga.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/15-08.png" alt="A Kalman-szűrés frissítési ciklusának a lépései egy véletlen bolyongás esetén. A véletlen bolyongás a priori eloszlása μ0 = 0,0 és σ 0 = 1,0, az átmenet bizonytalansága σ x = 2,0, az érzékelő bizonytalansága σ z = 1,0, az első megfigyelés pedig z1 = 2,5 (az x tengelyen csillaggal jelölve).Vegyük észre, ahogy a P(x1) előrejelzés ellapul a P(x0)-hoz képest az átmenet bizonytalansága miatt. Vegyük azt is észre, hogy az a posteriori P(x1|z1) kissé balra helyezkedik el a z1 megfigyeléstől, mivel az átlag az előrejelzés és a megfigyelés súlyozott átlaga."/></div></div></div><p>Azaz az egylépéses előrejelzés eloszlása Gauss-eloszlás, ugyanazzal a <span xml:lang="hu" class="emphasis"><em>μ</em></span><sub>0</sub> átlaggal, a szórásnégyzet pedig egyenlő az eredeti <span class="inlinemediaobject"><img src="math/mi-15-0036.gif" alt="A Kalman-szűrés frissítési ciklusának a lépései egy véletlen bolyongás esetén. A véletlen bolyongás a priori eloszlása μ0 = 0,0 és σ 0 = 1,0, az átmenet bizonytalansága σ x = 2,0, az érzékelő bizonytalansága σ z = 1,0, az első megfigyelés pedig z1 = 2,5 (az x tengelyen csillaggal jelölve).Vegyük észre, ahogy a P(x1) előrejelzés ellapul a P(x0)-hoz képest az átmenet bizonytalansága miatt. Vegyük azt is észre, hogy az a posteriori P(x1|z1) kissé balra helyezkedik el a z1 megfigyeléstől, mivel az átlag az előrejelzés és a megfigyelés súlyozott átlaga."/></span> szórásnégyzetnek és az átmenet <span class="inlinemediaobject"><img src="math/mi-15-0037.gif" alt="A Kalman-szűrés frissítési ciklusának a lépései egy véletlen bolyongás esetén. A véletlen bolyongás a priori eloszlása μ0 = 0,0 és σ 0 = 1,0, az átmenet bizonytalansága σ x = 2,0, az érzékelő bizonytalansága σ z = 1,0, az első megfigyelés pedig z1 = 2,5 (az x tengelyen csillaggal jelölve).Vegyük észre, ahogy a P(x1) előrejelzés ellapul a P(x0)-hoz képest az átmenet bizonytalansága miatt. Vegyük azt is észre, hogy az a posteriori P(x1|z1) kissé balra helyezkedik el a z1 megfigyeléstől, mivel az átlag az előrejelzés és a megfigyelés súlyozott átlaga."/></span> szórásnégyzetének az összegével. Egy pillanatnyi belegondolás után ez szemléletesen is elfogadhatónak tűnik. </p><p>A frissítés lépésének befejezéséhez még szükséges, hogy az első időpontbeli megfigyelést, <span class="emphasis"><em>x</em></span><sub>1</sub>-t feltételként vegyük számításba. A (15.16) egyenletből erre az adódik, hogy</p><p><span class="inlinemediaobject"><img src="math/mi-15-0038.gif" alt="A Kalman-szűrés frissítési ciklusának a lépései egy véletlen bolyongás esetén. A véletlen bolyongás a priori eloszlása μ0 = 0,0 és σ 0 = 1,0, az átmenet bizonytalansága σ x = 2,0, az érzékelő bizonytalansága σ z = 1,0, az első megfigyelés pedig z1 = 2,5 (az x tengelyen csillaggal jelölve).Vegyük észre, ahogy a P(x1) előrejelzés ellapul a P(x0)-hoz képest az átmenet bizonytalansága miatt. Vegyük azt is észre, hogy az a posteriori P(x1|z1) kissé balra helyezkedik el a z1 megfigyeléstől, mivel az átlag az előrejelzés és a megfigyelés súlyozott átlaga."/></span></p><p>Most ismét kombináljuk a kitevőket, és négyzetté egészítsük ki (15.6 feladat), azt kapva, hogy</p><p><span class="inlinemediaobject"><img src="math/mi-15-0039.gif" alt="A Kalman-szűrés frissítési ciklusának a lépései egy véletlen bolyongás esetén. A véletlen bolyongás a priori eloszlása μ0 = 0,0 és σ 0 = 1,0, az átmenet bizonytalansága σ x = 2,0, az érzékelő bizonytalansága σ z = 1,0, az első megfigyelés pedig z1 = 2,5 (az x tengelyen csillaggal jelölve).Vegyük észre, ahogy a P(x1) előrejelzés ellapul a P(x0)-hoz képest az átmenet bizonytalansága miatt. Vegyük azt is észre, hogy az a posteriori P(x1|z1) kissé balra helyezkedik el a z1 megfigyeléstől, mivel az átlag az előrejelzés és a megfigyelés súlyozott átlaga."/></span></p><p>így egy frissítési ciklus után egy új Gauss-eloszlásunk van az állapotváltozóra.</p><p>A (15.17) egyenletben a Gauss-alakból láthatjuk, hogy az új átlag és szórás kiszámítható a régi átlagból és szórásból a következőképpen:</p><p><span class="inlinemediaobject"><img src="math/mi-15-0040.gif" alt="A Kalman-szűrés frissítési ciklusának a lépései egy véletlen bolyongás esetén. A véletlen bolyongás a priori eloszlása μ0 = 0,0 és σ 0 = 1,0, az átmenet bizonytalansága σ x = 2,0, az érzékelő bizonytalansága σ z = 1,0, az első megfigyelés pedig z1 = 2,5 (az x tengelyen csillaggal jelölve).Vegyük észre, ahogy a P(x1) előrejelzés ellapul a P(x0)-hoz képest az átmenet bizonytalansága miatt. Vegyük azt is észre, hogy az a posteriori P(x1|z1) kissé balra helyezkedik el a z1 megfigyeléstől, mivel az átlag az előrejelzés és a megfigyelés súlyozott átlaga."/></span></p><p>A 15.8. ábrán látható egy frissítési ciklus az állapotátmenet- és az érzékelő modell konkrét értékei esetén.</p><p>Az előző egyenletpár pontosan ugyanazt a szerepet játssza, mint az <span class="emphasis"><em>általános szűrés egyenlete </em></span>(15.3) vagy az <span class="emphasis"><em>RMM-szűrés egyenlete </em></span>(15.10). A Gauss-eloszlások speciális tulajdonsága miatt azonban az egyenleteknek van néhány további érdekes tulajdonsága. Először is, hogy az új <span class="emphasis"><em>μ</em></span><sub><span class="emphasis"><em>t</em></span>+1</sub> átlag kiszámítása értelmezhető úgy, mint egyszerűen az új <span class="emphasis"><em>z</em></span><sub><span class="emphasis"><em>t</em></span>+1</sub> megfigyelés és a régi <span class="emphasis"><em>μ<sub>t</sub></em></span> átlag <span class="emphasis"><em>súlyozott átlaga</em></span>. Ha a megfigyelés megbízhatatlan, akkor <span class="inlinemediaobject"><img src="math/mi-15-0041.gif" alt="A Kalman-szűrés frissítési ciklusának a lépései egy véletlen bolyongás esetén. A véletlen bolyongás a priori eloszlása μ0 = 0,0 és σ 0 = 1,0, az átmenet bizonytalansága σ x = 2,0, az érzékelő bizonytalansága σ z = 1,0, az első megfigyelés pedig z1 = 2,5 (az x tengelyen csillaggal jelölve).Vegyük észre, ahogy a P(x1) előrejelzés ellapul a P(x0)-hoz képest az átmenet bizonytalansága miatt. Vegyük azt is észre, hogy az a posteriori P(x1|z1) kissé balra helyezkedik el a z1 megfigyeléstől, mivel az átlag az előrejelzés és a megfigyelés súlyozott átlaga."/></span> nagy, és több figyelmet szentelünk a régi átlagnak; ha a régi átlag megbízhatatlan (<sub>t</sub><sup>2  </sup>nagy), vagy a folyamat nehezen megjósolható (<span class="inlinemediaobject"><img src="math/mi-15-0042.gif" alt="A Kalman-szűrés frissítési ciklusának a lépései egy véletlen bolyongás esetén. A véletlen bolyongás a priori eloszlása μ0 = 0,0 és σ 0 = 1,0, az átmenet bizonytalansága σ x = 2,0, az érzékelő bizonytalansága σ z = 1,0, az első megfigyelés pedig z1 = 2,5 (az x tengelyen csillaggal jelölve).Vegyük észre, ahogy a P(x1) előrejelzés ellapul a P(x0)-hoz képest az átmenet bizonytalansága miatt. Vegyük azt is észre, hogy az a posteriori P(x1|z1) kissé balra helyezkedik el a z1 megfigyeléstől, mivel az átlag az előrejelzés és a megfigyelés súlyozott átlaga."/></span> nagy), akkor több figyelmet szentelünk a megfigyelésnek. Másodszor, vegyük észre, hogy a <span class="inlinemediaobject"><img src="math/mi-15-0043.gif" alt="A Kalman-szűrés frissítési ciklusának a lépései egy véletlen bolyongás esetén. A véletlen bolyongás a priori eloszlása μ0 = 0,0 és σ 0 = 1,0, az átmenet bizonytalansága σ x = 2,0, az érzékelő bizonytalansága σ z = 1,0, az első megfigyelés pedig z1 = 2,5 (az x tengelyen csillaggal jelölve).Vegyük észre, ahogy a P(x1) előrejelzés ellapul a P(x0)-hoz képest az átmenet bizonytalansága miatt. Vegyük azt is észre, hogy az a posteriori P(x1|z1) kissé balra helyezkedik el a z1 megfigyeléstől, mivel az átlag az előrejelzés és a megfigyelés súlyozott átlaga."/></span> szórásnégyzet frissítése <span class="emphasis"><em>független a megfigyeléstől</em></span>. Ezért előre kiszámíthatjuk, hogy mi lesz a szórásnégyzetértékek sorozata. Harmadszor, a szórásnégyzetértékek sorozata gyorsan konvergál egy adott értékhez, ami csak <span class="inlinemediaobject"><img src="math/mi-15-0044.gif" alt="A Kalman-szűrés frissítési ciklusának a lépései egy véletlen bolyongás esetén. A véletlen bolyongás a priori eloszlása μ0 = 0,0 és σ 0 = 1,0, az átmenet bizonytalansága σ x = 2,0, az érzékelő bizonytalansága σ z = 1,0, az első megfigyelés pedig z1 = 2,5 (az x tengelyen csillaggal jelölve).Vegyük észre, ahogy a P(x1) előrejelzés ellapul a P(x0)-hoz képest az átmenet bizonytalansága miatt. Vegyük azt is észre, hogy az a posteriori P(x1|z1) kissé balra helyezkedik el a z1 megfigyeléstől, mivel az átlag az előrejelzés és a megfigyelés súlyozott átlaga."/></span> -től és <span class="inlinemediaobject"><img src="math/mi-15-0045.gif" alt="A Kalman-szűrés frissítési ciklusának a lépései egy véletlen bolyongás esetén. A véletlen bolyongás a priori eloszlása μ0 = 0,0 és σ 0 = 1,0, az átmenet bizonytalansága σ x = 2,0, az érzékelő bizonytalansága σ z = 1,0, az első megfigyelés pedig z1 = 2,5 (az x tengelyen csillaggal jelölve).Vegyük észre, ahogy a P(x1) előrejelzés ellapul a P(x0)-hoz képest az átmenet bizonytalansága miatt. Vegyük azt is észre, hogy az a posteriori P(x1|z1) kissé balra helyezkedik el a z1 megfigyeléstől, mivel az átlag az előrejelzés és a megfigyelés súlyozott átlaga."/></span>-től függ, ezáltal lényegesen egyszerűsítve az elkövetkező számításokat (lásd 15.7. feladat).</p></div><div class="section" title="Az általános eset"><div class="titlepage"><div><div><h2 class="title"><a id="id696029"/>Az általános eset</h2></div></div></div><p>Az előző levezetés szemléletesen bemutatta a Gauss-eloszlásoknak azt az alaptulajdonságát, ami a Kalman-szűrés működését lehetővé teszi: azt a tényt, hogy az exponens négyzetes alakú. Ez nem csak az egyváltozós esetre igaz; a teljes többváltozós Gauss-eloszlás alakja:</p><p><span class="inlinemediaobject"><img src="math/mi-15-0046.gif" alt="Az általános eset"/></span></p><p>A kitevőben lévő tényezők összeszorzása láthatóvá teszi, hogy a kitevő is négyzetes függvénye az <span class="strong"><strong>x</strong></span>-ben lévő <span class="emphasis"><em>x<sub>i</sub></em></span> valószínűségi változóknak. Ahogy az egyváltozós esetben, a szűrési frissítés megőrzi az állapoteloszlás gaussi voltát.</p><p>Elsőként definiáljuk a Kalman-szűrésnél használt általános időbeli modellt. Mind az állapotátmenet-modell, mind az érzékelő modell lineáris transzformációt enged meg additív Gauss-zajjal. Így azt kapjuk, hogy</p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">x</span></em><sub><em><span class="remark">t+</span></em>1</sub>|<em><span class="remark">x</span></em><sub>t</sub>) = <em><span class="remark">N</span></em>(<em><span class="remark">Fx</span></em><sub>t</sub>, <em><span class="remark">Σ</span></em><sub>x</sub>)(<em><span class="remark">x</span></em><sub><em><span class="remark">t</span></em>+1</sub>)</code></p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">z</span></em><sub>t</sub>|<em><span class="remark">x</span></em><sub>t</sub>) = <em><span class="remark">N</span></em>(<em><span class="remark">Hx</span></em><sub>t</sub>, <em><span class="remark">Σ</span></em><sub>z</sub>)(<em><span class="remark">z</span></em><sub>t</sub>)										(15.19)</code></p><p>ahol az <span class="strong"><strong>F </strong></span>és a <span class="strong"><strong>Σ</strong></span><sub>x</sub> mátrixok a lineáris állapotátmenet-modellt és az átmeneti zaj kovarianciáját írják le, a <span class="strong"><strong>H </strong></span>és a <span class="strong"><strong>Σ</strong></span><sub>z</sub> pedig az érzékelő modell megfelelő mátrixai. Ekkor az átlag és a kovariancia frissítésének az egyenletei a maguk rémisztő valóságában:</p><p><code class="code"><em><span class="remark"><em><span class="remark">μ</span></em><sub>t</sub></span></em><sub>+1</sub> = <em><span class="remark">F<em><span class="remark">μ</span></em><sub>t</sub></span></em> + <em><span class="remark">K</span></em><sub><em><span class="remark">t</span></em>+1</sub>(<em><span class="remark">z</span></em><sub><em><span class="remark">t</span></em>+1</sub> – <em><span class="remark">HF<em><span class="remark">μ</span></em><sub>t</sub></span></em>)</code></p><p><code class="code"><em><span class="remark">Σ</span></em><sub><em><span class="remark">t</span></em>+1</sub> = (<em><span class="remark">I</span></em> – <em><span class="remark">K</span></em><sub><em><span class="remark">t</span></em>+1</sub>)(<em><span class="remark">FΣ</span></em><sub>t</sub><em><span class="remark">F</span></em><sup>⊤</sup> + <em><span class="remark">Σ</span></em><sub>x</sub>)									(15.20)</code></p><p>ahol a <span class="strong"><strong>K</strong></span><sub><span class="emphasis"><em>t</em></span>+1</sub> = (<span class="strong"><strong>FΣ</strong></span><sub>t</sub><span class="strong"><strong>F</strong></span><sup>⊤</sup> + <span class="strong"><strong>Σ</strong></span><sub>x</sub>)<span class="strong"><strong>H</strong></span><sup>⊤</sup>(<span class="strong"><strong>H</strong></span>(<span class="strong"><strong>FΣ</strong></span><sub>t</sub><span class="strong"><strong>F</strong></span><sup>⊤ </sup>+ <span class="strong"><strong>Σ</strong></span><sub>x</sub>)<span class="strong"><strong>H</strong></span><sup>⊤ </sup>+ <span class="strong"><strong>Σ</strong></span><sub>z</sub>)<sup>-1</sup> mennyiség neve a <span class="strong"><strong>Kalman-erősítésmátrix</strong></span> (<span class="strong"><strong>Kalman gain matrix</strong></span>). Akár hihető, akár nem, ezeknek az egyenleteknek lehetséges egy szemléletes értelmezése. Például, gondoljuk meg a <span class="emphasis"><em><span class="strong"><strong>μ</strong></span></em></span> állapotátlag-becslés frissítését. Az <span class="bold"><strong>F<span class="strong"><strong>μ</strong></span><sub>t </sub></strong></span>tag a <span class="emphasis"><em>t</em></span>+1 időpontban előre jelzett állapot, így <span class="bold"><strong>HF<span class="strong"><strong>μ</strong></span><sub>t </sub></strong></span>az előre jelzett megfigyelés. Ezért a <span class="strong"><strong>z</strong></span><sub><span class="emphasis"><em>t</em></span>+1</sub> – <span class="bold"><strong>HF<span class="strong"><strong>μ</strong></span><sub>t </sub></strong></span> tag az előre jelzett megfigyelés hibáját reprezentálja. Ez van megszorozva a <span class="strong"><strong>K</strong></span><sub><span class="emphasis"><em>t</em></span>+1</sub> tényezővel az előre jelzett állapot korrigálásához; így a <span class="strong"><strong>K</strong></span><sub><span class="emphasis"><em>t</em></span>+1</sub> annak mértéke, hogy mennyire kell figyelembe venni az új megfigyelést az előrejelzéshez képest. Ahogyan a (15.18) egyenletben, az a tulajdonság most is fennáll, hogy a szórásnégyzet frissítése független a megfigyeléstől. A <span class="strong"><strong>Σ</strong></span><sub>t</sub><span class="strong"><strong> </strong></span>és a <span class="strong"><strong>K</strong></span><sub>t</sub> értékek sorozata ezért előre (offline) is kiszámolható, és a követés közben szükséges konkrét számítások igen mérsékeltek.</p><p>Hogy bemutassuk az egyenletek működését egy <span class="emphasis"><em>X</em></span>–<span class="emphasis"><em>Y</em></span> síkon mozgó tárgy követésének a problémájára alkalmaztuk őket. Az állapotváltozók az <span class="inlinemediaobject"><img src="math/mi-15-0047.gif" alt="Az általános eset"/></span>, így az <span class="strong"><strong>F</strong></span>,<span class="strong"><strong> </strong></span><span class="strong"><strong>Σ</strong></span><sub>x</sub>,<span class="strong"><strong> </strong></span><span class="strong"><strong>H</strong></span> és<span class="strong"><strong> Σ</strong></span><sub> z</sub> 4 × 4-es mátrixok. A 15.9. (a) ábrán látható az igazi pályagörbe, a zajos megfigyelések sorozata és a Kalman-szűréssel becsült pályagörbe végig a kovarianciával, amit az egységnyi szórás méretű körvonalak jeleznek. A szűrési folyamat jól teljesít az aktuális mozgás követésében, és ahogy várható, a szórásnégyzet gyorsan beáll egy rögzített értékre.</p><p>Ahogyan szűrésre, úgy <span class="emphasis"><em>simításra</em></span> is származtathatók egyenletek lineáris Gauss-modell esetén. A simítás eredményei a 15.9. (b) ábrán láthatók. Vegyük észre, hogy a helyzetbecslés szórásnégyzete gyorsan lecsökken, a pályagörbe végét leszámítva (itt miért nem?), és hogy a simítással becsült pályagörbe sokkal egyenletesebb.</p><div class="figure"><a id="id696491"/><p class="title"><strong>15.9. ábra - (a) A Kalman-szűrés eredménye egy<span class="emphasis"><em> X–Y </em></span>síkon mozgó objektumnál, feltüntetve a valódi (balról jobbra haladó) pályagörbét, a zajos megfigyelések egy sorozatát és a Kalman-szűrés alapján becsült pályagörbét. A helybecslések szórásait az oválisok jelzik. (b) A Kalman-simítás eredménye ugyanarra a megfigyelési sorozatra.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/15-09.png" alt="(a) A Kalman-szűrés eredménye egy X–Y síkon mozgó objektumnál, feltüntetve a valódi (balról jobbra haladó) pályagörbét, a zajos megfigyelések egy sorozatát és a Kalman-szűrés alapján becsült pályagörbét. A helybecslések szórásait az oválisok jelzik. (b) A Kalman-simítás eredménye ugyanarra a megfigyelési sorozatra."/></div></div></div></div><div class="section" title="A Kalman-szűrés alkalmazhatósága"><div class="titlepage"><div><div><h2 class="title"><a id="id696504"/>A Kalman-szűrés alkalmazhatósága</h2></div></div></div><p>A Kalman-szűrést és kiterjesztéseit alkalmazások széles körében használják. A „klaszszikus” alkalmazás légi járművek és rakéták radar követése. Kapcsolódó alkalmazások között van a tengeralattjárók és földi járművek akusztikai követése, és járművek és emberek képi követése. Egy kissé elvontabb szemlélettel a Kalman-szűrőket részecskék buborékkamrás pályagörbéjének rekonstrukciójára, valamint óceáni áramlások felszíni műholdképek alapján történő rekonstrukciójára használják. Az alkalmazások köre sokkal szélesebb, mint csupán mozgások követése: bármely rendszerre alkalmazható, ami folytonos állapotváltozókkal és zajos megfigyelésekkel jellemezhető. Ilyen rendszerek magukban foglalnak zúzdákat, vegyi üzemeket, nukleáris reaktorokat, növényi ökoszisztémákat és nemzetgazdaságokat.</p><p>A Kalman-szűrés alkalmazhatóságának ténye egy rendszerre nem jelenti, hogy az eredmények érvényesek vagy hasznosak lesznek. A feltevések – lineáris Gauss-féle állapotátmenet-modell és érzékelő modell – igen erősek. A <span class="strong"><strong>kiterjesztett Kalman-szűrő</strong></span> (<span class="strong"><strong>KKSZ</strong></span>) (<span class="strong"><strong>extended Kalman filter</strong></span>, <span class="strong"><strong>EKF</strong></span>) megpróbál úrrá lenni a modellezett rendszer nemlineáris tulajdonságain. Egy rendszer nemlineáris, ha az állapotátmenet-modell nem írható le, mint az állapotvektor mátrixszorzata, ahogyan ez a (15.19) egyenletben<span class="emphasis"><em> </em></span>szerepel. A KKSZ úgy működik, hogy rendszert <span class="strong"><strong>x</strong></span><sub>t</sub>-ben<span class="emphasis"><em> lokálisan</em></span> lineárisként modellezi az <span class="bold"><strong>x<sub>t</sub> </strong></span>= <span class="emphasis"><em><span class="strong"><strong>μ</strong></span><sub>t</sub></em></span> környezetében, ahol <span class="emphasis"><em><span class="strong"><strong>μ</strong></span><sub>t</sub></em></span> a jelenlegi állapoteloszlás átlaga. Ez jól működik „sima”, „jó magaviseletű” rendszereknél, és lehetővé teszi a követőnek, hogy egy olyan Gauss-állapoteloszlást tartson nyilván és frissítsen, ami elfogadható közelítése az igazi a posteriori eloszlásnak.</p><p>Azonban mit is jelent, hogy egy rendszer „nem sima” vagy „rossz magaviseletű”? Technikailag ez azt jelenti, hogy jelentős nemlinearitás van jelen a rendszer viselkedésében abban a régióban, ami „közel” van a jelenlegi <span class="emphasis"><em><span xml:lang="hu" class="bold"><strong>μ</strong></span><sub>t</sub></em></span> átlaghoz (a <span xml:lang="hu" class="bold"><strong>Σ</strong></span><sub>t </sub>kovarianciamátrix szerint). Ennek a tulajdonságnak a nem technikai megértéséhez gondoljunk arra a példára, amikor egy dzsungelben szálló madár követésével próbálkoztunk. A madár nagy sebességgel egyenesen egy fatörzs felé tart. A Kalman-szűrő, akár reguláris, akár kiterjesztett a madár pozíciójára, csak Gauss-előrejelzést adhat, és ennek a Gaussnak az átlaga a fatörzs közepére esik, ahogyan a 15.10. (a) ábrán látható. A madár egy elfogadható modellje azonban egy elkerülő műveletet jelezne előre egyik vagy másik oldalra, ahogy az a 15.10. (b) ábrán látható. Egy ilyen modell erősen nemlineáris, mivel a madár döntése nagyon eltérő a fatörzshöz vett pontos pozíciójának függvényében. </p><div class="figure"><a id="id696594"/><p class="title"><strong>15.10. ábra - Egy fa felé repülő madár (felülnézetben). (a) Egy Kalman-szűrő előrejelzése a madár helyzetére, ami egyetlen Gauss-eloszlás az akadály közepére illesztve. (b) Egy valósághűbb modell számításba veszi a madár elkerülő manővereit, és azt jelzi előre, hogy az egyik vagy a másik oldalon fog elszállni.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/15-10.png" alt="Egy fa felé repülő madár (felülnézetben). (a) Egy Kalman-szűrő előrejelzése a madár helyzetére, ami egyetlen Gauss-eloszlás az akadály közepére illesztve. (b) Egy valósághűbb modell számításba veszi a madár elkerülő manővereit, és azt jelzi előre, hogy az egyik vagy a másik oldalon fog elszállni."/></div></div></div><p class="Tartalom3">Ilyen példák kezeléséhez nyilvánvalóan egy kifejezőbb nyelvre van szükségünk a modellezett rendszer viselkedésének a reprezentálásához. A szabályozáselmélet területén, ahol olyan problémák, mint például egy repülőgép elkerülő manőverezése ugyanilyen típusú bonyodalmakat vetnek fel, a megszokott megoldás a <span class="strong"><strong>váltó Kalman-szűrő</strong></span> (<span class="strong"><strong>switching Kalman filter</strong></span>). Ebben a megközelítésben, több Kalman-szűrő fut párhuzamosan, mindegyik a rendszer különböző modelljét használva – például egy az egyenes repülésre, egy az éles balra fordulásra és egy az éles jobbra fordulásra. Az előrejelzéseknek egy súlyozott összegét használjuk, ahol a súly attól függ, hogy mennyire illeszkednek az egyes szűrők az aktuális adatokhoz. A következő fejezetben látni fogjuk, hogy ez egyszerűen az általános dinamikus Bayes-háló modell egy speciális esete, amit a 15.7. ábrán látható hálóból egy diszkrét „manőver” állapotváltozó hozzáadásával nyerünk. A váltó Kalman-szűrőket a 15.5. feladat tárgyalja tovább.</p></div><div class="footnotes"><br/><hr/><div class="footnote"><p class="footnote text"><sup>[<a id="ftn.id695154" href="#id695154" class="para">159</a>] </sup> Rudolf E. Kalman (Kálmán Rudolf) magyar származású matematikus.</p></div></div></div></body></html>
