<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/></head><body><div class="section" title="Egzakt következtetés Bayes-hálókban"><div class="titlepage"><div><div><h1 class="title"><a id="id676991"/>Egzakt következtetés Bayes-hálókban</h1></div></div></div><p class="Tartalom3">Az alapvető feladat bármely valószínűségi következtető rendszer számára az, hogy kiszámítsa a <span class="strong"><strong>célváltozó</strong></span>k (<span class="strong"><strong>query variable</strong></span>s) egy halmazának a posteriori valószínűség-eloszlását egy adott megfigyelt <span class="strong"><strong>esemény</strong></span> (<span class="strong"><strong>event</strong></span>) esetén – azaz <span class="strong"><strong>bizonyítékváltozó</strong></span>k (<span class="strong"><strong>evidence variable</strong></span>s) egy halmazához történő érték-hozzárendelés esetén. A 13. fejezetben bevezetett jelölést fogjuk használni: <span class="emphasis"><em>X</em></span> a célváltozót jelöli; <span class="strong"><strong>E</strong></span> a bizonyítékváltozók <span class="emphasis"><em>E</em></span><sub>1</sub>, …, <span class="emphasis"><em>E<sub>m</sub></em></span> halmazát, <span class="strong"><strong>e</strong></span> pedig a megfigyelt eseményt; <span class="strong"><strong>Y</strong></span> fogja jelölni az (olykor <span class="strong"><strong>rejtett változó</strong></span>knak (<span class="strong"><strong>hidden variable</strong></span>s) nevezett) nem-bizonyítékváltozók <span class="emphasis"><em>Y</em></span><sub>1</sub>, …, <span class="emphasis"><em>Y<sub>k</sub></em></span> halmazát. Így a változók teljes halmaza <span class="strong"><strong>X</strong></span> = {<span class="emphasis"><em>X</em></span>} ∪ <span class="strong"><strong>E</strong></span> ∪ <span class="strong"><strong>Y</strong></span>. Egy jellemző lekérdezés a <span class="strong"><strong>P</strong></span>(<span class="emphasis"><em>X</em></span>∣<span class="strong"><strong>e</strong></span>) a posteriori eloszlásra irányul.<sup>[<a id="id677112" href="#ftn.id677112" class="footnote">148</a>]</sup></p><p>A riasztós hálóban például megfigyelhetnénk azt az eseményt, ahol <span class="emphasis"><em>JánosTelefonál </em></span>= <span class="emphasis"><em>igaz</em></span> és <span class="emphasis"><em>MáriaTelefonál</em></span> = <span class="emphasis"><em>igaz</em></span>. Ekkor megkérdezhetnénk mondjuk a betörés megtörténtének a valószínűségét:</p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">Betörés</span></em>∣<em><span class="remark">JánosTelefonál</span></em> = <em><span class="remark">igaz</span></em>, <em><span class="remark">MáriaTelefonál</span></em> = <em><span class="remark">igaz</span></em>) = 〈0,284, 0,716〉</code></p><p>Ebben a fejezetben az a posteriori valószínűségek kiszámítására szolgáló egzakt algoritmusokat tárgyalunk, és átgondoljuk ennek a feladatnak a komplexitását. Kiderül, hogy általános esetben ez kivitelezhetetlen, ezért a 14.5. alfejezet közelítő következtetési módszereket ismertet.</p><div class="section" title="Következtetés felsorolással"><div class="titlepage"><div><div><h2 class="title"><a id="id677164"/>Következtetés felsorolással</h2></div></div></div><p class="Tartalom3">A 13. fejezet elmagyarázta, hogy bármely feltételes valószínűség kiszámítható a teljes együttes eloszlás tagjainak összegzésével. Pontosabban, egy <span class="strong"><strong>P</strong></span>(<span class="emphasis"><em>X</em></span>∣<span class="strong"><strong>e</strong></span>) lekérdezés megválaszolható a (13.6) egyenlet felhasználásával, amit a jobb követhetőség kedvéért itt megismétlünk:</p><p><span class="inlinemediaobject"><img src="math/mi-14-0006.gif" alt="Következtetés felsorolással"/></span></p><div class="important" title="Fontos" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Fontos</h3><p>Továbbá, mint ismeretes, a Bayes-háló a teljes együttes eloszlás egy teljes reprezentációját nyújtja. Még pontosabban, a (14.1) egyenlet azt mutatja, hogy az együttes eloszlás <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>x</em></span>,<span class="strong"><strong> e</strong></span>,<span class="strong"><strong> y</strong></span>) tagjai felírhatók a hálóból származó feltételes valószínűségek szorzataiként. Ezért <span class="emphasis"><em>egy lekérdezés megválaszolható a Bayes-háló felhasználásával, kiszámítva a hálóból származó feltételes valószínűségek szorzatainak az összegét</em></span>.</p></div><p>A 13.4. ábrán a <code class="code">FELSOROL-EGYÜTTES-KÉRDEZÉS</code> algoritmust adtuk meg a teljes együttes eloszlásból felsorolással történő következtetésre. Az algoritmus bemenetként fogadja a <span class="strong"><strong>P</strong></span> teljes együttes eloszlást, és értékeket néz meg benne. Egyszerű módosítással elérhető, hogy az algoritmus egy <span class="emphasis"><em>bn</em></span> Bayes-hálót fogad bemenetként, és az együttes bejegyzéseket a <span class="emphasis"><em>bn</em></span> megfelelő FVT-bejegyzéseinek összeszorzásával „nézi meg”.</p><p>Vegyük a <span class="strong"><strong>P</strong></span>(<span class="emphasis"><em>Betörés</em></span>∣<span class="emphasis"><em>JánosTelefonál</em></span> = <span class="emphasis"><em>igaz</em></span>, <span class="emphasis"><em>MáriaTelefonál</em></span> = <span class="emphasis"><em>igaz</em></span>) lekérdezést. A rejtett változók ennél a kérdésnél a <span class="emphasis"><em>Földrengés</em></span> és a <span class="emphasis"><em>Riasztás</em></span>. A (13.6) egyenletből, a kifejezések rövidítése miatt a kezdőbetűket használva, azt kapjuk, hogy<sup>[<a id="id677269" href="#ftn.id677269" class="footnote">149</a>]</sup> </p><p><span class="inlinemediaobject"><img src="math/mi-14-0007.gif" alt="Következtetés felsorolással"/></span></p><p>A Bayes-hálók szemantikája – (14.1) egyenlet – pedig az FVT-bejegyzések felhasználásával egy kifejezést ad. Az egyszerűség kedvéért ezt csak a <span class="emphasis"><em>Betörés</em></span> = <span class="emphasis"><em>igaz</em></span> esetére adjuk meg:</p><p><span class="inlinemediaobject"><img src="math/mi-14-0008.gif" alt="Következtetés felsorolással"/></span></p><p>Ennek a kifejezésnek a kiszámításához négy tagot kell összeadnunk, amelyek mindegyikét öt szám összeszorzásával kapjuk. Legrosszabb esetben, amikor majdnem minden változó felett összegezni kell, az algoritmus komplexitása egy <span class="emphasis"><em>n</em></span> bináris változós háló esetén <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>n</em></span>2<sup>n</sup>).</p><p>A következő egyszerű megfigyeléssel egy javításhoz juthatunk: a <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>b</em></span>) tag állandó, és ki lehet vinni az <span class="emphasis"><em>a</em></span> és <span class="emphasis"><em>e</em></span> feletti összegzések elé, a <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>e</em></span>) tag pedig kivihető az <span class="emphasis"><em>a</em></span> feletti összegzés elé. Így azt kapjuk, hogy</p><p><span class="inlinemediaobject"><img src="math/mi-14-0009.gif" alt="Következtetés felsorolással"/></span></p><div class="figure"><a id="id677405"/><p class="title"><strong>14.8. ábra - A (14.3) egyenletben szereplő kifejezés struktúrája. A kiértékelés fentről lefelé halad, összeszorozva az értékeket az egyes útvonalak mentén, és összegezve a „+” csomópontoknál. Vegyük észre, a <span class="emphasis"><em>j</em></span>-hez és az <span class="emphasis"><em>m</em></span>-hez tartozó útvonalak megismétlődését.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/14-08.png" alt="A (14.3) egyenletben szereplő kifejezés struktúrája. A kiértékelés fentről lefelé halad, összeszorozva az értékeket az egyes útvonalak mentén, és összegezve a „+” csomópontoknál. Vegyük észre, a j-hez és az m-hez tartozó útvonalak megismétlődését."/></div></div></div><p>Ez a kifejezés egy ciklussal értékelhető ki, sorban végighaladva a változókon, miközben összeszorozzuk az FVT-bejegyzéseket. Minden összegzésnél, a változó lehetséges értékei szerint is iterálnunk kell. A számítás struktúráját a 14.8. ábra mutatja. Felhasználva a 14.2. ábra értékeit, azt kapjuk hogy <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>b</em></span>∣<span class="emphasis"><em>j</em></span>,<span class="emphasis"><em>m</em></span>) = <span class="emphasis"><em>α</em></span> × 0,00059224. A ¬<span class="emphasis"><em>b</em></span>-hez tartozó számítást átfutva az <span class="emphasis"><em>α</em></span> × 0,0014919-et eredményez; így</p><div class="figure"><a id="id677449"/><p class="title"><strong>14.9. ábra - A felsoroló algoritmus Bayes-hálós lekérdezések megválaszolására</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/14-09.png" alt="A felsoroló algoritmus Bayes-hálós lekérdezések megválaszolására"/></div></div></div><p class="Tartalom3"><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">B</span></em>∣<em><span class="remark">j</span></em>,<em><span class="remark">m</span></em>) = <em><span class="remark">α</span></em> 〈0,00059224, 0,0014919〉 ≈ 〈0,284, 0,716〉</code></p><p>Azaz a betörés valószínűsége, ha mindkét szomszéd telefonál körülbelül 28%.</p><p>A 14.8. ábra a (14.3) egyenlet kiértékelési folyamatát mutatja, kifejezés fa alakban. A <code class="code">FELSOROL-KÉRDEZ</code> algoritmus a 14.9. ábrán ilyen fákat mélységi rekurzióval értékel ki. Így a <code class="code">FELSOROL-KÉRDEZ</code> tárkomplexitása csak lineáris a változók számában – az algoritmus így hatékonyan, anélkül összegez a teljes együttes eloszlás felett, hogy azt explicit módon megkonstruálná. Sajnos az algoritmus időkomplexitása egy <span class="emphasis"><em>n</em></span> bináris változós hálónál minden esetben <span class="emphasis"><em>O</em></span>(2<sup>n</sup>) – ami jobb, mint az egyszerű megközelítéshez tartozó <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>n</em></span>2<sup>n</sup>), de még mindig elég nyomasztó. Egy figyelemre méltó dolog a 14.8. ábra fájával kapcsolatban, hogy nyilvánvalóvá teszi a <span class="emphasis"><em>megismételt alkifejezéseket,</em></span> amelyeket az algoritmus kiértékel. A <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>j</em></span>∣<span class="emphasis"><em>a</em></span>) <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>m</em></span>∣<span class="emphasis"><em>a</em></span>) és a <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>j</em></span>∣¬<span class="emphasis"><em>a</em></span>) <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>m</em></span>∣¬<span class="emphasis"><em>a</em></span>) szorzatok kétszer kerülnek kiszámításra, <span class="emphasis"><em>e</em></span> minden értékénél. A következő fejezet egy általános módszert ír le, ami elkerüli az ilyen felesleges újraszámítások elvégzését.</p></div><div class="section" title="A változó eliminációs algoritmus"><div class="titlepage"><div><div><h2 class="title"><a id="id677566"/>A változó eliminációs algoritmus</h2></div></div></div><p class="Tartalom3">A felsoroló algoritmus lényegesen javítható a 14.8. ábra által szemléltetett ismétlődő számítások kiküszöbölésével. Az ötlet egyszerű: egyszer végezzük el a számítást, és őrizzük meg az eredményeket későbbi használatra. Ez egyfajta dinamikus programozás. Ennek a megközelítésnek több változata is létezik; mi a legegyszerűbbet, a <span class="strong"><strong>változó elimináció</strong></span>s (<span class="strong"><strong>variable elimination</strong></span>) algoritmust mutatjuk be. A változó eliminálás a (14.3) egyenlet típusú kifejezéseket <span class="emphasis"><em>jobbról balra</em></span> (azaz a 14.8. ábrán<span class="emphasis"><em> lentről felfelé</em></span>) sorrendben értékeli ki. A köztes eredményeket eltároljuk, és bármely változó feletti összegzés a kifejezésnek csak azon része felett történik meg, amely függ ettől a változótól.</p><p>Szemléltessük ezt a folyamatot a betörés háló esetén. Értékeljük ki a következő kifejezést:</p><p><span class="inlinemediaobject"><img src="math/mi-14-0010.gif" alt="A változó eliminációs algoritmus"/></span></p><p>Vegyük észre, hogy a kifejezés minden részét megjelöltük a kapcsolódó változó nevével; ezeket <span class="strong"><strong>tényező</strong></span>knek (<span class="strong"><strong>factor</strong></span>s) nevezzük. A lépések a következők:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Az <span class="emphasis"><em>M</em></span> tényező, <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>m</em></span>∣<span class="emphasis"><em>a</em></span>) nem igényel <span class="emphasis"><em>M</em></span> feletti összegzést (mivel <span class="emphasis"><em>M</em></span> értéke már rögzített). Eltároljuk a valószínűséget <span class="emphasis"><em>a</em></span> minden értékére egy kételemű vektorban,</p></li></ul></div><p><span class="inlinemediaobject"><img src="math/mi-14-0011.gif" alt="A változó eliminációs algoritmus"/></span></p><p class="Tartalom3">(Az <span class="strong"><strong>f</strong></span><sub>M</sub> azt jelöli, hogy <span class="strong"><strong>f </strong></span>létrehozásában <span class="emphasis"><em>M</em></span>-et felhasználtuk.)</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="Tartalom3">Hasonlóan, tároljuk a <span class="emphasis"><em>J</em></span>-hez tartozó tényezőt egy kételemű <span class="strong"><strong>f</strong></span><sub>J</sub>(<span class="emphasis"><em>A</em></span>) vektorban.</p></li><li class="listitem"><p>Az <span class="emphasis"><em>A-</em></span>hoz<span class="emphasis"><em> </em></span>tartozó tényező, <span class="strong"><strong>P</strong></span>(<span class="emphasis"><em>a</em></span>∣<span class="emphasis"><em>B</em></span>, <span class="emphasis"><em>e</em></span>), ami egy 2 × 2 × 2-es mátrix lesz, <span class="strong"><strong>f</strong></span><sub>A</sub>(<span class="emphasis"><em>A</em></span>, <span class="emphasis"><em>B</em></span>, <span class="emphasis"><em>E</em></span>).</p></li><li class="listitem"><p>Most ki kell összegeznünk <span class="emphasis"><em>A-</em></span>t ennek a három tényezőnek a szorzatából. Ez egy 2 × 2-es mátrixot eredményez, aminek indexei már csak <span class="emphasis"><em>B</em></span> és <span class="emphasis"><em>E</em></span> felett futnak. A mátrix nevében <span class="emphasis"><em>A</em></span>-nál egy felülvonással jelezzük, hogy <span class="emphasis"><em>A</em></span> már ki lett összegezve:</p></li></ul></div><p><span class="inlinemediaobject"><img src="math/mi-14-0012.gif" alt="A változó eliminációs algoritmus"/></span></p><p class="Tartalom3">Az itt használt szorzást <span class="strong"><strong>pontonkénti szorzás</strong></span>nak (<span class="strong"><strong>pointwise product</strong></span>) nevezik, és hamarosan ismertetjük.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Hasonló módon dolgozzuk fel <span class="emphasis"><em>E</em></span>-t: kiösszegezzük <span class="emphasis"><em>E</em></span>-t <span class="strong"><strong>f</strong></span><sub>E</sub>(<span class="emphasis"><em>E</em></span>) és <span class="inlinemediaobject"><img src="math/mi-14-0013.gif" alt="A változó eliminációs algoritmus"/></span>szorzatából: </p></li></ul></div><p><span class="inlinemediaobject"><img src="math/mi-14-0014.gif" alt="A változó eliminációs algoritmus"/></span></p><p>Most pedig kiszámíthatjuk az eredményt egyszerűen összeszorozva <span class="emphasis"><em>B</em></span> tényezőjét (azaz <span class="strong"><strong>f</strong></span><sub>B</sub>(<span class="emphasis"><em>B</em></span>) = <span class="strong"><strong>P</strong></span>(<span class="emphasis"><em>B</em></span>)-t) az <span class="inlinemediaobject"><img src="math/mi-14-0015.gif" alt="A változó eliminációs algoritmus"/></span>kiadódott mátrixszal:</p><p><span class="inlinemediaobject"><img src="math/mi-14-0016.gif" alt="A változó eliminációs algoritmus"/></span></p><p>A 14.7. (a) feladatban azt kérjük, hogy ellenőrizze, helyes eredményt ad-e ez a folyamat.</p><p>A lépések sorozatát megvizsgálva láthatjuk, hogy két alapvető művelet szükséges: tényezőpárok pontonkénti összeszorzása és egy változó kiösszegzése tényezők szorzatából.</p><p>A pontonkénti szorzás nem mátrixszorzás és nem is egy elemenkénti szorzás. Két, <span class="strong"><strong>f</strong></span><sub>1</sub> és <span class="strong"><strong>f</strong></span><sub>2</sub> tényezőnek a pontonkénti szorzata egy új <span class="strong"><strong>f </strong></span>tényezőt eredményez, amelynek változóit az <span class="strong"><strong>f</strong></span><sub>1</sub> és <span class="strong"><strong>f</strong></span><sub>2 </sub>változóinak az <span class="emphasis"><em>uniója</em></span> adja. Tételezzük fel, hogy a két tényezőben az <span class="emphasis"><em>Y</em></span><sub>1</sub>, ..., <span class="emphasis"><em>Y<sub>k</sub></em></span><sub> </sub>változók közösek. Ekkor azt kapjuk, hogy</p><p><code class="code"><em><span class="remark">f</span></em>(<em><span class="remark">X</span></em><sub>1</sub> … <em><span class="remark">X<sub>j</sub></span></em>, <em><span class="remark">Y</span></em><sub>1</sub> … <em><span class="remark">Y<sub>k</sub></span></em>, <em><span class="remark">Z</span></em><sub>1</sub> … <em><span class="remark">Z<sub>l</sub></span></em>) = <em><span class="remark">f</span></em><sub>1</sub>(<em><span class="remark">X</span></em><sub>1</sub> … <em><span class="remark">X<sub>j</sub></span></em>, <em><span class="remark">Y</span></em><sub>1</sub> … <em><span class="remark">Y<sub>k</sub></span></em>)<em><span class="remark">f</span></em><sub>2</sub>(<em><span class="remark">Y</span></em><sub>1</sub> … <em><span class="remark">Y<sub>k</sub></span></em>, <em><span class="remark">Z</span></em><sub>1</sub> … <em><span class="remark">Z<sub>l</sub></span></em>)</code></p><p>Ha minden változó bináris, akkor <span class="strong"><strong>f</strong></span><sub>1</sub>-nek és <span class="strong"><strong>f</strong></span><sub>2</sub>-nek 2<sup>j+k</sup> és 2<sup>k+l</sup> eleme van, pontonkénti szorzatuknak pedig 2<sup>j + k + l</sup>. Például az <span class="strong"><strong>f</strong></span><sub>1</sub>(<span class="emphasis"><em>A</em></span>,<span class="emphasis"><em>B</em></span>) és az <span class="strong"><strong>f</strong></span><sub>2</sub>(<span class="emphasis"><em>B</em></span>,<span class="emphasis"><em>C</em></span>) tényezők esetén a lentebb mutatott valószínűség-eloszlással, az <span class="strong"><strong>f</strong></span><sub>1</sub> × <span class="strong"><strong>f</strong></span><sub>2</sub> pontonkénti szorzata <span class="strong"><strong>f</strong></span><sub>3</sub>(<span class="emphasis"><em>A</em></span>, <span class="emphasis"><em>B</em></span>, <span class="emphasis"><em>C</em></span>)-vel adott:</p><p><span class="inlinemediaobject"><img src="kepek/14-09a.png" alt="A változó eliminációs algoritmus"/></span></p><p>Egy változó kiösszegzése tényezők szorzataiból szintén egyértelmű számítás. Az egyetlen észreveendő trükk az, hogy bármely tényező, ami <span class="emphasis"><em>nem</em></span> függ a kiösszegzendő változótól, az az összegzésen kívülre mozgatható. Például:</p><p><span class="inlinemediaobject"><img src="math/mi-14-0017.gif" alt="A változó eliminációs algoritmus"/></span></p><p>Most a pontonkénti szorzat kerül kiszámításra az összegzésen belül, a változót pedig kiösszegezzük a kiadódó mátrixból:</p><p><span class="inlinemediaobject"><img src="math/mi-14-0018.gif" alt="A változó eliminációs algoritmus"/></span></p><p>Vegyük észre, hogy mátrixokat <span class="emphasis"><em>nem</em></span> szorzunk, ameddig nem kell kiösszegeznünk egy változót a kiadódó szorzatból. Annál a pontnál csak azokat a mátrixokat szorozzuk öszsze, amelyek magukban foglalják a kiösszegzendő változót. A pontonkénti szorzás és a kiösszegzés eljárások megléte esetén maga a változó eliminálás algoritmusa, amint azt a 14.10. ábra mutatja, igen egyszerűen felírható.</p><p>Nézzünk még egy lekérdezést: <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>JánosTelefonál</em></span>∣<span class="emphasis"><em>Betörés</em></span> = <span class="emphasis"><em>igaz</em></span>). Szokásos módon, az első lépés az egymásba ágyazott összegzések felírása:</p><p><span class="inlinemediaobject"><img src="math/mi-14-0019.gif" alt="A változó eliminációs algoritmus"/></span></p><p>Ha ezt a kifejezést jobbról balra kiértékeljük, valami érdekeset veszünk észre: <span class="inlinemediaobject"><img src="math/mi-14-0020.gif" alt="A változó eliminációs algoritmus"/></span> definíció szerint 1-gyel egyenlő. Így ezt eleve kihagyhattuk; a változó <span class="emphasis"><em>M </em></span>a kérdésre<span class="emphasis"><em> irreleváns</em></span>. Máshogy fogalmazva, a <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>JánosTelefonál</em></span>∣<span class="emphasis"><em>Betörés</em></span> = <span class="emphasis"><em>igaz</em></span>) lekérdezés eredményét nem változtatja meg a <span class="emphasis"><em>MáriaTelefonál</em></span> eltávolítása a hálóból. Általában, bármely levélcsomópontot eltávolíthatunk, ami nem célváltozó vagy bizonyítékváltozó. Eltávolítás után lehetnek újabb levélcsomópontok, amelyek szintén irrelevánsak lehetnek.</p><div class="important" title="Fontos" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Fontos</h3><p>Ezt az eljárást folytatva végül szükségszerűen arra jutunk, hogy <span class="emphasis"><em>minden változó, ami nem őse a célváltozónak vagy egy bizonyítékváltozónak, irreleváns a lekérdezésre</em></span>. A változó elimináló algoritmus ezért az összes ilyen változót eltávolíthatja a lekérdezés kiértékelése előtt.</p></div><div class="figure"><a id="id681016"/><p class="title"><strong>14.10. ábra - A változó eliminálás algoritmus Bayes-hálós lekérdezések megválaszolására</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/14-10.png" alt="A változó eliminálás algoritmus Bayes-hálós lekérdezések megválaszolására"/></div></div></div></div><div class="section" title="Az egzakt következtetés komplexitása"><div class="titlepage"><div><div><h2 class="title"><a id="id681026"/>Az egzakt következtetés komplexitása</h2></div></div></div><p class="Tartalom3">Megmutattuk, hogy a változóeltávolítás hatékonyabb, mint a felsorolás, mivel elkerüli a számítások megismétlését (ahogyan az irreleváns változókat is kiejti). A változó eliminálás idő- és tárigényét az algoritmus működése alatt létrejövő legnagyobb tényező mérete befolyásolja a legerőteljesebben. Ezt viszont a változók eliminálásának sorrendje és a háló struktúrája határozza meg.</p><div class="important" title="Fontos" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Fontos</h3><p>A 14.2. ábra betörős hálója a hálóknak azon családjához tartozik, ahol a háló bármely két csomópontja között legfeljebb egyetlen irányítatlan út létezik. Ezeket <span class="strong"><strong>egyszeresen összekötött</strong></span> (<span class="strong"><strong>singly connected</strong></span>) hálóknak vagy <span class="strong"><strong>polifá</strong></span>knak (<span class="strong"><strong>polytree</strong></span>) nevezzük, amelyeknek van egy különösen kellemes tulajdonságuk: <span class="emphasis"><em>az egzakt következtetés idő- és tárkomplexitása a polifákban a háló méretében lineáris</em></span>. Itt a méret az FVT-bejegyzések számával van definiálva; ha minden egyes csomópont szüleinek a száma egy konstanssal korlátozott, akkor a komplexitás a csomópontok számában is lineáris. Ezek az eredmények bármely – a háló topológiai sorrendjével konzisztens – sorrendezés esetén fennállnak (lásd 14.7. feladat).</p></div><div class="important" title="Fontos" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Fontos</h3><p>A <span class="strong"><strong>többszörösen összekötött</strong></span> (<span class="strong"><strong>multiply connected</strong></span>) hálóban (lásd például 14.11. (a) ábra) a változó eliminálás legrosszabb esetben exponenciális idő- és tárkomplexitású lehet, még akkor is, ha a csomópontonkénti szülők száma korlátos. Ez nem meglepő, figyelembe véve, hogy <span class="emphasis"><em>a Bayes-hálókban való következtetés NP-nehéz, mivel ez speciális alesetként tartalmazza az ítéletlogikai következtetést is</em></span>. Valójában megmutatható (lásd 14.8. feladat), hogy a probléma ugyanannyira nehéz, mint kiszámítani egy ítéletlogikai formula esetén a formulát kielégítő értékadások <span class="emphasis"><em>számát.</em></span> Ez azt jelenti, hogy ez #P-nehéz („számosság-P-nehéz”), azaz szigorúan nehezebb, mint az NP-teljes problémák. </p></div><p>Szoros kapcsolat áll fenn a Bayes-hálókban történő következtetés komplexitása és a kényszerkielégítési problémák (CSP) komplexitása között. Amint az 5. fejezetben tárgyaltuk, egy diszkrét CSP megoldásának nehézsége ahhoz kapcsolódik, hogy a kényszergráf mennyire „faszerű”. Olyan mértékek, mint a <span class="strong"><strong>hiperfaszélesség</strong></span> (<span class="strong"><strong>hypertree width</strong></span>), amelyek a CSP megoldási komplexitását határolják, közvetlenül alkalmazhatók Bayes-hálóknál is. Ezenfelül a változó eliminálás algoritmusa általánosítható úgy, hogy kényszerkielégítési problémákat is és Bayes-hálókat is megoldjon.</p></div><div class="section" title="Csoportosító algoritmusok"><div class="titlepage"><div><div><h2 class="title"><a id="id681093"/>Csoportosító algoritmusok</h2></div></div></div><p class="Tartalom3">A változó eliminálás algoritmusa egyszerű és hatékony egyedi lekérdezések megválaszolására. Azonban ha a háló összes változójának az a posteriori eloszlását szeretnénk kiszámítani, akkor kevésbé hatékony is lehet. Például egy polifa hálóban <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>n</em></span>) egyenként <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>n</em></span>) költségű lekérdezést kell kiadni, összességében <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>n</em></span><sup>2</sup>) időköltséggel. <span class="strong"><strong>Csoportosító</strong></span> (<span class="strong"><strong>clustering</strong></span>) eljárásokkal (amit <span class="strong"><strong>egyesítési fa</strong></span> – <span class="strong"><strong>join tree</strong></span> – algoritmusnak is neveznek) ez az idő <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>n</em></span>)-re csökkenthető. Emiatt ezeket az algoritmusokat gyakran használják kereskedelmi Bayes-hálós eszközökben.</p><p class="Tartalom3">A csoportosítás alapötlete, hogy a háló önálló csomópontjait egyesítjük, klasztercsomópontokat formálva úgy, hogy a kiadódó háló polifa legyen. Például a 14.11. (a) ábrán mutatott, többszörösen összekötött háló egy polifává konvertálható a <span class="emphasis"><em>Locsoló</em></span> és az <span class="emphasis"><em>Eső</em></span> csomópontok egy <span class="emphasis"><em>Locsoló</em></span>+<span class="emphasis"><em>Eső</em></span>-nek nevezett <span class="strong"><strong>klasztercsomópont</strong></span>ba (<span class="strong"><strong>cluster node</strong></span>) való összevonásával, ahogy azt a 14.11. (b) ábra mutatja. A két bináris csomópontot egyetlen megacsomópont váltotta fel, ami négy lehetséges értéket vesz fel: <span class="emphasis"><em>hh</em></span>, <span class="emphasis"><em>hi</em></span>, <span class="emphasis"><em>ih</em></span>, <span class="emphasis"><em>ii</em></span>. A megacsomópontnak csak egy szülője van, a bináris <span class="emphasis"><em>Felhős</em></span> változó, így két feltételes eset létezik.</p><p>A háló polifává konvertálása után, egy speciális célú következtetési algoritmust alkalmazunk. Alapvetően az algoritmus egyfajta kényszerterjesztés (lásd 5. fejezet), ahol a kényszerek biztosítják, hogy a szomszédos csoportokban megegyeznek a közös változók a posteriori eloszlásai. Gondos nyilvántartással ez az algoritmus képes <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>n</em></span>) időben – ahol <span class="emphasis"><em>n</em></span> most a módosított háló mérete – kiszámolni a háló összes nem bizonyíték csomópontjának a posteriori eloszlását. Azonban a probléma NP-nehéz volta nem tűnt el: ha a háló exponenciális idő- és tárigényű a változó eliminálás esetén, akkor a csoportosított hálóhoz tartozó FVT-k megkonstruálása exponenciális idő- és tárigényű lesz.</p><div class="figure"><a id="id681209"/><p class="title"><strong>14.11. ábra - (a) Egy többszörösen összekötött háló feltételes valószínűségi táblákkal. (b) Egy többszörösen összekötött háló csoportosított ekvivalense.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/14-11.png" alt="(a) Egy többszörösen összekötött háló feltételes valószínűségi táblákkal. (b) Egy többszörösen összekötött háló csoportosított ekvivalense."/></div></div></div></div><div class="footnotes"><br/><hr/><div class="footnote"><p class="footnote text"><sup>[<a id="ftn.id677112" href="#id677112" class="para">148</a>] </sup> Feltesszük, hogy a célváltozó nincs a bizonyítékváltozók között; amúgy <span class="emphasis"><em>X</em></span> a posteriori eloszlása a megfigyelt értékre 1 valószínűséget ad. Az egyszerűség kedvéért azt is feltettük, hogy a kérdés egyetlen változóra irányul. Az algoritmusaink könnyen kiterjeszthetők több változó együttesének lekérdezésére.</p></div><div class="footnote"><p class="footnote text"><sup>[<a id="ftn.id677269" href="#id677269" class="para">149</a>] </sup> Egy olyan kifejezés mint a <span class="inlinemediaobject"><img src="math/mi-14-0043.gif" alt="Következtetés felsorolással"/></span> a <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>A = a, E = e</em></span>) -nek az összegzését jelenti minden lehetséges <span class="emphasis"><em>e</em></span> értékre. Ez többértelműséget rejt magában, mivel a <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>e</em></span>) jelölést használják mind a <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>E </em></span>= <span class="emphasis"><em>igaz</em></span>), mind a <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>E </em></span>= <span class="emphasis"><em>e</em></span>) jelentés kifejezésére, azonban a szándékolt jelentésnek a szövegkörnyezetből ki kell derülnie; egy összegzés esetében az utóbbiról van szó.</p></div></div></div></body></html>
