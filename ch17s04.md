<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/></head><body><div class="section" title="Részlegesen megfigyelhető Markov döntési folyamatok"><div class="titlepage"><div><div><h1 class="title"><a id="id715058"/>Részlegesen megfigyelhető Markov döntési folyamatok</h1></div></div></div><p>A Markov döntési folyamatok leírása a 17.1. alfejezetben feltételezte, hogy a környezet <span class="strong"><strong>teljesen megfigyelhető</strong></span> (<span class="strong"><strong>fully observable</strong></span>). E mellett a feltételezés mellett az ágens mindig tudja, hogy melyik állapotban van. Ez együttesen az állapotátmenet-modell Markov-tulajdonságának a feltevésével azt eredményezi, hogy az optimális eljárásmód csak az aktuális állapottól függ. Amikor a környezet csak <span class="strong"><strong>részlegesen megfigyelhető</strong></span> (<span class="strong"><strong>partially observable</strong></span>), a helyzet nem ennyire átlátható. Az ágens nem tudja feltétlenül, hogy melyik állapotban is van, így nem hajthatja végre az adott állapothoz javasolt <span class="emphasis"><em>π</em></span>(<span class="emphasis"><em>s</em></span>) cselekvést. Továbbá, egy <span class="emphasis"><em>s</em></span> állapot hasznossága és az <span class="emphasis"><em>s</em></span>-beli optimális cselekvés nemcsak <span class="emphasis"><em>s</em></span>-től függ, hanem attól is, hogy az ágens mennyit tud, amikor <span class="emphasis"><em>s</em></span>-ben van. Ebből kifolyólag a <span class="strong"><strong>részlegesen megfigyelhető MDF</strong></span>-eket (<span class="strong"><strong>RMMDF</strong></span>) (<span class="strong"><strong>partially obs</strong></span><span class="strong"><strong>ervable MDP</strong></span>s, <span class="strong"><strong>POMDP</strong></span>s) általában sokkal nehezebb dolgoknak tartják, mint a hagyományos MDF-eket. Az RMMDF-ek azonban nem megkerülhetők, mivel a valódi világ is egy RMMDF.</p><p>Példaként gondoljuk át újra a 17.1. ábra 4 × 3-as világát, de most tegyük fel, hogy az ágensnek <span class="emphasis"><em>egyáltalán nincsenek érzékelői,</em></span> és <span class="emphasis"><em>elképzelése sincs</em></span> arról, hogy hol lehet. Pontosabban, tegyük fel, hogy az ágens kezdeti állapota egyenlő valószínűséggel valamelyike a kilenc nem végállapotnak (17.8. (a) ábra). Világos, hogz ha az ágens tudná, hogy (3, 3)-ban van, akkor <span class="emphasis"><em>Jobbra</em></span> mozgást hajtana végre; ha <span class="emphasis"><em>tudná</em></span>, hogy (1, 1)-ben van, akkor <span class="emphasis"><em>Fel</em></span> mozogna; de mivel bárhol lehet, mit is kellene tennie? Egy lehetséges válasz, hogy az ágensnek először olyan cselekvéseket kell végrehajtani, amelyek csökkentik a bizonytalanságát, és csak ezután kell megpróbálni a +1 kijárat felé tartani. Például ha az ágens öt alkalommal <span class="emphasis"><em>Balra</em></span> mozgást hajt végre, akkor igen valószínű, hogy a bal oldali falnál van (17.8. (b) ábra). Ezután öt alkalommal <span class="emphasis"><em>Fel</em></span> mozgást hajt végre, akkor igen valószínű, hogy a felső falnál van, valószínűleg a bal felső sarokban (17.8. (c) ábra). Végül öt <span class="emphasis"><em>Jobbra</em></span> mozgást hajt végre, ekkor jó eséllyel – körülbelül 77,5%-kal – eléri a +1 kijáratot (17.8. (d) ábra). A <span class="emphasis"><em>Jobbra</em></span> mozgás ezt követő folytatása az esélyét 81,8%-ra növeli. Ez az eljárásmód így meglepően biztonságos, de ebben az esetben az ágens igen lassan éri el a kijáratot, és a várható hasznossága csupán 0,08 körül van. Az optimális eljárásmód, amit hamarosan leírunk, sokkal jobban teljesít.</p><div class="figure"><a id="id715168"/><p class="title"><strong>17.8. ábra - (a) Az ágens elhelyezkedésének kezdeti valószínűségi eloszlása. (b) Ötszöri <span class="emphasis"><em>Balra</em></span> mozgás után. (c) Ötszöri <span class="emphasis"><em>Fel</em></span> mozgás után. (d) Ötszöri <span class="emphasis"><em>Jobbra</em></span> mozgás után.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="kepek/17-08.png" alt="(a) Az ágens elhelyezkedésének kezdeti valószínűségi eloszlása. (b) Ötszöri Balra mozgás után. (c) Ötszöri Fel mozgás után. (d) Ötszöri Jobbra mozgás után."/></div></div></div><p>Az RMMDF-ek kezeléséhez először is megfelelően kell őket definiálni. Egy RMMDF-nek az elemei ugyanazok, mint egy MDF-nek – egy <span class="emphasis"><em>T</em></span>(<span class="emphasis"><em>s</em></span>,<span class="emphasis"><em> a</em></span>,<span class="emphasis"><em> s</em></span>′) állapotátmenet-modell és egy <span class="emphasis"><em>R</em></span>(<span class="emphasis"><em>s</em></span>) jutalomfüggvény –, de van egy <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>s</em></span>,<span class="emphasis"><em> o</em></span>) <span class="strong"><strong>megfigyelési modell</strong></span>je (<span class="strong"><strong>observational </strong></span><span class="strong"><strong>model</strong></span>) is, ami az <span class="emphasis"><em>s</em></span> állapotban az <span class="emphasis"><em>o</em></span> megfigyelés érzékelésének a valószínűségét adja meg.<sup>[<a id="id715246" href="#ftn.id715246" class="footnote">173</a>]</sup> Például az érzékelő nélküli ágensünknek csak egyetlen megfigyelése van (az üres megfigyelés), ami minden állapotban 1 valószínűséggel bekövetkezik.</p><p>A 3. és 12. fejezetben nemdeterminisztikus és részlegesen megfigyelhető tervkészítési problémákat tanulmányoztunk, és megállapítottuk, hogy a <span class="strong"><strong>hiedelmi állapot</strong></span> (<span class="strong"><strong>belief state</strong></span>) – az aktuális állapotok halmaza, amelyekben az ágens lehet – kulcsfogalom a megoldások leírására és kiszámítására.</p><p>Az RMMDF-ekben a fogalmat kissé finomítjuk. Egy <span class="emphasis"><em>b</em></span> hiedelmi állapot most egy valószínűség-eloszlás lesz az összes lehetséges állapot felett. Például a 17.8. (a) ábra kezdeti hiedelmi állapota úgy írható, hogy <span class="inlinemediaobject"><img src="math/mi-17-0019.gif" alt="(a) Az ágens elhelyezkedésének kezdeti valószínűségi eloszlása. (b) Ötszöri Balra mozgás után. (c) Ötszöri Fel mozgás után. (d) Ötszöri Jobbra mozgás után."/></span>. A <span class="emphasis"><em>b</em></span> hiedelmi állapot által az aktuális <span class="emphasis"><em>i </em></span>állapothoz rendelt valószínűséget <span class="emphasis"><em>b</em></span>(<span class="emphasis"><em>s</em></span>)-sel jelöljük. Az ágens úgy számíthatja ki a jelenlegi hiedelmi állapotát, mint egy <span class="emphasis"><em>feltételes eloszlást</em></span> az aktuális állapotok felett, az eddigi megfigyelések és cselekvések sorozatának ismeretében. Ez lényegében a <span class="strong"><strong>szűrés</strong></span>i (<span class="strong"><strong>filtering</strong></span>) feladat (lásd 15<span class="emphasis"><em>. </em></span>fejezet). A rekurzív szűrési alapegyenlet (lásd (15.3) egyenlet a <a class="xref" href="ch15s02.md#ID_633_oldal">„Szűrés és előrejelzés”</a> részben) megmutatja, hogy hogyan számolhatjuk ki az új hiedelmi állapotot az előző hiedelmi állapotból és az új megfigyelésből. Az RMMDF-eknél a jelölés eltérő, és meg kell gondolni még a cselekvést is, de az eredmény lényegében ugyanaz. Ha <span class="emphasis"><em>b</em></span>(<span class="emphasis"><em>s</em></span>) volt az előző hiedelmi állapot, és az ágens az <span class="emphasis"><em>a</em></span> cselekvést hajtja végre és az <span class="emphasis"><em>o</em></span> megfigyelést érzékeli, akkor az új hiedelmi állapot a következő:</p><p><span class="inlinemediaobject"><img src="math/mi-17-0020.gif" alt="(a) Az ágens elhelyezkedésének kezdeti valószínűségi eloszlása. (b) Ötszöri Balra mozgás után. (c) Ötszöri Fel mozgás után. (d) Ötszöri Jobbra mozgás után."/></span></p><p>ahol <span class="emphasis"><em>a</em></span> egy normalizációs konstans, ami a hiedelmi állapot 1-re összegzését biztosítja. Ezt az egyenletet úgy rövidíthetjük, hogy <span class="emphasis"><em>b</em></span>′ = <code class="code">ELŐRE</code>(<span class="emphasis"><em>b</em></span>,<span class="emphasis"><em> a</em></span>,<span class="emphasis"><em> o</em></span>).</p><div class="important" title="Fontos" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Fontos</h3><p>A RMMDF-ek megértéséhez szükséges lényegi meglátás pedig ez: <span class="emphasis"><em>az optimális cselekvés csak az ágens aktuális hiedelmi állapotától függ. </em></span>Így az optimális eljárásmód leírható a hiedelmi állapotok cselekvésekre történő <span class="emphasis"><em>π</em></span><sup>*</sup>(<span class="emphasis"><em>b</em></span>)<span class="emphasis"><em> </em></span>leképzésével. Ez <span class="emphasis"><em>nem</em></span> függ az ágens <span class="emphasis"><em>aktuális</em></span> állapotától, amiben tartózkodik. Ez hasznos tulajdonság, mivel az ágens nem ismeri az aktuális állapotát; csupán a hiedelmi állapotát. Ekkor egy RMMDF ágens döntési ciklusa a következő:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Adott jelenlegi <span class="emphasis"><em>b</em></span> hiedelmi állapot esetén hajtsuk végre az <span class="emphasis"><em>a</em></span> = <span class="emphasis"><em>π</em></span><sup>* </sup>(<span class="emphasis"><em>b</em></span>) cselekvést.</p></li><li class="listitem"><p>Fogadjuk az <span class="emphasis"><em>o</em></span> megfigyelést.</p></li><li class="listitem"><p>Állítsuk a jelenlegi állapothiedelmet <code class="code">ELŐRE</code>(<span class="emphasis"><em>b</em></span>,<span class="emphasis"><em> a</em></span>,<span class="emphasis"><em> o</em></span>)-ra, és ismételjük meg a ciklust.</p></li></ol></div><p>Most úgy gondolhatunk az RMMDF-ekre, mint amelyek keresést igényelnek a hiedelmi állapotok terében, pontosan úgy, ahogy az érzékelő nélküli és az eshetőségi problémákra vonatkozó módszerek a 3. fejezetben. A fő különbség az, hogy az RMMDF hiedelmi állapot tere <span class="emphasis"><em>folytonos,</em></span> mivel egy RMMDF hiedelmi állapot egy valószínűségi eloszlás. Például a hiedelmi állapot a 4 × 3-as világ esetében egy pont a 11 dimenziós folytonos térben. Egy cselekvés megváltoztatja a hiedelmi állapotot is, nemcsak a fizikai állapotot, így kiértékelése aszerint az információ szerint történik, amit a cselekvés eredményeként az ágens megszerez. Az RMMDF-ekbe ezért beletartozik az információ értéke is (16.6. alfejezet) mint a döntési probléma egy komponense.</p></div><p>Nézzük meg tüzetesebben a cselekvések kimenetelét. Nevezetesen, számítsuk ki annak valószínűségét, hogy az ágens a <span class="emphasis"><em>b</em></span> hiedelmi állapotból a <span class="emphasis"><em>b</em></span>′ hiedelmi állapotba jut az <span class="emphasis"><em>a</em></span> cselekvés végrehajtása után. Ekkor, ha ismernénk a cselekvést és a <span class="emphasis"><em>bekövetkező megfigyelést,</em></span> akkor a (17.11) egyenlet a hiedelmi állapot egy determinisztikus frissítését adná: <span class="emphasis"><em>b</em></span>′ = <code class="code">ELŐRE</code>(<span class="emphasis"><em>b</em></span>,<span class="emphasis"><em> a</em></span>,<span class="emphasis"><em> o</em></span>).<span class="emphasis"><em> </em></span>Természetesen a bekövetkező megfigyelés még nem ismert, így az ágens a számos lehetséges hiedelmi állapot egyikébe, <span class="emphasis"><em>b</em></span>′-be kerülhet az előforduló megfigyelés függvényében. Az <span class="emphasis"><em>o</em></span> érzékelésének valószínűsége, feltéve hogy a <span class="emphasis"><em>b</em></span>′ hiedelmi állapotban az <span class="emphasis"><em>a</em></span> cselekvés került végrehajtásra, az összes olyan <span class="emphasis"><em>s</em></span>′ aktuális állapot feletti összegzéssel adódik, amelyeket az ágens elérhet:</p><p><span class="inlinemediaobject"><img src="math/mi-17-0021.gif" alt="(a) Az ágens elhelyezkedésének kezdeti valószínűségi eloszlása. (b) Ötszöri Balra mozgás után. (c) Ötszöri Fel mozgás után. (d) Ötszöri Jobbra mozgás után."/></span></p><p>Jelölje <span class="emphasis"><em>τ</em></span>(<span class="emphasis"><em>b</em></span>,<span class="emphasis"><em> a</em></span>,<span class="emphasis"><em> b</em></span>′) annak a valószínűségét, hogy <span class="emphasis"><em>b</em></span>-ből <span class="emphasis"><em>b</em></span>′-be jutunk egy <span class="emphasis"><em>a</em></span> cselekvéssel. Ennek felhasználásával ekkor </p><p><span class="inlinemediaobject"><img src="math/mi-17-0022.gif" alt="(a) Az ágens elhelyezkedésének kezdeti valószínűségi eloszlása. (b) Ötszöri Balra mozgás után. (c) Ötszöri Fel mozgás után. (d) Ötszöri Jobbra mozgás után."/></span></p><p>ahol <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>b</em></span>′|<span class="emphasis"><em>o</em></span>,<span class="emphasis"><em> a</em></span>,<span class="emphasis"><em> b</em></span>)<span class="emphasis"><em> </em></span>1, ha <span class="emphasis"><em>b</em></span>′ = <code class="code">ELŐRE</code>(<span class="emphasis"><em>b</em></span>,<span class="emphasis"><em> a</em></span>,<span class="emphasis"><em> o</em></span>),<span class="emphasis"><em> </em></span>egyébként<span class="emphasis"><em> </em></span>pedig 0.</p><div class="important" title="Fontos" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Fontos</h3><p>A (17.2.) egyenletet felfoghatjuk egy állapotátmenet-modellnek a hiedelmi állapot térben. Definiálhatunk egy jutalomfüggvényt is a hiedelmi állapotokra (azaz azon aktuális állapotok várható jutalmát, amelyekben az ágens lehet):</p><p><span class="inlinemediaobject"><img src="math/mi-17-0023.gif" alt="(a) Az ágens elhelyezkedésének kezdeti valószínűségi eloszlása. (b) Ötszöri Balra mozgás után. (c) Ötszöri Fel mozgás után. (d) Ötszöri Jobbra mozgás után."/></span></p><p>Így láthatóan <span class="emphasis"><em>τ</em></span>(<span class="emphasis"><em>b</em></span>,<span class="emphasis"><em> a</em></span>,<span class="emphasis"><em> b</em></span>′)<span class="emphasis"><em> </em></span>és <span class="emphasis"><em>ρ</em></span>(<span class="emphasis"><em>b</em></span>) együtt egy <span class="emphasis"><em>megfigyelhető</em></span> MDF-et definiál a hiedelmi állapotok terén. Továbbá megmutatható, hogy egy <span class="emphasis"><em>π</em></span><sup>*</sup>(<span class="emphasis"><em>b</em></span>) optimális eljárásmód erre az MDF-re, szintén optimális eljárásmód az eredeti RMMDF-re. Máshogy fogalmazva, <span class="emphasis"><em>egy RMMDF megoldása a fizikai állapottérben redukálható egy MDF megoldására a hozzá tartozó hiedelmi állapot térben.</em></span> Ez a tény talán kevésbé meglepő, arra gondolva, hogy a hiedelmi állapot definíció szerint az ágens számára mindig megfigyelhető.</p></div><p>Vegyük észre, hogy bár az RMMDF-eket sikeresen redukáltuk az MDF-ekre, a kapott MDF-eknek folytonos (és általában sokdimenziós) állapotterük van. A 17.2. és 17.3. alfejezetekben leírt algoritmusok egyike sem alkalmazható közvetlenül ilyen MDF-ekre. Kiderült, hogy az érték- és eljárásmód-iterációnak kifejleszthetők olyan változatai, amelyek folytonos állapotú MDF-ekre is alkalmazhatók. Az alapötlet az, hogy egy <span class="emphasis"><em>π</em></span>(<span class="emphasis"><em>b</em></span>) eljárásmód reprezentálható a hiedelmi állapot tér olyan <span class="emphasis"><em>részeinek</em></span> egy halmazaként, amelyek mindegyikéhez egy adott optimális cselekvés tartozik.<sup>[<a id="id716602" href="#ftn.id716602" class="footnote">174</a>]</sup> Az értékfüggvény <span class="emphasis"><em>b</em></span> különböző lineáris függvényét rendeli az egyes térrészekhez. Minden érték- és eljárásmód-iterációs lépés finomít a térrészek határain, és új térrészeket vezethet be.</p><p>Az algoritmus részletei meghaladják a könyv kereteit, de megadjuk a megoldást az érzékelőmentes 4 × 3-as világra. Az optimális eljárásmód a következő:</p><p><code class="code">[<em><span class="remark">Balra</span></em>,<em><span class="remark"> Fel</span></em>,<em><span class="remark"> Fel</span></em>,<em><span class="remark"> Jobbra</span></em>,<em><span class="remark"> Fel</span></em>,<em><span class="remark"> Fel</span></em>,<em><span class="remark"> Jobbra</span></em>,<em><span class="remark"> Fel</span></em>,<em><span class="remark"> Fel</span></em>,<em><span class="remark"> Jobbra</span></em>,<em><span class="remark"> Fel</span></em>, <em><span class="remark">Jobbra</span></em>,<em><span class="remark"> Fel</span></em>, …]</code></p><p>Az eljárásmód egy sorozat, mivel ez a probléma determinisztikus a hiedelmi állapotok terében – nincsenek megfigyelések. Azt a „trükköt” alkalmaztuk, hogy az ágens egyetlen <span class="emphasis"><em>Balra</em></span> mozgással biztosítja, hogy <span class="emphasis"><em>nincs</em></span> (4, 1)-ben, azért, hogy aztán meglehetős biztonsággal mozoghasson <span class="emphasis"><em>Fel</em></span> és <span class="emphasis"><em>Jobbra</em></span> a +1 kijárat eléréséhez. Az ágens a +1 kijáratot 86,6% gyakorisággal éri el, és sokkal gyorsabban, mint az alfejezet elején megadott eljárásmód esetén, így a várható hasznossága 0,38, szemben az előző 0,08-as értékével.</p><p>Bonyolultabb RMMDF-eknél, amikor megfigyelések is vannak, nagyon nehéz (valójában PSPACE-beli – azaz valóban nagyon nehéz) közelítőleg optimális eljárásmódokat találni. A problémák néhány tucat változóval gyakran kivitelezhetetlenek. A következő alfejezet egy eltérő közelítő módszert ír le RMMDF-ek megoldására, ami az előrenéző keresésen alapul.</p><div class="footnotes"><br/><hr/><div class="footnote"><p class="footnote text"><sup>[<a id="ftn.id715246" href="#id715246" class="para">173</a>] </sup> A megfigyelési modell alapvetően azonos az időbeli folyamatok <span class="strong"><strong>érzékelő modell</strong></span>jével (<span class="strong"><strong>sensor model</strong></span>) a 15. fejezetből. Ahogyan az MDF-ek jutalomfüggvényénél, a megfigyelési modell szintén függhet a cselekvéstől és a kimeneteli állapottól, de ez most sem egy alapvető változás.</p></div><div class="footnote"><p class="footnote text"><sup>[<a id="ftn.id716602" href="#id716602" class="para">174</a>] </sup> Bizonyos RMMDF-ekre az optimális eljárásmódhoz végtelen számú térrész tartozik, így az egyszerű térrészek listája megközelítés nem működik, és ötletesebb módszerek szükségesek még egy közelítés megtalálásához is.</p></div></div></div></body></html>
