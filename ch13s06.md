<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/></head><body><div class="section" title="A Bayes-tétel és használata"><div class="titlepage"><div><div><h1 class="title"><a id="id669524"/>A Bayes-tétel és használata</h1></div></div></div><p>Az <a class="xref" href="ch13s02.md#ID_554_oldal">„A priori valószínűség”</a> részben definiáltuk a <span class="strong"><strong>szorzatszabály</strong></span>t (<span class="strong"><strong>product rule</strong></span>), és rámutattunk, hogy ez a konjunkció kommutativitása miatt két alakban írható:</p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">a</span></em> ∧ <em><span class="remark">b</span></em>) = <em><span class="remark">P</span></em>(<em><span class="remark">a</span></em> | <em><span class="remark">b</span></em>)<em><span class="remark">P</span></em>(<em><span class="remark">b</span></em>)</code></p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">a</span></em> ∧ <em><span class="remark">b</span></em>) = <em><span class="remark">P</span></em>(<em><span class="remark">b</span></em> | <em><span class="remark">a</span></em>)<em><span class="remark">P</span></em>(<em><span class="remark">a</span></em>)</code></p><p>A jobb oldalak egyenlőségéből <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>a</em></span>)-val való osztás után következik, hogy</p><p><span class="inlinemediaobject"><img src="math/mi-13-0010.gif" alt="A Bayes-tétel és használata"/></span></p><p>Ezt az egyenletet <span class="strong"><strong>Bayes-szabály</strong></span>ként (<span class="strong"><strong>Bayes’ rule</strong></span>) ismerjük (nevezik Bayes-törvénynek vagy Bayes-tételnek is).<sup>[<a id="id669637" href="#ftn.id669637" class="footnote">141</a>]</sup> Ez az egyszerű egyenlet az alapja az összes korszerű valószínűségi következtetést alkalmazó MI-rendszernek. A többértékű változókat tartalmazó általánosabb eset a <span class="strong"><strong>P </strong></span>jelölésekkel a következő átírással adható meg:</p><p><span class="inlinemediaobject"><img src="math/mi-13-0011.gif" alt="A Bayes-tétel és használata"/></span></p><p>amelyet ismételten úgy kell értelmezni, hogy egy egyenlethalmazt képvisel, amely egyenletek mindegyike a változók meghatározott értékeire vonatkozik. Lesznek olyan esetek, amikor egy még általánosabb felírást használhatunk, valamilyen <span class="strong"><strong>e </strong></span>háttértény feltételével: </p><p><span class="inlinemediaobject"><img src="math/mi-13-0012.gif" alt="A Bayes-tétel és használata"/></span></p><div class="section" title="Bayes tételének alkalmazása: egyszerű eset"><div class="titlepage"><div><div><h2 class="title"><a id="id669680"/>Bayes tételének alkalmazása: egyszerű eset</h2></div></div></div><p>A Bayes-tétel első pillantásra nem tűnik túl használhatónak. Egyetlen feltételes valószínűség kiszámításához három kifejezés – egy feltételes és két feltétel nélküli valószínűség – megadása szükséges.</p><p>A gyakorlatban a Bayes-tétel jól használható, mivel gyakran rendelkezünk a fenti három kifejezésre vonatkozó jó valószínűségi becsléssel, miközben a negyediket kell kiszámítanunk. Olyan feladatoknál, mint az orvosi diagnosztika, gyakran ismerjük az ok-okozati kapcsolatok feltételes valószínűségeit, miközben egy diagnózist szeretnénk felállítani. Az orvos tudja azt, hogy az agyhártyagyulladás az esetek mondjuk 50%-ában nyakmerevedést okoz a betegeknél. Az orvos ezenfelül ismer néhány feltétel nélküli tényt is: annak előzetes valószínűsége, hogy egy beteg agyhártyagyulladást kap, 1/50 000, míg annak előzetes valószínűsége, hogy egy betegnek merev a nyaka 1/20. Jelölje <span class="emphasis"><em>s </em></span>azt az állítást, hogy a betegnek megmerevedett a nyaka, valamint <span class="emphasis"><em>m</em></span> azt az állítást, hogy a betegnek agyhártyagyulladása van. Ekkor</p><p><span class="inlinemediaobject"><img src="math/mi-13-0013.gif" alt="Bayes tételének alkalmazása: egyszerű eset"/></span></p><p>Vagyis a nyakmerevedésről panaszkodó 5000 beteg közül várhatóan csak egynek lesz agyhártyagyulladása. Vegyük észre, hogy annak ellenére, hogy az agyhártyagyulladásnak igen gyakori tünete (0,5 valószínűséggel) a nyakmerevedés, annak valószínűsége, hogy egy nyakmerevedéses betegnek ténylegesen agyhártyagyulladása van, mégis csekély. Ez abból következik, hogy a nyakmerevedés a priori valószínűsége sokkal nagyobb, mint az agyhártyagyulladásé.</p><p>A 13.4. alfejezetben bemutattunk egy eljárást, amely segítségével elkerülhető a tény valószínűségének (példánkban <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>s</em></span>)) megbecsülése, úgy, hogy a lekérdezett változó minden egyes értékéhez (itt <span class="emphasis"><em>m </em></span>és ¬<span class="emphasis"><em>m</em></span>) egy utólagos valószínűséget számítunk ki, majd az eredményeket normalizáljuk. Hasonló eljárás alkalmazható, ha a Bayes-tételt használjuk. Ismert, hogy</p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">M|s</span></em>) = α〈<em><span class="remark">P</span></em>(<em><span class="remark">s|m</span></em>)<em><span class="remark">P</span></em>(<em><span class="remark">m</span></em>), <em><span class="remark">P</span></em>(<em><span class="remark">s|</span></em>¬<em><span class="remark">m</span></em>)<em><span class="remark">P</span></em>(¬<em><span class="remark">m</span></em>)〉</code></p><p>Következésképpen ahhoz, hogy ezt a megközelítést használni tudjuk, <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>s</em></span>)<span class="emphasis"><em> </em></span>helyett <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>s</em></span>∣¬<span class="emphasis"><em>m</em></span>)-et kell tudnunk becsülni. Nincs ingyenebéd – van, hogy ez könnyebb és van, hogy nehezebb. A normalizált Bayes-tétel általános alakja</p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">Y|X</span></em>) = α<em><span class="remark">P</span></em>(<em><span class="remark">X\Y</span></em>)<em><span class="remark">P</span></em>(<em><span class="remark">Y</span></em>)			(13.11)</code></p><p>ahol <span class="emphasis"><em>a</em></span> a normalizáló konstanst jelöli, amely segítségével a <span class="strong"><strong>P</strong></span>(<span class="emphasis"><em>Y|X</em></span>) elemeinek összegét 1-gyé tudjuk tenni.</p><div class="important" title="Fontos" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Fontos</h3><p>A Bayes-tétellel kapcsolatban magától értetődő kérdés, hogy miért ismerhetjük a feltételes valószínűséget az egyik irányból, a másik irányból pedig nem. Az agyhártyagyulladás tartományban a doktor tudhatja, hogy a nyakmerevedésből csak minden 5000-dik esetben következik agyhártyagyulladás, vagyis a doktor a tünetektől a kiváltó ok felé, azaz <span class="strong"><strong>diagnosztikai</strong></span> (<span class="strong"><strong>diagnostic</strong></span>) irányban rendelkezik<span class="emphasis"><em> </em></span>mennyiségi információval. Egy ilyen orvosnak nincs szüksége a Bayes-tétel alkalmazására. Sajnálatos módon azonban a <span class="emphasis"><em>diagnosztikai tudás gyakran sokkal törékenyebbnek bizonyul az ok-okozati összefüggéseknél. </em></span>Ha például hirtelen agyhártyagyulladás-járvány tör ki, akkor az agyhártyagyulladás előzetes valószínűsége, <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>m</em></span>) megnő. Az az orvos, aki a járványt megelőző statisztikai adatok alapján számította ki <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>m|s</em></span>)-t, nem fogja tudni, hogyan változtassa meg az agyhártyagyulladásra vonatkozó értéket, míg az a doktor, aki a másik három érték segítségével számítja <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>m|s</em></span>)-t, látni fogja, hogy ennek értéke <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>m</em></span>)-mel arányosan meg fog nőni. Még fontosabb azonban, hogy a <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>s|m</em></span>) okozati információ értékét a járvány <span class="emphasis"><em>nem befolyásolja,</em></span> hiszen ez kizárólag az agyhártyagyulladás lefolyásától függ. Ez a fajta közvetlen ok-okozati és modellalapú tudás alkalmazása teszi a valószínűségi rendszereket döntően robusztussá, amely a valódi világban való felhasználhatósághoz szükséges.</p></div></div><div class="section" title="A Bayes-tétel alkalmazása: több együttes tény figyelembevétele"><div class="titlepage"><div><div><h2 class="title"><a id="id669888"/>A Bayes-tétel alkalmazása: több együttes tény figyelembevétele</h2></div></div></div><p>Láttuk, hogy a Bayes-tétel hasznos lehet az egyetlen tény – például nyakmerevedés – feltételezése melletti valószínűségi kérdések megválaszolásánál. Nevezetesen, megmutattuk, hogy a valószínűségi információ gyakran <span class="emphasis"><em>P</em></span>(<span class="emphasis"><em>okozat</em></span>∣<span class="emphasis"><em>ok</em></span>) formában áll rendelkezésre. Mi történik azonban akkor, ha kettő vagy több tény van a birtokunkban? Például milyen következtetésre juthat a fogorvos, ha az az undok acélszondája lyukra akad a beteg fájó fogában? Ha ismerjük a teljes együttes eloszlást (lásd 13.3. ábra), a válasz kiolvasható:</p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">Lyuk</span></em>∣<em><span class="remark">fogfájás</span></em> ∧ <em><span class="remark">beakadás</span></em>) = α〈0,018, 0,016〉 ≈ 〈0,871, 0,129〉</code></p><p>Azt is tudjuk ugyanakkor, hogy ez a megközelítés nagyszámú változó esetén nem használható.</p><p>Megpróbálkozhatunk a Bayes-tétel alkalmazásával is, átfogalmazva a kérdést:</p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">Lyuk</span></em>∣<em><span class="remark">fogfájás</span></em> ∧ <em><span class="remark">beakadás</span></em>) = <em><span class="remark">α</span></em><em><span class="remark">P</span></em>(<em><span class="remark">fogfájás</span></em> ∧ <em><span class="remark">beakadás</span></em>∣<em><span class="remark">Lyuk</span></em>)<em><span class="remark">P</span></em>(<em><span class="remark">Lyuk</span></em>)			(13.12)</code></p><p>Ahhoz, hogy ez az átfogalmazás működjön, a <span class="emphasis"><em>Lyuk</em></span> minden értékére ismernünk kell a <span class="emphasis"><em>fogfájás</em></span> ∧ <span class="emphasis"><em>beakadás </em></span>együttes bekövetkezésének<span class="emphasis"><em> </em></span>feltételes valószínűségét. Noha ez két tényváltozó esetén használható lehet, nagyszámú változó esetén már nem alkalmazható. Ha <span class="emphasis"><em>n</em></span> figyelembe veendő tényváltozónk van (röntgen, diéta, szájhigiénia stb.), akkor a megfigyelt értékek lehetséges kombinációinak száma 2<sup>n</sup>, amely esetek mindegyikénél ismernünk kell a feltételes valószínűséget. Ennyi erővel akár vissza is térhetünk a teljes együttes valószínűség-eloszlás használatához. Ez vezetett arra, hogy a kutatók a valószínűség-számítás helyett közelítő módszereket kezdtek el használni több tény együttes figyelembevételénél, mert bár az így kapott válaszok pontatlanok, de kevesebb számolást igényelnek.</p><p>A fenti út követése helyett inkább további állításokat kell keresnünk a tárgytartományról, amelyek lehetővé teszik a kifejezések egyszerűsítését. A 13.5. alfejezetben bevezetett <span class="strong"><strong>függetlenség</strong></span> (<span class="strong"><strong>independence</strong></span>) fogalma kínálja a megoldás kulcsát, azonban finomítást igényel. Kellemes lenne, ha a <span class="emphasis"><em>Fogfájás</em></span> és a <span class="emphasis"><em>Beakadás</em></span> függetlenek lennének, de nem azok: ha a szonda megakad a fogban, akkor az valószínűleg lyukas, ami várhatóan fájdalmat okoz. Mindemellett, ezek a változók <span class="emphasis"><em>függetlenek, </em></span>amennyiben a <span class="emphasis"><em>lyuk megléte vagy hiánya adott tény. </em></span>Mindkettő a lyuk közvetlen következménye, azonban egyiknek sincs közvetlen hatása a másikra: a fogfájás a fogidegek állapotától függ, míg a szonda pontosságát a fogorvos szakértelme határozza meg, amelyben nincs szerepe a fogfájásnak.<sup>[<a id="id670018" href="#ftn.id670018" class="footnote">142</a>]</sup> Ezt a tulajdonságot matematikailag a következőképpen írhatjuk le</p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">fogfájás</span></em> ∧ <em><span class="remark">beakadás</span></em>∣<em><span class="remark">Lyuk</span></em>) = <em><span class="remark">P</span></em>(<em><span class="remark">fogfájás</span></em>∣<em><span class="remark">Lyuk</span></em>)<em><span class="remark">P</span></em>(<em><span class="remark">beakadás</span></em>∣<em><span class="remark">Lyuk</span></em>)		(13.13)</code></p><p>Ez az egyenlet a <span class="emphasis"><em>Lyuk</em></span> ténye esetén a <span class="emphasis"><em>fogfájás</em></span> és <span class="emphasis"><em>beakadás</em></span> között fennálló <span class="strong"><strong>feltételes függetlenség</strong></span>et (<span class="strong"><strong>conditional independence</strong></span>) fejezi ki. (13.13)-at (13.12)-be behelyettesítve megkapjuk a lyuk valószínűségét:</p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">Lyuk</span></em>∣<em><span class="remark">fogfájás </span></em>∧ <em><span class="remark">beakadás</span></em>) = <em><span class="remark">α</span></em><em><span class="remark">P</span></em>(<em><span class="remark">fogfájás</span></em>∣<em><span class="remark">Lyuk</span></em>)<em><span class="remark">P</span></em>(<em><span class="remark">beakadás</span></em>) ∣<em><span class="remark">Lyuk</span></em>)<em><span class="remark">P</span></em>(<em><span class="remark">Lyuk</span></em>)</code></p><p>Ezzel ugyanarra az információigényre jutottunk, mint a minden egyes tényt külön használó következtetésnél: a keresés változójának <span class="strong"><strong>P</strong></span>(<span class="emphasis"><em>Lyuk</em></span>) a priori valószínűségét, valamint minden egyes okozat saját okának fennállása esetén igaz feltételes valószínűségét kell ismernünk.</p><p>Két változó, <span class="emphasis"><em>X </em></span>és <span class="emphasis"><em>Y </em></span>egy adott <span class="emphasis"><em>Z</em></span> harmadik melletti feltételes függetlenségének általános definíciójáta következő egyenlet adja:</p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">X</span></em>, <em><span class="remark">Y</span></em>∣<em><span class="remark">Z</span></em>) = <em><span class="remark">P</span></em>(<em><span class="remark">X</span></em>∣<em><span class="remark">Z</span></em>)<em><span class="remark">P</span></em>(<em><span class="remark">Y</span></em>∣<em><span class="remark">Z</span></em>)</code></p><p>A fogorvostartományban, például, logikusnak tűnik a <span class="emphasis"><em>Fogfájás</em></span> és <span class="emphasis"><em>Beakadás</em></span> között feltételes függetlenséget feltételezni a <span class="emphasis"><em>Lyuk</em></span> ténye esetén:</p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">Fogfájás, Beakadás</span></em>∣<em><span class="remark">Lyuk</span></em>) = <em><span class="remark">P</span></em>(<em><span class="remark">Fogfájás</span></em>∣<em><span class="remark">Lyuk</span></em>)<em><span class="remark">P</span></em>(<em><span class="remark">Beakadás</span></em>∣<em><span class="remark">Lyuk</span></em>)	(13.14)</code></p><p>Vegyük észre, hogy ez a kijelentés valamelyest erősebb, mint amit a (13.13) egyenlet fejez ki. Ez utóbbi csak a <span class="emphasis"><em>Fogfájás</em></span> és <span class="emphasis"><em>Beakadás</em></span> bizonyos értékeihez rendel függetlenséget. Éppúgy, mint a (13.8) egyenletben az abszolút függetlenségnél, a következő ekvivalens kifejezések is használhatók:</p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">X</span></em>∣<em><span class="remark">Y</span></em>, <em><span class="remark">Z</span></em>) = <em><span class="remark">P</span></em>(<em><span class="remark">X</span></em>∣<em><span class="remark">Z</span></em>) és <em><span class="remark">P</span></em>(<em><span class="remark">Y</span></em>∣<em><span class="remark">X</span></em>, <em><span class="remark">Z</span></em>) = <em><span class="remark">P</span></em>(<em><span class="remark">Y</span></em>∣<em><span class="remark">Z</span></em>)</code></p><p>A 13.5. alfejezetben megmutattuk, hogy a teljes függetlenség bizonyíthatósága esetén a teljes együttes valószínűségi eloszlás szétbontható sokkal kisebb részekre. Ugyanez lesz igaz feltételes függetlenség esetén is. Példának okáért, a (13.14) szerinti kijelentés fennállása esetén, a felbontás a következőt jelentheti:</p><p><code class="code"><em><span class="remark">P</span></em>(<em><span class="remark">Fogfájás, Beakadás, Lyuk</span></em>)</code></p><p><code class="code">= <em><span class="remark">P</span></em>(<em><span class="remark">Fogfájás, Beakadás</span></em>∣<em><span class="remark">Lyuk</span></em>)<em><span class="remark">P</span></em>(<em><span class="remark">Lyuk</span></em>) 	(szorzatszabály)</code></p><p><code class="code">= <em><span class="remark">P</span></em>(<em><span class="remark">Fogfájás</span></em>∣<em><span class="remark">Lyuk</span></em>)<em><span class="remark">P</span></em>(<em><span class="remark">Beakadás</span></em>∣<em><span class="remark">Lyuk</span></em>)<em><span class="remark">P</span></em>(<em><span class="remark">Lyuk</span></em>)	(13.14)-et használva</code></p><div class="important" title="Fontos" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Fontos</h3><p>Ezzel a módszerrel az eredeti nagy táblázat felbontható három kisebbre. Az eredeti táblázat hét független számot tartalmaz (2<sup>3</sup>–1, mivel a számok összegének 1-et kell adnia). A kisebb táblázatokban öt független szám található (mindegyik feltételes valószínűségi eloszlásra 2 × (2<sup>1</sup>–1), valamint 2<sup>1</sup>–1 a <span class="emphasis"><em>Lyuk</em></span> előzetes valószínűségi eloszlására). Ez nem tűnik túl nagy győzelemnek, azonban, ha a <span class="emphasis"><em>Lyuk</em></span> ténye mellett <span class="emphasis"><em>n </em></span>tünet bizonyul függetlennek, akkor a reprezentáció <span class="emphasis"><em>O</em></span>(<span class="emphasis"><em>n</em></span>) nagyságrendben növekszik <span class="emphasis"><em>O</em></span>(2<sup>n</sup>) helyett. Következésképpen <span class="emphasis"><em>a feltételes függetlenségi kijelentések lehetővé teszik nagy valószínűségi rendszerek kezelhetőségét, sőt, a feltételes függetlenségi kijelentések gyakrabban rendelkezésre is állnak, mint az abszolút függetlenségre vonatkozók.</em></span> A <span class="emphasis"><em>Lyuk</em></span> fogalmilag <span class="strong"><strong>szétválaszt</strong></span>ja (<span class="strong"><strong>separate</strong></span>) a <span class="emphasis"><em>Fogfájás-</em></span>t<span class="emphasis"><em> </em></span>és a <span class="emphasis"><em>Beakadás-</em></span>t, mivel mindkettőnek közvetlen következménye. Nagy valószínűségi tartományok feltételes függetlenségen keresztül lazán kapcsolódó részhalmazokra történő szétbontása a modern MI történetének legnagyobb eredményei közé tartozik.</p></div><p>A fogorvosi eset jó példa az olyan, rendszeresen bekövetkező mintára, ahol egyetlen ok közvetlenül befolyásol számos olyan okozatot, amelyek az ok fennállása esetén feltételesen függetlenek. A teljes valószínűségi eloszlás az alábbiak szerint írható fel:</p><p><span class="inlinemediaobject"><img src="math/mi-13-0014.gif" alt="A Bayes-tétel alkalmazása: több együttes tény figyelembevétele"/></span></p><p>Az ilyen valószínűségi eloszlásokat <span class="strong"><strong>naiv Bayes</strong></span>-modellnek hívjuk – „naiv”, mert gyakran használják (egyszerűsítésként) olyan esetekben is, ahol az „okozati” változók valójában <span class="emphasis"><em>nem</em></span> függetlenek az „ok” fennállása esetén. (A naiv Bayes-modellt néha <span class="strong"><strong>Bayes-osztályozó</strong></span>nak (<span class="strong"><strong>Bayes classifier</strong></span>) is hívják némileg meggondolatlanul, ami arra sarkallta az igazi Bayes-következtetést alkalmazókat, hogy a naiv Bayes-modellt <span class="strong"><strong>együgyű Bayes</strong></span>- (<span class="strong"><strong>idiot Bayes</strong></span>) modellnek hívják.) A naiv Bayes-modellek a gyakorlatban akkor is meglepően jól működnek, ha a valószínűségi feltételezés nem igaz. A 20. fejezetben olyan módszereket írunk le, amelyekkel a naiv Bayes-eloszlások megtanulhatók a megfigyelésekből.</p></div><div class="footnotes"><br/><hr/><div class="footnote"><p class="footnote text"><sup>[<a id="ftn.id669637" href="#id669637" class="para">141</a>] </sup> Az angol irodalomban Bayes’ rule az elnevezése. Strunk és White <span class="emphasis"><em>The Elements of Style </em></span>c. könyvének 1. oldalán található 1. szabály értelmében a Bayes’ helyett inkább a Bayes’s lenne a helyes jelölés, azonban az előbbit elterjedtebben használják. (Szerencsére ilyen probléma a magyarban nincs. <span class="emphasis"><em>A szerk.</em></span>)</p></div><div class="footnote"><p class="footnote text"><sup>[<a id="ftn.id670018" href="#id670018" class="para">142</a>] </sup> Feltételezve, hogy a beteg és a fogorvos két különböző személy.</p></div></div></div></body></html>
